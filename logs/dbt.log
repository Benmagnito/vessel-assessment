

============================== 2022-12-12 20:15:46.918043 | eda0ada6-08f3-49c4-9f2b-751510f2e3cf ==============================
[0m20:15:46.918052 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:15:46.918384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m20:15:46.918569 [debug] [MainThread]: Tracking: tracking
[0m20:15:46.919926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2bd3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2bd3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2bd3d60>]}
[0m20:15:47.248921 [debug] [MainThread]: Executing "git --help"
[0m20:15:47.250700 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:15:47.250861 [debug] [MainThread]: STDERR: "b''"
[0m20:15:47.253148 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m20:15:47.253325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:47.254778 [debug] [MainThread]: On debug: select 1 as id
[0m20:15:51.606997 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:181680eb-caa4-45f3-8f6d-2390e21e725a:US&page=queryresults
[0m20:15:51.607921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e095c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e094d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e094c580>]}
[0m20:15:51.608689 [debug] [MainThread]: Flushing usage events
[0m20:15:53.296568 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-13 06:05:26.888365 | a2c16787-889f-4cd8-9156-3464a5154a1a ==============================
[0m06:05:26.888378 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:05:26.888960 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:05:26.889106 [debug] [MainThread]: Tracking: tracking
[0m06:05:26.890390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0be3ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0be3be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0be3be20>]}
[0m06:05:26.901755 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m06:05:26.902070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0be3ae00>]}
[0m06:05:26.944395 [debug] [MainThread]: Parsing macros/adapters.sql
[0m06:05:26.967327 [debug] [MainThread]: Parsing macros/catalog.sql
[0m06:05:26.973529 [debug] [MainThread]: Parsing macros/etc.sql
[0m06:05:26.975400 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m06:05:26.977984 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m06:05:26.985064 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m06:05:26.987738 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m06:05:26.990028 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m06:05:26.991724 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m06:05:27.009943 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:05:27.012789 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:05:27.013218 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:05:27.013730 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:05:27.014352 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:05:27.014776 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m06:05:27.015580 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:05:27.016864 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:05:27.017466 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:05:27.018002 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:05:27.019186 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m06:05:27.020231 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:05:27.021369 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m06:05:27.021882 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:05:27.022384 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:05:27.023068 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:05:27.023724 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m06:05:27.024304 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:05:27.024745 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m06:05:27.025382 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m06:05:27.026169 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m06:05:27.027456 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m06:05:27.028231 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:05:27.030441 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:05:27.034501 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:05:27.041069 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:05:27.058341 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:05:27.063559 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:05:27.067013 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:05:27.070136 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:05:27.075184 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:05:27.077332 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m06:05:27.078490 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m06:05:27.086365 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m06:05:27.093031 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m06:05:27.094370 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:05:27.108923 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m06:05:27.125491 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:05:27.135698 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m06:05:27.139775 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m06:05:27.141803 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m06:05:27.143434 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:05:27.144873 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:05:27.160218 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:05:27.171433 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m06:05:27.183303 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:05:27.196741 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:05:27.198987 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:05:27.213079 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:05:27.220059 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:05:27.229404 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m06:05:27.232853 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:05:27.235673 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:05:27.239735 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:05:27.242455 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m06:05:27.244823 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m06:05:27.246141 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m06:05:27.247595 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m06:05:27.253879 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m06:05:27.258684 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m06:05:27.266554 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:05:27.267556 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:05:27.268811 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:05:27.269986 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:05:27.270945 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m06:05:27.272341 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m06:05:27.273713 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m06:05:27.280274 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:05:27.282521 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m06:05:27.283796 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m06:05:27.285019 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m06:05:27.287285 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:05:27.288696 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:05:27.290329 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:05:27.292151 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:05:27.294876 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m06:05:27.296359 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:05:27.297679 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:05:27.299603 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:05:27.301172 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m06:05:27.302531 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m06:05:27.303640 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m06:05:27.304745 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m06:05:27.306123 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:05:27.307240 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m06:05:27.599360 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_vessel_tracked_events.sql
[0m06:05:27.612378 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m06:05:27.727338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bbff2e0>]}
[0m06:05:27.735625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bbff760>]}
[0m06:05:27.735964 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:05:27.736261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bba0f70>]}
[0m06:05:27.737449 [info ] [MainThread]: 
[0m06:05:27.738119 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m06:05:27.739190 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m06:05:27.739541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:29.948220 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m06:05:29.948472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:31.758071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bbffbe0>]}
[0m06:05:31.759978 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m06:05:31.760849 [info ] [MainThread]: 
[0m06:05:31.771815 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m06:05:31.772729 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m06:05:31.774677 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m06:05:31.775236 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m06:05:31.775700 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m06:05:31.787492 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m06:05:31.788801 [debug] [Thread-1 (]: finished collecting timing info
[0m06:05:31.789369 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m06:05:31.843283 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m06:05:31.843826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:31.845089 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    left join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_info_tracked_events
)

select * from final
    );
  
[0m06:05:57.221833 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:eefa31c7-b2c5-4937-89c8-587db06f87f9:US&page=queryresults
[0m06:05:57.263020 [debug] [Thread-1 (]: finished collecting timing info
[0m06:05:57.263733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bbd9c60>]}
[0m06:05:57.264101 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 469.5 MB processed)[0m in 25.49s]
[0m06:05:57.264545 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m06:05:57.265407 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m06:05:57.265694 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m06:05:57.266398 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m06:05:57.266569 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m06:05:57.266733 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m06:05:57.271842 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m06:05:57.272244 [debug] [Thread-3 (]: finished collecting timing info
[0m06:05:57.272423 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m06:05:57.275674 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m06:05:57.276144 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:05:57.277439 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m06:06:15.129107 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:fe0762c4-c738-48fb-a67a-b1b71a52752d:US&page=queryresults
[0m06:06:15.133837 [debug] [Thread-3 (]: finished collecting timing info
[0m06:06:15.135737 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2c16787-889f-4cd8-9156-3464a5154a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bbdab00>]}
[0m06:06:15.136745 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 9.3 GB processed)[0m in 17.87s]
[0m06:06:15.137952 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m06:06:15.141559 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m06:06:15.143351 [info ] [MainThread]: 
[0m06:06:15.144197 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 47.41 seconds (47.41s).
[0m06:06:15.145066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:15.145562 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m06:06:15.145955 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m06:06:15.168700 [info ] [MainThread]: 
[0m06:06:15.169312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:15.169938 [info ] [MainThread]: 
[0m06:06:15.170475 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:06:15.171618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bd0f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bbff8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0bb53a60>]}
[0m06:06:15.172085 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 07:02:01.052217 | 2351458a-9364-4f1a-9060-2b0d38637d8b ==============================
[0m07:02:01.052227 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:02:01.052862 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:02:01.053018 [debug] [MainThread]: Tracking: tracking
[0m07:02:01.054355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d543f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d543fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d543fd90>]}
[0m07:02:01.122279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:02:01.122648 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m07:02:01.137183 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m07:02:01.165474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2351458a-9364-4f1a-9060-2b0d38637d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d42644f0>]}
[0m07:02:01.172445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2351458a-9364-4f1a-9060-2b0d38637d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d51d7cd0>]}
[0m07:02:01.172727 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:02:01.172968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2351458a-9364-4f1a-9060-2b0d38637d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d51c1300>]}
[0m07:02:01.173946 [info ] [MainThread]: 
[0m07:02:01.174498 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:02:01.175432 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m07:02:01.175734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:03.711569 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m07:02:03.712521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:05.608121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2351458a-9364-4f1a-9060-2b0d38637d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d51afdf0>]}
[0m07:02:05.609909 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:02:05.610813 [info ] [MainThread]: 
[0m07:02:05.626978 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:02:05.627882 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m07:02:05.629742 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:02:05.630249 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:02:05.630734 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:02:05.646377 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:02:05.647632 [debug] [Thread-1 (]: finished collecting timing info
[0m07:02:05.648177 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:02:05.676469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:07.514837 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:02:07.515290 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    left join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from source_vessel_tracking_events
)

select * from final
    );
  
[0m07:02:15.719365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4b4262c0-8322-4674-a999-c06cef2e2170:US&page=queryresults
[0m07:02:15.740553 [debug] [Thread-1 (]: finished collecting timing info
[0m07:02:15.741183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2351458a-9364-4f1a-9060-2b0d38637d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4266350>]}
[0m07:02:15.741592 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (512.0k rows, 467.5 MB processed)[0m in 10.11s]
[0m07:02:15.742031 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:02:15.742657 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:02:15.743295 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m07:02:15.744030 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:02:15.744202 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:02:15.744360 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:02:15.747220 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:02:15.747556 [debug] [Thread-3 (]: finished collecting timing info
[0m07:02:15.747730 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:02:15.749746 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:02:17.847862 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:02:17.848313 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m07:02:24.089218 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:112fa7bf-ef23-49df-b3d8-f062574eebb4:US&page=queryresults
[0m07:02:24.093622 [debug] [Thread-3 (]: finished collecting timing info
[0m07:02:24.094279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2351458a-9364-4f1a-9060-2b0d38637d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4159810>]}
[0m07:02:24.094642 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (512.0k rows, 66.8 MB processed)[0m in 8.35s]
[0m07:02:24.095084 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:02:24.096769 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:02:24.097713 [info ] [MainThread]: 
[0m07:02:24.098263 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 22.92 seconds (22.92s).
[0m07:02:24.098802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:02:24.099086 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m07:02:24.099358 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m07:02:24.117634 [info ] [MainThread]: 
[0m07:02:24.118058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:02:24.118454 [info ] [MainThread]: 
[0m07:02:24.118801 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:02:24.119229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d51ec910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d51ecc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d431d300>]}
[0m07:02:24.119572 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 07:11:14.454351 | 1e64ca59-7d51-4b17-b8c4-db8a109c4450 ==============================
[0m07:11:14.454364 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:11:14.454882 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tg_vessel_tracked_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:11:14.455045 [debug] [MainThread]: Tracking: tracking
[0m07:11:14.456369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a172b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a172bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a172bcd0>]}
[0m07:11:14.504529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:11:14.505021 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m07:11:14.518714 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m07:11:14.547207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e64ca59-7d51-4b17-b8c4-db8a109c4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a0554460>]}
[0m07:11:14.554025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e64ca59-7d51-4b17-b8c4-db8a109c4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a14c3c40>]}
[0m07:11:14.554379 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:11:14.554631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e64ca59-7d51-4b17-b8c4-db8a109c4450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a14b1270>]}
[0m07:11:14.555127 [warn ] [MainThread]: The selection criterion 'tg_vessel_tracked_events.sql' does not match any nodes
[0m07:11:14.555881 [info ] [MainThread]: 
[0m07:11:14.556128 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m07:11:14.562741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1518700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1518d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a15186a0>]}
[0m07:11:14.563026 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 07:11:29.047613 | 0cc27795-691e-4fa5-9689-045f2e62fc65 ==============================
[0m07:11:29.047623 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:11:29.047953 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:11:29.048091 [debug] [MainThread]: Tracking: tracking
[0m07:11:29.049438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2e3b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2e3b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2e3a1d0>]}
[0m07:11:29.097401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:11:29.097584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:11:29.103233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cc27795-691e-4fa5-9689-045f2e62fc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2c1cb80>]}
[0m07:11:29.110060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cc27795-691e-4fa5-9689-045f2e62fc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2bed690>]}
[0m07:11:29.110396 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:11:29.110639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc27795-691e-4fa5-9689-045f2e62fc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2bed6f0>]}
[0m07:11:29.111795 [info ] [MainThread]: 
[0m07:11:29.112362 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:11:29.113311 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m07:11:29.113619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:31.616784 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m07:11:31.617675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:32.864889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc27795-691e-4fa5-9689-045f2e62fc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2bd7eb0>]}
[0m07:11:32.866810 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:11:32.867671 [info ] [MainThread]: 
[0m07:11:32.873028 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:11:32.873358 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m07:11:32.874053 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:11:32.874243 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:11:32.874417 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:11:32.879033 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:11:32.879434 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:32.879643 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:11:32.899584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:11:34.391095 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:11:34.391543 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    left join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_origin

)

select * from final
    );
  
[0m07:11:41.122122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:882dac64-6759-455a-be44-5661f1cc53eb:US&page=queryresults
[0m07:11:41.164902 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:41.165635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc27795-691e-4fa5-9689-045f2e62fc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2c05a80>]}
[0m07:11:41.166053 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (255.8k rows, 467.5 MB processed)[0m in 8.29s]
[0m07:11:41.166555 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:11:41.167357 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:11:41.167749 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m07:11:41.168458 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:11:41.168628 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:11:41.168784 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:11:41.171702 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:11:41.172058 [debug] [Thread-3 (]: finished collecting timing info
[0m07:11:41.172245 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:11:41.177673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:11:42.679262 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:11:42.680093 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m07:11:47.535516 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:c74eb7cf-23bf-4174-b893-523e4dae4639:US&page=queryresults
[0m07:11:47.541085 [debug] [Thread-3 (]: finished collecting timing info
[0m07:11:47.543030 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cc27795-691e-4fa5-9689-045f2e62fc65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2b03ca0>]}
[0m07:11:47.544020 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (255.8k rows, 22.8 MB processed)[0m in 6.37s]
[0m07:11:47.545202 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:11:47.548790 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:11:47.550307 [info ] [MainThread]: 
[0m07:11:47.551183 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 18.44 seconds (18.44s).
[0m07:11:47.551950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:47.552359 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m07:11:47.552749 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m07:11:47.559924 [info ] [MainThread]: 
[0m07:11:47.560256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:11:47.560555 [info ] [MainThread]: 
[0m07:11:47.560792 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:11:47.561158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2b01450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2af6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b2af6230>]}
[0m07:11:47.561402 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 07:13:00.408386 | 9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2 ==============================
[0m07:13:00.408397 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:13:00.408771 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:13:00.408937 [debug] [MainThread]: Tracking: tracking
[0m07:13:00.410252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75eeb27bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75eeb27670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75eeb27fd0>]}
[0m07:13:00.457686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:13:00.458049 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m07:13:00.471228 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m07:13:00.500405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed757e50>]}
[0m07:13:00.507192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee8c3f40>]}
[0m07:13:00.507477 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:13:00.507714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee8ad570>]}
[0m07:13:00.508695 [info ] [MainThread]: 
[0m07:13:00.509297 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:13:00.510201 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m07:13:00.510365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:13:02.140346 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m07:13:02.141209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:13:03.397755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee8c3520>]}
[0m07:13:03.399578 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:13:03.400444 [info ] [MainThread]: 
[0m07:13:03.407167 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:13:03.407497 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m07:13:03.408163 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:13:03.408342 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:13:03.408504 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:13:03.413630 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:13:03.414003 [debug] [Thread-1 (]: finished collecting timing info
[0m07:13:03.414210 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:13:03.431712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:13:05.415899 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:13:05.416341 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    left join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_destination

)

select * from final
    );
  
[0m07:13:12.998278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:1c178e94-2ee6-4311-9745-a56c34d410b7:US&page=queryresults
[0m07:13:13.020804 [debug] [Thread-1 (]: finished collecting timing info
[0m07:13:13.021456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed754cd0>]}
[0m07:13:13.021831 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (256.2k rows, 467.5 MB processed)[0m in 9.61s]
[0m07:13:13.022270 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:13:13.022945 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:13:13.023346 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m07:13:13.024090 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:13:13.024265 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:13:13.024425 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:13:13.027341 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:13:13.027690 [debug] [Thread-3 (]: finished collecting timing info
[0m07:13:13.027870 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:13:13.029890 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:13:14.843845 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:13:14.844924 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m07:13:19.765458 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:ea577a4e-95ac-427f-aa47-3745d9e58f80:US&page=queryresults
[0m07:13:19.769702 [debug] [Thread-3 (]: finished collecting timing info
[0m07:13:19.770356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a05aa5d-fe1e-45ba-8b9b-a1ed31c823f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ec643430>]}
[0m07:13:19.770739 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (256.2k rows, 29.1 MB processed)[0m in 6.75s]
[0m07:13:19.771246 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:13:19.772920 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:13:19.773545 [info ] [MainThread]: 
[0m07:13:19.773876 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 19.26 seconds (19.26s).
[0m07:13:19.774175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:13:19.774335 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m07:13:19.774489 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m07:13:19.789256 [info ] [MainThread]: 
[0m07:13:19.789631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:13:19.789983 [info ] [MainThread]: 
[0m07:13:19.790269 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:13:19.790641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f2dfdab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed80a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ed80a980>]}
[0m07:13:19.791020 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 07:24:16.956842 | 074322c3-3030-4b26-937f-ae5af0448589 ==============================
[0m07:24:16.956853 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:24:16.957225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:24:16.957401 [debug] [MainThread]: Tracking: tracking
[0m07:24:16.958738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f683b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f683b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f6839e70>]}
[0m07:24:17.006447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:24:17.006894 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m07:24:17.020701 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m07:24:17.049328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '074322c3-3030-4b26-937f-ae5af0448589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f5467eb0>]}
[0m07:24:17.056339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '074322c3-3030-4b26-937f-ae5af0448589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f65d7ee0>]}
[0m07:24:17.056631 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:24:17.056874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '074322c3-3030-4b26-937f-ae5af0448589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f65c1780>]}
[0m07:24:17.057861 [info ] [MainThread]: 
[0m07:24:17.058433 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:24:17.059406 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m07:24:17.059667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:19.308345 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m07:24:19.309256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:21.211529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '074322c3-3030-4b26-937f-ae5af0448589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f65af6a0>]}
[0m07:24:21.213420 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:24:21.214404 [info ] [MainThread]: 
[0m07:24:21.228309 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:24:21.229266 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m07:24:21.231327 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:24:21.231854 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:24:21.232320 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:24:21.245977 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:24:21.246972 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:21.247478 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:24:21.275106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:23.150637 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:24:23.151084 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_destination

)

select * from final
    );
  
[0m07:24:29.721250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:c720527a-2f11-4753-97f1-021ba11db28c:US&page=queryresults
[0m07:24:29.743451 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:29.744085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '074322c3-3030-4b26-937f-ae5af0448589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f5464c70>]}
[0m07:24:29.744451 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (256.2k rows, 467.5 MB processed)[0m in 8.51s]
[0m07:24:29.744896 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:24:29.745442 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:24:29.746037 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m07:24:29.746779 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:24:29.746959 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:24:29.747119 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:24:29.749968 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:24:29.750309 [debug] [Thread-3 (]: finished collecting timing info
[0m07:24:29.750482 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:24:29.752579 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:24:31.101710 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:24:31.102848 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m07:24:35.730365 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:7a9a70f2-f495-4c66-a76b-74c5d6fca1e3:US&page=queryresults
[0m07:24:35.734469 [debug] [Thread-3 (]: finished collecting timing info
[0m07:24:35.735128 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '074322c3-3030-4b26-937f-ae5af0448589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f5359c90>]}
[0m07:24:35.735490 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (256.2k rows, 29.1 MB processed)[0m in 5.99s]
[0m07:24:35.735912 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:24:35.737136 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:24:35.737675 [info ] [MainThread]: 
[0m07:24:35.737956 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 18.68 seconds (18.68s).
[0m07:24:35.738211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:35.738349 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m07:24:35.738483 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m07:24:35.751447 [info ] [MainThread]: 
[0m07:24:35.751779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:24:35.752078 [info ] [MainThread]: 
[0m07:24:35.752325 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:24:35.752649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f551c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f551e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f551e9b0>]}
[0m07:24:35.752959 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 07:25:10.926141 | 4790e7fe-83b3-4a4d-9cae-560afd5cc96f ==============================
[0m07:25:10.926152 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:25:10.926502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:25:10.926655 [debug] [MainThread]: Tracking: tracking
[0m07:25:10.928080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00f3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00f3f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00f3de10>]}
[0m07:25:10.984742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:25:10.985456 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m07:25:11.006889 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m07:25:11.047497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4790e7fe-83b3-4a4d-9cae-560afd5cc96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfbd23f40>]}
[0m07:25:11.055257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4790e7fe-83b3-4a4d-9cae-560afd5cc96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00cdbee0>]}
[0m07:25:11.055604 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:25:11.055882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4790e7fe-83b3-4a4d-9cae-560afd5cc96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00cc5720>]}
[0m07:25:11.056993 [info ] [MainThread]: 
[0m07:25:11.057633 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:25:11.058685 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m07:25:11.059030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:12.822112 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m07:25:12.822981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:14.317336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4790e7fe-83b3-4a4d-9cae-560afd5cc96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00cb3940>]}
[0m07:25:14.319180 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:25:14.320045 [info ] [MainThread]: 
[0m07:25:14.333993 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:14.334994 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m07:25:14.336951 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:25:14.337690 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:14.338184 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:14.352343 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:25:14.353098 [debug] [Thread-1 (]: finished collecting timing info
[0m07:25:14.353480 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:14.375687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:16.289145 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:25:16.289603 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m07:25:34.756134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:c7aecfaf-6162-43de-a9c3-3a8353c025b1:US&page=queryresults
[0m07:25:34.799463 [debug] [Thread-1 (]: finished collecting timing info
[0m07:25:34.800219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4790e7fe-83b3-4a4d-9cae-560afd5cc96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfbd20ca0>]}
[0m07:25:34.800692 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 20.46s]
[0m07:25:34.801274 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:34.802080 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:25:34.802359 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m07:25:34.803103 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:25:34.803283 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:25:34.803445 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:25:34.806465 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:25:34.806808 [debug] [Thread-3 (]: finished collecting timing info
[0m07:25:34.806992 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:25:34.808963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:25:36.662841 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:25:36.664002 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m07:25:44.583565 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m07:25:47.053051 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:f64770f7-b22f-4974-b0d1-f1047a82636b:US&page=queryresults
[0m07:25:47.058568 [debug] [Thread-3 (]: finished collecting timing info
[0m07:25:47.060435 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4790e7fe-83b3-4a4d-9cae-560afd5cc96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfbc1b520>]}
[0m07:25:47.061592 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 12.26s]
[0m07:25:47.062943 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:25:47.063697 [info ] [MainThread]: 
[0m07:25:47.065042 [info ] [MainThread]: [33mExited because of keyboard interrupt.[0m
[0m07:25:47.066462 [info ] [MainThread]: 
[0m07:25:47.067472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:25:47.067891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:47.068182 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m07:25:47.068486 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m07:25:47.068703 [debug] [MainThread]: Flushing usage events
[0m07:25:48.555339 [info ] [MainThread]: ctrl-c


============================== 2022-12-13 07:25:53.869434 | 1e9eb906-f530-4e10-87bd-cc6a395baff1 ==============================
[0m07:25:53.869446 [info ] [MainThread]: Running with dbt=1.3.1
[0m07:25:53.869822 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:25:53.869986 [debug] [MainThread]: Tracking: tracking
[0m07:25:53.871449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318c3faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318c3ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318c3ff10>]}
[0m07:25:53.919190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:25:53.919371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:25:53.925113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9eb906-f530-4e10-87bd-cc6a395baff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318a24520>]}
[0m07:25:53.932142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9eb906-f530-4e10-87bd-cc6a395baff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13189f1030>]}
[0m07:25:53.932478 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:25:53.932723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9eb906-f530-4e10-87bd-cc6a395baff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13189f1090>]}
[0m07:25:53.933701 [info ] [MainThread]: 
[0m07:25:53.934266 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:25:53.935265 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m07:25:53.935559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:55.605520 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m07:25:55.606307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:57.387662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9eb906-f530-4e10-87bd-cc6a395baff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13189f0460>]}
[0m07:25:57.389497 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:25:57.390360 [info ] [MainThread]: 
[0m07:25:57.395433 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:57.395732 [info ] [Thread-1 (]: 1 of 2 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m07:25:57.396350 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:25:57.396549 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:57.396724 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:57.401193 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:25:57.401562 [debug] [Thread-1 (]: finished collecting timing info
[0m07:25:57.401757 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:25:57.419512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:59.345816 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m07:25:59.346257 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

vessel_info_tracked_events as (

    select a.*,
           b.vessel_name,
           b.generic_type as vessel_generic_type,
           b.detailed_type as vessel_detailed_type,
           b.status as vessel_status,
           b.flag as vessel_country,
           b.gross_tonnage as vessel_gross_tonnage,
           b.dwt as vessel_dwt,
           b.length as vessel_length,
           b.width as vessel_width,
           b.year_built as vessel_year_built

    from vessel_tracked_events_joined a
    left join source_vessel_info b 
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m07:26:14.002732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:a867baac-e89e-40b0-a74f-0b6ffd5e7142:US&page=queryresults
[0m07:26:14.025043 [debug] [Thread-1 (]: finished collecting timing info
[0m07:26:14.025666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9eb906-f530-4e10-87bd-cc6a395baff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318a09690>]}
[0m07:26:14.026030 [info ] [Thread-1 (]: 1 of 2 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 16.63s]
[0m07:26:14.026469 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m07:26:14.027225 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:26:14.027628 [info ] [Thread-3 (]: 2 of 2 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m07:26:14.028338 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:26:14.028513 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:26:14.028694 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:26:14.031644 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:26:14.032000 [debug] [Thread-3 (]: finished collecting timing info
[0m07:26:14.032181 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:26:14.037764 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:26:15.294341 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m07:26:15.295463 [debug] [Thread-3 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m07:26:26.115912 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:11b25ca8-e6bb-41b8-b438-a4a4a3b6c9c1:US&page=queryresults
[0m07:26:26.121590 [debug] [Thread-3 (]: finished collecting timing info
[0m07:26:26.123496 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9eb906-f530-4e10-87bd-cc6a395baff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13188d49a0>]}
[0m07:26:26.124512 [info ] [Thread-3 (]: 2 of 2 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 12.10s]
[0m07:26:26.125927 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m07:26:26.129287 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:26:26.130874 [info ] [MainThread]: 
[0m07:26:26.131713 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 32.20 seconds (32.20s).
[0m07:26:26.132570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:26.133065 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m07:26:26.133465 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m07:26:26.152013 [info ] [MainThread]: 
[0m07:26:26.152488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:26:26.153255 [info ] [MainThread]: 
[0m07:26:26.153872 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:26:26.154650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13188f7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13188f5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13188f7820>]}
[0m07:26:26.155083 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 08:13:20.325470 | 2923a92d-6215-4f6a-94f0-8b6c4a2aab91 ==============================
[0m08:13:20.325481 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:13:20.325854 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:13:20.326008 [debug] [MainThread]: Tracking: tracking
[0m08:13:20.327412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805d3faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805d3ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805d3ff10>]}
[0m08:13:20.377503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m08:13:20.377820 [debug] [MainThread]: Partial parsing: added file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m08:13:20.378020 [debug] [MainThread]: Partial parsing: added file: vessel_assessment_bq://models/staging/stg_vessel_ports.sql
[0m08:13:20.378254 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m08:13:20.391919 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m08:13:20.404786 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_ports.sql
[0m08:13:20.407802 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m08:13:20.427678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805b21cf0>]}
[0m08:13:20.434678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88091e4af0>]}
[0m08:13:20.435046 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m08:13:20.435292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805ac54b0>]}
[0m08:13:20.436496 [info ] [MainThread]: 
[0m08:13:20.437106 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:13:20.438178 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m08:13:20.438483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:23.133865 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m08:13:23.134790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:25.089939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805d3dcc0>]}
[0m08:13:25.091983 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m08:13:25.092889 [info ] [MainThread]: 
[0m08:13:25.098025 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m08:13:25.098248 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m08:13:25.098578 [info ] [Thread-1 (]: 1 of 4 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m08:13:25.098846 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m08:13:25.099256 [info ] [Thread-2 (]: 2 of 4 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m08:13:25.100216 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m08:13:25.100591 [info ] [Thread-3 (]: 3 of 4 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m08:13:25.101582 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m08:13:25.101878 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m08:13:25.102819 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m08:13:25.103117 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m08:13:25.103417 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m08:13:25.103680 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m08:13:25.103961 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m08:13:25.110462 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m08:13:25.110801 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m08:13:25.113939 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m08:13:25.117859 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m08:13:25.119016 [debug] [Thread-2 (]: finished collecting timing info
[0m08:13:25.119402 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m08:13:25.119650 [debug] [Thread-1 (]: finished collecting timing info
[0m08:13:25.125152 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m08:13:25.178841 [debug] [Thread-3 (]: finished collecting timing info
[0m08:13:25.184466 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m08:13:25.213350 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m08:13:25.215606 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:13:25.218426 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m08:13:25.262125 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:13:25.262593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:25.263737 [debug] [Thread-2 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m08:13:25.294943 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

final as (

    select * from source_vessel_info

)

select * from final
    );
  
[0m08:13:27.119062 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m08:13:27.119496 [debug] [Thread-3 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m08:13:30.075604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:b61b4143-0fa6-4e3b-ab10-34ac4a5a9667:US&page=queryresults
[0m08:13:30.114329 [debug] [Thread-1 (]: finished collecting timing info
[0m08:13:30.115095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8804b6c280>]}
[0m08:13:30.115536 [info ] [Thread-1 (]: 1 of 4 OK created sql table model data_science.stg_vessel_info ................. [[32mCREATE TABLE (2.3k rows, 2.1 MB processed)[0m in 5.02s]
[0m08:13:30.116058 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m08:13:30.425452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:7166dd48-29f3-47c7-a588-ad873a2da25a:US&page=queryresults
[0m08:13:30.429895 [debug] [Thread-2 (]: finished collecting timing info
[0m08:13:30.431885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8804b6c2e0>]}
[0m08:13:30.432974 [info ] [Thread-2 (]: 2 of 4 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 5.33s]
[0m08:13:30.434164 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m08:13:42.790628 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:ae727ed8-900a-45a7-9c18-9692926e0568:US&page=queryresults
[0m08:13:42.804142 [debug] [Thread-3 (]: finished collecting timing info
[0m08:13:42.805907 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8804ab0f40>]}
[0m08:13:42.806855 [info ] [Thread-3 (]: 3 of 4 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 17.70s]
[0m08:13:42.808029 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m08:13:42.809273 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m08:13:42.810314 [info ] [Thread-1 (]: 4 of 4 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m08:13:42.812493 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m08:13:42.813250 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m08:13:42.813727 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m08:13:42.821174 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m08:13:42.822246 [debug] [Thread-1 (]: finished collecting timing info
[0m08:13:42.822785 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m08:13:42.827204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:44.742112 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m08:13:44.743334 [debug] [Thread-1 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m08:13:55.027673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4d95c126-c8b8-48d3-8a62-7949d7d7a01d:US&page=queryresults
[0m08:13:55.032614 [debug] [Thread-1 (]: finished collecting timing info
[0m08:13:55.033255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2923a92d-6215-4f6a-94f0-8b6c4a2aab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8804ab1a50>]}
[0m08:13:55.033625 [info ] [Thread-1 (]: 4 of 4 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 12.22s]
[0m08:13:55.034060 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m08:13:55.035384 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:13:55.035932 [info ] [MainThread]: 
[0m08:13:55.036218 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 34.60 seconds (34.60s).
[0m08:13:55.036473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:55.036612 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m08:13:55.036754 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m08:13:55.036886 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m08:13:55.044984 [info ] [MainThread]: 
[0m08:13:55.045341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:13:55.045675 [info ] [MainThread]: 
[0m08:13:55.046010 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:13:55.046376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805aec8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8804c115d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8804a72da0>]}
[0m08:13:55.046653 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:18:28.863585 | 71b94aff-6db4-4dff-a93f-2093082a60ef ==============================
[0m09:18:28.863595 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:18:28.864237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:18:28.864387 [debug] [MainThread]: Tracking: tracking
[0m09:18:28.865713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef75a3b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef75a3be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef75a3bdf0>]}
[0m09:18:28.913044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:18:28.913513 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m09:18:28.926433 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m09:18:28.953496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef74868cd0>]}
[0m09:18:28.960020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef757b3d90>]}
[0m09:18:28.960290 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:18:28.960520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef757b3d60>]}
[0m09:18:28.961596 [info ] [MainThread]: 
[0m09:18:28.962168 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:18:28.963171 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:18:28.963461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:31.903499 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:18:31.904135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:33.955122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef757db1f0>]}
[0m09:18:33.956952 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:18:33.957810 [info ] [MainThread]: 
[0m09:18:33.965361 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m09:18:33.965630 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:18:33.966878 [info ] [Thread-1 (]: 1 of 4 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m09:18:33.967437 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:18:33.967840 [info ] [Thread-2 (]: 2 of 4 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:18:33.968837 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m09:18:33.969298 [info ] [Thread-3 (]: 3 of 4 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m09:18:33.970380 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:18:33.970736 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m09:18:33.971783 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:18:33.972120 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:18:33.972464 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m09:18:33.972772 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:18:33.973093 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:18:33.978142 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:18:33.978623 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:18:33.984363 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:18:33.988042 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:18:33.988481 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:33.989173 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:33.989490 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m09:18:33.989855 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:18:33.990099 [debug] [Thread-3 (]: finished collecting timing info
[0m09:18:34.028352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:34.029350 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:18:34.029704 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:18:34.068586 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:18:35.843592 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:18:35.844038 [debug] [Thread-3 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m09:18:36.415520 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:18:36.415379 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:18:36.417867 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

vessel_derivied_fields as (

    select 
        imo,
        mmsi,
        vessel_name,
        generic_type,
        detailed_type,
        status,
        call_sign,
        flag,
        gross_tonnage,
        dwt,
        length,
        width,
        case when length >= 366 and width >= 49 then 1 else 0 end as is_ulcv, 

        year_built
        

)

final as (

    select * from source_vessel_info

)

select * from final
    );
  
[0m09:18:36.418684 [debug] [Thread-2 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m09:18:36.910010 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [38:1]')
[0m09:18:37.837139 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:d9b80a5d-e36f-4256-8124-4ba74b483c3e&page=queryresults
[0m09:18:37.838524 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:37.840193 [debug] [Thread-1 (]: Database Error in model stg_vessel_info (models/staging/stg_vessel_info.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [38:1]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_info.sql
[0m09:18:37.840454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef74752080>]}
[0m09:18:37.840832 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model data_science.stg_vessel_info ............. [[31mERROR[0m in 3.87s]
[0m09:18:37.841243 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m09:18:39.645979 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:3ee65c5b-a65f-41c2-b597-aebb99d4b8ca:US&page=queryresults
[0m09:18:39.689232 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:39.689977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef74752530>]}
[0m09:18:39.690385 [info ] [Thread-2 (]: 2 of 4 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 5.72s]
[0m09:18:39.690829 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:18:55.450247 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:1e23448a-b831-4508-9e7c-120eec389ec9:US&page=queryresults
[0m09:18:55.454070 [debug] [Thread-3 (]: finished collecting timing info
[0m09:18:55.454708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef747c7970>]}
[0m09:18:55.455062 [info ] [Thread-3 (]: 3 of 4 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 21.48s]
[0m09:18:55.455485 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:18:55.456306 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:18:55.456630 [info ] [Thread-1 (]: 4 of 4 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m09:18:55.457329 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:18:55.457510 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:18:55.457674 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:18:55.460815 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:18:55.461233 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:55.461444 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:18:55.463564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:57.058475 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:18:57.058928 [debug] [Thread-1 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m09:19:08.466021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:398131db-c058-4d28-a2ac-51dc21cd85d8:US&page=queryresults
[0m09:19:08.470307 [debug] [Thread-1 (]: finished collecting timing info
[0m09:19:08.470995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b94aff-6db4-4dff-a93f-2093082a60ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef75821e10>]}
[0m09:19:08.471379 [info ] [Thread-1 (]: 4 of 4 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 13.01s]
[0m09:19:08.471819 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:19:08.473189 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:19:08.473770 [info ] [MainThread]: 
[0m09:19:08.474062 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 39.51 seconds (39.51s).
[0m09:19:08.474369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:08.474549 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m09:19:08.474688 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m09:19:08.474842 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m09:19:08.485061 [info ] [MainThread]: 
[0m09:19:08.485727 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:19:08.486150 [info ] [MainThread]: 
[0m09:19:08.486523 [error] [MainThread]: [33mDatabase Error in model stg_vessel_info (models/staging/stg_vessel_info.sql)[0m
[0m09:19:08.486968 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [38:1]
[0m09:19:08.487320 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_info.sql
[0m09:19:08.487684 [info ] [MainThread]: 
[0m09:19:08.488037 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:19:08.488517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef74902e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef757dbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef757e9270>]}
[0m09:19:08.489005 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:20:00.907080 | 2c31aaff-50a1-4a48-8cbe-5425eb315010 ==============================
[0m09:20:00.907090 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:20:00.907453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:20:00.907618 [debug] [MainThread]: Tracking: tracking
[0m09:20:00.908944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ee3fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ee3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ee3f790>]}
[0m09:20:00.955733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:00.956088 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m09:20:00.968998 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m09:20:00.998003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406dc68f70>]}
[0m09:20:01.004768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ebb72b0>]}
[0m09:20:01.005139 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:20:01.005377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ebb72e0>]}
[0m09:20:01.006490 [info ] [MainThread]: 
[0m09:20:01.007094 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:20:01.008124 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:20:01.008416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:03.473168 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:20:03.473796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:05.494340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ebdfee0>]}
[0m09:20:05.496162 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:20:05.497012 [info ] [MainThread]: 
[0m09:20:05.503973 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m09:20:05.504214 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:20:05.505332 [info ] [Thread-1 (]: 1 of 4 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m09:20:05.505844 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:20:05.506242 [info ] [Thread-2 (]: 2 of 4 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:20:05.507161 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m09:20:05.507538 [info ] [Thread-3 (]: 3 of 4 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m09:20:05.508511 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:20:05.508788 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m09:20:05.509774 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:20:05.510074 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:20:05.510379 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m09:20:05.510680 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:20:05.510988 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:20:05.515157 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:20:05.515472 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:20:05.520112 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:20:05.526989 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:20:05.527310 [debug] [Thread-1 (]: finished collecting timing info
[0m09:20:05.527853 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m09:20:05.538550 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:05.547049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:05.547297 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:20:05.547602 [debug] [Thread-3 (]: finished collecting timing info
[0m09:20:05.581956 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:20:05.582466 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:20:05.613926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:20:07.160200 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:20:07.160673 [debug] [Thread-2 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m09:20:07.439470 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:20:07.440548 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

vessel_derivied_fields as (

    select 
        imo,
        mmsi,
        vessel_name,
        generic_type,
        detailed_type,
        status,
        call_sign,
        flag,
        gross_tonnage,
        dwt,
        length,
        width,
        case when length >= 366 and width >= 49 then 1 else 0 end as is_ulcv, 
        year_built
),

final as (

    select * from source_vessel_info

)

select * from final
    );
  
[0m09:20:07.594255 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:20:07.594674 [debug] [Thread-3 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m09:20:08.971093 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: imo at [19:9]')
[0m09:20:09.985038 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:296d7570-5ffd-4ebf-818d-af6e4461cca3:US&page=queryresults
[0m09:20:10.028863 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:10.029610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ec260b0>]}
[0m09:20:10.030042 [info ] [Thread-2 (]: 2 of 4 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 4.52s]
[0m09:20:10.030558 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:20:10.715400 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:e57656c0-fba8-4836-b10a-e88fb5b365d2&page=queryresults
[0m09:20:10.716658 [debug] [Thread-1 (]: finished collecting timing info
[0m09:20:10.718175 [debug] [Thread-1 (]: Database Error in model stg_vessel_info (models/staging/stg_vessel_info.sql)
  Unrecognized name: imo at [19:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_info.sql
[0m09:20:10.718426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406dd31f60>]}
[0m09:20:10.718784 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model data_science.stg_vessel_info ............. [[31mERROR[0m in 5.21s]
[0m09:20:10.719198 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m09:20:23.070233 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:d1a975f3-b477-41da-9e2f-1bfc73b56854:US&page=queryresults
[0m09:20:23.074721 [debug] [Thread-3 (]: finished collecting timing info
[0m09:20:23.075362 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406dd31ab0>]}
[0m09:20:23.075709 [info ] [Thread-3 (]: 3 of 4 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 17.57s]
[0m09:20:23.076129 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:20:23.076860 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:20:23.077126 [info ] [Thread-2 (]: 4 of 4 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m09:20:23.077751 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:20:23.077928 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:20:23.078090 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:20:23.081217 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:20:23.081655 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:23.081864 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:20:23.084228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:20:24.747056 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:20:24.747502 [debug] [Thread-2 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m09:20:39.274829 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:06b097fb-9573-4b97-9093-d14705b970ee:US&page=queryresults
[0m09:20:39.279141 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:39.279791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c31aaff-50a1-4a48-8cbe-5425eb315010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406dd315d0>]}
[0m09:20:39.280147 [info ] [Thread-2 (]: 4 of 4 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 16.20s]
[0m09:20:39.280595 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:20:39.282204 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:20:39.282861 [info ] [MainThread]: 
[0m09:20:39.283196 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 38.28 seconds (38.28s).
[0m09:20:39.283497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:39.283657 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_info' was properly closed.
[0m09:20:39.283810 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m09:20:39.283961 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m09:20:39.292189 [info ] [MainThread]: 
[0m09:20:39.292503 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:20:39.292785 [info ] [MainThread]: 
[0m09:20:39.293025 [error] [MainThread]: [33mDatabase Error in model stg_vessel_info (models/staging/stg_vessel_info.sql)[0m
[0m09:20:39.293261 [error] [MainThread]:   Unrecognized name: imo at [19:9]
[0m09:20:39.293483 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_info.sql
[0m09:20:39.293717 [info ] [MainThread]: 
[0m09:20:39.293945 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:20:39.294256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ebdf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ebdfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406ebf12a0>]}
[0m09:20:39.294493 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:21:45.843611 | a9af88c6-9904-4fd3-90a3-5edf18fc69fa ==============================
[0m09:21:45.843621 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:21:45.843992 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:21:45.844153 [debug] [MainThread]: Tracking: tracking
[0m09:21:45.845440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec92b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec92b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec92b4c0>]}
[0m09:21:45.891610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:21:45.892000 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m09:21:45.904669 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m09:21:45.932542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe7513e80>]}
[0m09:21:45.938837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec69fc10>]}
[0m09:21:45.939149 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:21:45.939414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec69fbe0>]}
[0m09:21:45.940490 [info ] [MainThread]: 
[0m09:21:45.941086 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:21:45.942082 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:21:45.942402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:47.487071 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:21:47.487887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:48.902620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec6c7c10>]}
[0m09:21:48.904525 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:21:48.905386 [info ] [MainThread]: 
[0m09:21:48.911895 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m09:21:48.912146 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:21:48.913404 [info ] [Thread-1 (]: 1 of 4 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m09:21:48.913975 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:21:48.914377 [info ] [Thread-2 (]: 2 of 4 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:21:48.915284 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m09:21:48.915672 [info ] [Thread-3 (]: 3 of 4 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m09:21:48.916807 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:21:48.917129 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m09:21:48.918209 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:21:48.918542 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:21:48.918826 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m09:21:48.919159 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:21:48.919491 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:21:48.923933 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:21:48.924326 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:21:48.929095 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:21:48.935897 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:21:48.936623 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:48.936865 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m09:21:48.947410 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:48.955047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:48.955406 [debug] [Thread-3 (]: finished collecting timing info
[0m09:21:48.955706 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:21:48.988207 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:21:48.991355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:21:48.993195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:21:50.588006 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:21:50.590913 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:21:50.592203 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:21:50.592565 [debug] [Thread-2 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m09:21:50.592934 [debug] [Thread-3 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m09:21:50.595717 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

vessel_derivied_fields as (

    select 
        mmsi,
        vessel_name,
        generic_type,
        detailed_type,
        status,
        call_sign,
        flag,
        gross_tonnage,
        dwt,
        length,
        width,
        case when length >= 366 and width >= 49 then 1 else 0 end as is_ulcv, 
        year_built
),

final as (

    select * from source_vessel_info

)

select * from final
    );
  
[0m09:21:51.989394 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: mmsi at [19:9]')
[0m09:21:53.553666 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4fa8f11a-44a4-41ed-8cc2-4ce50d55727b:US&page=queryresults
[0m09:21:53.574777 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:53.575395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe441c520>]}
[0m09:21:53.575758 [info ] [Thread-2 (]: 2 of 4 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 4.66s]
[0m09:21:53.576186 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:21:53.933679 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:15a1af0a-34fa-4218-8f17-ccea1eb5fa29&page=queryresults
[0m09:21:53.935104 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:53.936453 [debug] [Thread-1 (]: Database Error in model stg_vessel_info (models/staging/stg_vessel_info.sql)
  Unrecognized name: mmsi at [19:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_info.sql
[0m09:21:53.936710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe443d2d0>]}
[0m09:21:53.937061 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model data_science.stg_vessel_info ............. [[31mERROR[0m in 5.02s]
[0m09:21:53.937491 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m09:22:08.832784 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:c9f9d61d-8489-4ebe-9176-bbbec18e5bb4:US&page=queryresults
[0m09:22:08.838000 [debug] [Thread-3 (]: finished collecting timing info
[0m09:22:08.839812 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe443c070>]}
[0m09:22:08.840783 [info ] [Thread-3 (]: 3 of 4 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 19.92s]
[0m09:22:08.842045 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:22:08.843622 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:22:08.844862 [info ] [Thread-2 (]: 4 of 4 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m09:22:08.846781 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:22:08.847293 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:22:08.847744 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:22:08.852541 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:22:08.852917 [debug] [Thread-2 (]: finished collecting timing info
[0m09:22:08.853109 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:22:08.855306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:22:10.321532 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:22:10.321962 [debug] [Thread-2 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m09:22:21.634264 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:7363ce5f-3a2c-4638-b48d-cd35587b66cb:US&page=queryresults
[0m09:22:21.638312 [debug] [Thread-2 (]: finished collecting timing info
[0m09:22:21.638948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9af88c6-9904-4fd3-90a3-5edf18fc69fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe443fa60>]}
[0m09:22:21.639306 [info ] [Thread-2 (]: 4 of 4 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 12.79s]
[0m09:22:21.639729 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:22:21.641282 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:22:21.641912 [info ] [MainThread]: 
[0m09:22:21.642242 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 35.70 seconds (35.70s).
[0m09:22:21.642540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:21.642700 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_info' was properly closed.
[0m09:22:21.642872 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m09:22:21.643027 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m09:22:21.651726 [info ] [MainThread]: 
[0m09:22:21.652095 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:22:21.652425 [info ] [MainThread]: 
[0m09:22:21.652705 [error] [MainThread]: [33mDatabase Error in model stg_vessel_info (models/staging/stg_vessel_info.sql)[0m
[0m09:22:21.652985 [error] [MainThread]:   Unrecognized name: mmsi at [19:9]
[0m09:22:21.653250 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_info.sql
[0m09:22:21.653525 [info ] [MainThread]: 
[0m09:22:21.653796 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:22:21.654160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec928310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec9286a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fec6c7640>]}
[0m09:22:21.654444 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:23:01.405764 | 9701ba99-f7bc-4494-a42f-46393e14e5bd ==============================
[0m09:23:01.405774 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:23:01.406113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:23:01.406258 [debug] [MainThread]: Tracking: tracking
[0m09:23:01.407605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1862b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1862bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1862bbb0>]}
[0m09:23:01.453514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:01.453874 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m09:23:01.466771 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m09:23:01.493861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf17458b50>]}
[0m09:23:01.500357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1839ffd0>]}
[0m09:23:01.500637 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:23:01.500902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1839ffa0>]}
[0m09:23:01.502000 [info ] [MainThread]: 
[0m09:23:01.502596 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:23:01.503609 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:23:01.503940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:03.185543 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:23:03.186163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:04.628856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf18629d80>]}
[0m09:23:04.630627 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:23:04.631538 [info ] [MainThread]: 
[0m09:23:04.638351 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m09:23:04.638626 [debug] [Thread-2 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:23:04.639873 [info ] [Thread-1 (]: 1 of 4 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m09:23:04.640436 [debug] [Thread-3 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:23:04.640837 [info ] [Thread-2 (]: 2 of 4 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:23:04.641711 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m09:23:04.642092 [info ] [Thread-3 (]: 3 of 4 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m09:23:04.643195 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:23:04.643515 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m09:23:04.644589 [debug] [Thread-3 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:23:04.644930 [debug] [Thread-2 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:23:04.645265 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m09:23:04.645598 [debug] [Thread-3 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:23:04.645926 [debug] [Thread-2 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:23:04.650476 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:23:04.650879 [debug] [Thread-3 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:23:04.655685 [debug] [Thread-2 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:23:04.662241 [debug] [Thread-3 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:23:04.662644 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:04.663208 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m09:23:04.663696 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:04.668991 [debug] [Thread-3 (]: finished collecting timing info
[0m09:23:04.681782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:04.682064 [debug] [Thread-2 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:23:04.682348 [debug] [Thread-3 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:23:04.716261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:23:04.719084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:23:06.356770 [debug] [Thread-3 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m09:23:06.356998 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:23:06.357680 [debug] [Thread-3 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),


vessel_tracked_events_origin as (

    select
        mmsi,
        port_type as origin_port_type,
        port_at_call as origin_port_at_call,
        port_at_call_country as origin_port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port as origin_time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type as destination_port_type,
        port_at_call as destination_port_at_call,
        port_at_call_country as destination_port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.origin_port_type,
        a.origin_port_at_call,
        a.origin_port_at_call_country,
        a.origin_port_time_stamp,
        a.origin_time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition as origin_load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_tracked_events_joined

)

select * from final
    );
  
[0m09:23:06.359399 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

vessel_derivied_fields as (

    select 
        imo,
        mmsi,
        vessel_name,
        generic_type,
        detailed_type,
        status,
        call_sign,
        flag,
        gross_tonnage,
        dwt,
        length,
        width,
        case when length >= 366 and width >= 49 then 1 else 0 end as is_ulcv, 
        year_built
    from source_vessel_info
),

final as (

    select * from source_vessel_info

)

select * from final
    );
  
[0m09:23:06.464992 [debug] [Thread-2 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:23:06.465516 [debug] [Thread-2 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m09:23:09.304170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:8ce2aded-e419-4e1d-9a6c-13ef5867ee03:US&page=queryresults
[0m09:23:09.347698 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:f5e62867-1549-48d4-85ba-3dc7b60bc0a6:US&page=queryresults
[0m09:23:09.351173 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:09.353104 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:09.353817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1862b2e0>]}
[0m09:23:09.354532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1745a980>]}
[0m09:23:09.355012 [info ] [Thread-1 (]: 1 of 4 OK created sql table model data_science.stg_vessel_info ................. [[32mCREATE TABLE (2.3k rows, 2.1 MB processed)[0m in 4.71s]
[0m09:23:09.355449 [info ] [Thread-2 (]: 2 of 4 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 4.71s]
[0m09:23:09.356021 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m09:23:09.356553 [debug] [Thread-2 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:23:22.818170 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:acca24c0-7ef6-408c-9854-f98d9388a1b8:US&page=queryresults
[0m09:23:22.822463 [debug] [Thread-3 (]: finished collecting timing info
[0m09:23:22.823065 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf1c909a80>]}
[0m09:23:22.823431 [info ] [Thread-3 (]: 3 of 4 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (34.5m rows, 467.5 MB processed)[0m in 18.18s]
[0m09:23:22.823859 [debug] [Thread-3 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m09:23:22.824731 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:23:22.825011 [info ] [Thread-1 (]: 4 of 4 START sql table model data_science.mart_vessel_tracked_events ........... [RUN]
[0m09:23:22.825658 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:23:22.825837 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:23:22.825995 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:23:22.829042 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:23:22.829439 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:22.829647 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:23:22.831831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:24.361811 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.mart_vessel_tracked_events"
[0m09:23:24.362238 [debug] [Thread-1 (]: On model.vessel_assessment_bq.mart_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.mart_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`mart_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      select * from `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    );
  
[0m09:23:36.234027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:77b5148d-a2bf-46d9-9f7c-c3d512edf092:US&page=queryresults
[0m09:23:36.238307 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:36.238963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9701ba99-f7bc-4494-a42f-46393e14e5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf17458970>]}
[0m09:23:36.239326 [info ] [Thread-1 (]: 4 of 4 OK created sql table model data_science.mart_vessel_tracked_events ...... [[32mCREATE TABLE (34.5m rows, 6.0 GB processed)[0m in 13.41s]
[0m09:23:36.239764 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.mart_vessel_tracked_events
[0m09:23:36.241148 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:23:36.241697 [info ] [MainThread]: 
[0m09:23:36.241991 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 34.74 seconds (34.74s).
[0m09:23:36.242252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:36.242391 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.mart_vessel_tracked_events' was properly closed.
[0m09:23:36.242527 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m09:23:36.242680 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m09:23:36.251364 [info ] [MainThread]: 
[0m09:23:36.251829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:23:36.252176 [info ] [MainThread]: 
[0m09:23:36.252455 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:23:36.252818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf175010f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf183c7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf174f35e0>]}
[0m09:23:36.253106 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:28:39.197492 | e5c13ae2-046a-4ca8-bbab-5cc0ce700707 ==============================
[0m09:28:39.197503 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:28:39.197856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:28:39.198004 [debug] [MainThread]: Tracking: tracking
[0m09:28:39.199328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57e3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57e3f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57e3de40>]}
[0m09:28:39.245271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:39.245651 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m09:28:39.258385 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m09:28:39.286063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5c13ae2-046a-4ca8-bbab-5cc0ce700707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d56c6d0c0>]}
[0m09:28:39.292682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5c13ae2-046a-4ca8-bbab-5cc0ce700707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57bb72b0>]}
[0m09:28:39.292954 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:28:39.293201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c13ae2-046a-4ca8-bbab-5cc0ce700707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57bb72e0>]}
[0m09:28:39.294118 [info ] [MainThread]: 
[0m09:28:39.294724 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:28:39.295580 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:28:39.295829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:40.885222 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:28:40.886126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:42.413503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c13ae2-046a-4ca8-bbab-5cc0ce700707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57bdfdc0>]}
[0m09:28:42.415327 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:28:42.416189 [info ] [MainThread]: 
[0m09:28:42.423283 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m09:28:42.423635 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m09:28:42.424375 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m09:28:42.424579 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m09:28:42.424761 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m09:28:42.429838 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:28:42.430245 [debug] [Thread-1 (]: finished collecting timing info
[0m09:28:42.430476 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m09:28:42.449067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:43.979820 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:28:43.980266 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

vessel_derived_fields as (

    select 
        imo,
        mmsi,
        vessel_name,
        generic_type,
        detailed_type,
        status,
        call_sign,
        flag,
        gross_tonnage,
        dwt,
        length,
        width,
        case when length >= 366 and width >= 49 then 1 else 0 end as is_ulcv, 
        year_built
    from source_vessel_info
),

final as (

    select * from vessel_derived_fields

)

select * from final
    );
  
[0m09:28:47.123744 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4e6e150c-d390-41a2-aa83-9e330068b465:US&page=queryresults
[0m09:28:47.145825 [debug] [Thread-1 (]: finished collecting timing info
[0m09:28:47.146448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5c13ae2-046a-4ca8-bbab-5cc0ce700707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d56c6ccd0>]}
[0m09:28:47.146825 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_info ................. [[32mCREATE TABLE (2.3k rows, 2.1 MB processed)[0m in 4.72s]
[0m09:28:47.147259 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m09:28:47.148695 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:28:47.149209 [info ] [MainThread]: 
[0m09:28:47.149493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m09:28:47.149750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:47.149888 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_info' was properly closed.
[0m09:28:47.157145 [info ] [MainThread]: 
[0m09:28:47.157457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:47.157752 [info ] [MainThread]: 
[0m09:28:47.157990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:28:47.158368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57bdffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57becd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d57becca0>]}
[0m09:28:47.158735 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:28:59.633869 | 905a89c2-62f0-48a6-9b49-df785b4cd308 ==============================
[0m09:28:59.633880 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:28:59.634385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:28:59.634549 [debug] [MainThread]: Tracking: tracking
[0m09:28:59.635901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9df3bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9df3b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9df3bfa0>]}
[0m09:28:59.681370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:28:59.681557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:28:59.687214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '905a89c2-62f0-48a6-9b49-df785b4cd308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dd24d60>]}
[0m09:28:59.694143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '905a89c2-62f0-48a6-9b49-df785b4cd308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dce9870>]}
[0m09:28:59.694466 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:28:59.694782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '905a89c2-62f0-48a6-9b49-df785b4cd308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dce98d0>]}
[0m09:28:59.695685 [info ] [MainThread]: 
[0m09:28:59.696272 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:28:59.697103 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:28:59.697397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:01.667910 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:29:01.668523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:03.136050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '905a89c2-62f0-48a6-9b49-df785b4cd308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dcdbc40>]}
[0m09:29:03.137824 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:29:03.138696 [info ] [MainThread]: 
[0m09:29:03.147755 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_info
[0m09:29:03.148533 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_info ...................... [RUN]
[0m09:29:03.150331 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_info"
[0m09:29:03.150814 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_info
[0m09:29:03.151238 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_info
[0m09:29:03.159564 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:29:03.160493 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:03.160994 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_info
[0m09:29:03.187967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:04.663831 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_info"
[0m09:29:04.664267 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_info: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_info"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_info`
    
    
    OPTIONS()
    as (
      with source_vessel_info as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_info`
),

vessel_derived_fields as (

    select 
        imo,
        mmsi,
        vessel_name,
        generic_type,
        detailed_type,
        status,
        call_sign,
        flag,
        gross_tonnage,
        dwt,
        length,
        width,
        case when length >= 366 and width >= 49 then 1 else 0 end as is_ulcv, 
        year_built
    from source_vessel_info
),

final as (

    select * from vessel_derived_fields

)

select * from final
    );
  
[0m09:29:07.557705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:832f6cab-fdb0-4d9c-9017-7c7893680db9:US&page=queryresults
[0m09:29:07.578890 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:07.579494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905a89c2-62f0-48a6-9b49-df785b4cd308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dd0a440>]}
[0m09:29:07.579861 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_info ................. [[32mCREATE TABLE (2.3k rows, 2.1 MB processed)[0m in 4.43s]
[0m09:29:07.580299 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_info
[0m09:29:07.581705 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:29:07.582221 [info ] [MainThread]: 
[0m09:29:07.582510 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m09:29:07.582984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:07.583134 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_info' was properly closed.
[0m09:29:07.597774 [info ] [MainThread]: 
[0m09:29:07.598165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:29:07.598482 [info ] [MainThread]: 
[0m09:29:07.598864 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:29:07.599205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa228db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dbaa8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9dbaa800>]}
[0m09:29:07.599452 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:45:49.028931 | 72270c47-8136-4769-837a-7b24d0d7f814 ==============================
[0m09:45:49.028942 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:45:49.029315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_ports'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:45:49.029480 [debug] [MainThread]: Tracking: tracking
[0m09:45:49.030868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97063fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97063fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97063fe20>]}
[0m09:45:49.076946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:45:49.077321 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_info.sql
[0m09:45:49.077554 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_ports.sql
[0m09:45:49.090530 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_info.sql
[0m09:45:49.102116 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_ports.sql
[0m09:45:49.120577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72270c47-8136-4769-837a-7b24d0d7f814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc973ae0af0>]}
[0m09:45:49.127161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72270c47-8136-4769-837a-7b24d0d7f814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9703b3df0>]}
[0m09:45:49.127444 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:45:49.127698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72270c47-8136-4769-837a-7b24d0d7f814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9703b3dc0>]}
[0m09:45:49.128619 [info ] [MainThread]: 
[0m09:45:49.129225 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:45:49.130068 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:45:49.130386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:51.387643 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:45:51.388278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:52.981665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72270c47-8136-4769-837a-7b24d0d7f814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970431240>]}
[0m09:45:52.983484 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:45:52.984379 [info ] [MainThread]: 
[0m09:45:52.989289 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:45:52.989604 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:45:52.990274 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:45:52.990456 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:45:52.990622 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:45:52.994130 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:45:52.994539 [debug] [Thread-1 (]: finished collecting timing info
[0m09:45:52.994766 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:45:53.013477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:54.642869 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:45:54.643337 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),


vessel_ports_bad_code as (
    
    select 
        *,
        case when left(code,2) = left(country_code,2) then 1 else 0 end as is_correct_code 

    from source_vessel_ports 

)

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m09:45:55.058301 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [27:1]')
[0m09:45:56.190114 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:68e89e0d-a256-4ad0-88fa-a14e54db41e2&page=queryresults
[0m09:45:56.191581 [debug] [Thread-1 (]: finished collecting timing info
[0m09:45:56.193049 [debug] [Thread-1 (]: Database Error in model stg_vessel_ports (models/staging/stg_vessel_ports.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [27:1]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_ports.sql
[0m09:45:56.193324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72270c47-8136-4769-837a-7b24d0d7f814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96f51f280>]}
[0m09:45:56.193686 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_ports ............ [[31mERROR[0m in 3.20s]
[0m09:45:56.194148 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:45:56.195495 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:45:56.196058 [info ] [MainThread]: 
[0m09:45:56.196390 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m09:45:56.196742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:56.196947 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m09:45:56.206330 [info ] [MainThread]: 
[0m09:45:56.206764 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:45:56.207158 [info ] [MainThread]: 
[0m09:45:56.207498 [error] [MainThread]: [33mDatabase Error in model stg_vessel_ports (models/staging/stg_vessel_ports.sql)[0m
[0m09:45:56.207826 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [27:1]
[0m09:45:56.208145 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_ports.sql
[0m09:45:56.208471 [info ] [MainThread]: 
[0m09:45:56.208990 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:45:56.209627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9703db3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96f4f9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96f46cf10>]}
[0m09:45:56.209919 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:46:23.920705 | f7ce93e7-2dfd-49f0-bd99-a8cb5ce7ff90 ==============================
[0m09:46:23.920716 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:46:23.921086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_ports'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:46:23.921248 [debug] [MainThread]: Tracking: tracking
[0m09:46:23.922586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8f3bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8f3bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8f3bf40>]}
[0m09:46:23.968545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:23.968900 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_ports.sql
[0m09:46:23.982068 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_ports.sql
[0m09:46:24.009382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ce93e7-2dfd-49f0-bd99-a8cb5ce7ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df3b20e50>]}
[0m09:46:24.015873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ce93e7-2dfd-49f0-bd99-a8cb5ce7ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8cb32b0>]}
[0m09:46:24.016247 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:46:24.016499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ce93e7-2dfd-49f0-bd99-a8cb5ce7ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8cb32e0>]}
[0m09:46:24.017439 [info ] [MainThread]: 
[0m09:46:24.018042 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:46:24.018961 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:46:24.019293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:26.496789 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:46:26.497425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:28.725077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ce93e7-2dfd-49f0-bd99-a8cb5ce7ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8cdbbb0>]}
[0m09:46:28.726551 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:46:28.726872 [info ] [MainThread]: 
[0m09:46:28.732499 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:46:28.732848 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:46:28.733614 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:46:28.733813 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:46:28.734000 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:46:28.738742 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:46:28.739118 [debug] [Thread-1 (]: finished collecting timing info
[0m09:46:28.739299 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:46:28.756297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:30.810227 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:46:30.810695 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),


vessel_ports_bad_code as (
    
    select 
        *,
        case when left(code,2) = left(country_code,2) then 1 else 0 end as is_correct_code 

    from source_vessel_ports 

),

final as (

    select * from source_vessel_ports

)

select * from final
    );
  
[0m09:46:34.074608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:7fe8dfeb-d523-4690-a5b6-d61c19b27e4c:US&page=queryresults
[0m09:46:34.096799 [debug] [Thread-1 (]: finished collecting timing info
[0m09:46:34.097409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ce93e7-2dfd-49f0-bd99-a8cb5ce7ff90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df3b20af0>]}
[0m09:46:34.097768 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 5.36s]
[0m09:46:34.098233 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:46:34.099542 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:46:34.100066 [info ] [MainThread]: 
[0m09:46:34.100351 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m09:46:34.100615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:34.100753 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m09:46:34.108033 [info ] [MainThread]: 
[0m09:46:34.108349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:34.108696 [info ] [MainThread]: 
[0m09:46:34.108957 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:46:34.109430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8cdb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8d2bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df8cec190>]}
[0m09:46:34.109687 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:49:10.486631 | 6b29fa4b-80f6-4100-9ad6-b1ad12b7e4ce ==============================
[0m09:49:10.486641 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:49:10.487054 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_ports'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:49:10.487216 [debug] [MainThread]: Tracking: tracking
[0m09:49:10.488486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c32b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c32b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c32b760>]}
[0m09:49:10.534425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:10.534871 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_ports.sql
[0m09:49:10.547669 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_ports.sql
[0m09:49:10.574318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b29fa4b-80f6-4100-9ad6-b1ad12b7e4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af5ca30>]}
[0m09:49:10.580554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b29fa4b-80f6-4100-9ad6-b1ad12b7e4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c09feb0>]}
[0m09:49:10.580902 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:49:10.581153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b29fa4b-80f6-4100-9ad6-b1ad12b7e4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c09fe80>]}
[0m09:49:10.582064 [info ] [MainThread]: 
[0m09:49:10.582666 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:49:10.583595 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:49:10.583915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:12.662892 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:49:12.663812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:14.094151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b29fa4b-80f6-4100-9ad6-b1ad12b7e4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c32a620>]}
[0m09:49:14.095997 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:49:14.096871 [info ] [MainThread]: 
[0m09:49:14.103871 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:49:14.104249 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:49:14.105005 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:49:14.105207 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:49:14.105390 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:49:14.110120 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:49:14.110510 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:14.110711 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:49:14.128310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:15.764200 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:49:15.764657 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),


vessel_ports_bad_code as (
    
    select 
        *,
        case when left(code,2) = left(country_code,2) then 1 else 0 end as is_correct_code 

    from source_vessel_ports 

),

final as (

    select * from vessel_ports_bad_code

)

select * from final
    );
  
[0m09:49:19.056632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:7c0b1f37-775c-4d06-9342-e5c91ca9f47e:US&page=queryresults
[0m09:49:19.078345 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:19.078960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b29fa4b-80f6-4100-9ad6-b1ad12b7e4ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af5c8e0>]}
[0m09:49:19.079321 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 4.97s]
[0m09:49:19.079755 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:49:19.081441 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:49:19.081954 [info ] [MainThread]: 
[0m09:49:19.082234 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.50 seconds (8.50s).
[0m09:49:19.082535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:19.082778 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m09:49:19.090045 [info ] [MainThread]: 
[0m09:49:19.090355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:19.090834 [info ] [MainThread]: 
[0m09:49:19.091233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:49:19.091625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c0d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c0c79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65c0c7940>]}
[0m09:49:19.091889 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 09:58:35.757268 | 7a3b706a-b470-40af-947d-ce9615fb75d6 ==============================
[0m09:58:35.757299 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:58:35.757744 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_ports'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:58:35.757904 [debug] [MainThread]: Tracking: tracking
[0m09:58:35.759311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e73baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e73bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e73bf10>]}
[0m09:58:35.806248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:35.806470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:35.812312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a3b706a-b470-40af-947d-ce9615fb75d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e520ca0>]}
[0m09:58:35.819378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a3b706a-b470-40af-947d-ce9615fb75d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e4ed7b0>]}
[0m09:58:35.819707 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:58:35.819939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3b706a-b470-40af-947d-ce9615fb75d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e4ed810>]}
[0m09:58:35.820842 [info ] [MainThread]: 
[0m09:58:35.821457 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:58:35.822489 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m09:58:35.822875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:38.023831 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m09:58:38.024458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:39.752182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3b706a-b470-40af-947d-ce9615fb75d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e4b36a0>]}
[0m09:58:39.754002 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:58:39.754915 [info ] [MainThread]: 
[0m09:58:39.760131 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:58:39.760430 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m09:58:39.761064 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:58:39.761237 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m09:58:39.761409 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m09:58:39.764816 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:58:39.765188 [debug] [Thread-1 (]: finished collecting timing info
[0m09:58:39.765386 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m09:58:39.785003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:41.939035 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m09:58:41.939467 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),


vessel_ports_bad_code as (
    
    select 
        *,
        case when left(code,2) = left(country_code,2) then 1 else 0 end as is_correct_code 

    from source_vessel_ports 

),

final as (

    select * from vessel_ports_bad_code

)

select * from final
    );
  
[0m09:58:44.869154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:09113616-ccbb-4d2e-bf0c-6836bcc28e4e:US&page=queryresults
[0m09:58:44.884954 [debug] [Thread-1 (]: finished collecting timing info
[0m09:58:44.885559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3b706a-b470-40af-947d-ce9615fb75d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e505c60>]}
[0m09:58:44.886186 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 5.12s]
[0m09:58:44.886692 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m09:58:44.888192 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:58:44.888626 [info ] [MainThread]: 
[0m09:58:44.888853 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m09:58:44.889108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:44.889255 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m09:58:44.902491 [info ] [MainThread]: 
[0m09:58:44.902875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:44.903173 [info ] [MainThread]: 
[0m09:58:44.903403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:58:44.903716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4312a99b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e506290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430e5073d0>]}
[0m09:58:44.903964 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 10:00:07.824390 | 96a460e8-8476-44fe-94e6-f1a31b56104d ==============================
[0m10:00:07.824401 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:00:07.824761 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_ports'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:00:07.824944 [debug] [MainThread]: Tracking: tracking
[0m10:00:07.826343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c37276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c3727220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c3725f90>]}
[0m10:00:07.872240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:00:07.872608 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_ports.sql
[0m10:00:07.884990 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_ports.sql
[0m10:00:07.912424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a460e8-8476-44fe-94e6-f1a31b56104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c350a350>]}
[0m10:00:07.918844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a460e8-8476-44fe-94e6-f1a31b56104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c349f340>]}
[0m10:00:07.919126 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:00:07.919375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a460e8-8476-44fe-94e6-f1a31b56104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c6be61d0>]}
[0m10:00:07.920282 [info ] [MainThread]: 
[0m10:00:07.920897 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:00:07.921754 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m10:00:07.922047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:10.265716 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m10:00:10.266079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:11.858814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a460e8-8476-44fe-94e6-f1a31b56104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c34c79a0>]}
[0m10:00:11.860627 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m10:00:11.861480 [info ] [MainThread]: 
[0m10:00:11.869385 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_ports
[0m10:00:11.869759 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_ports ..................... [RUN]
[0m10:00:11.870447 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_ports"
[0m10:00:11.870626 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_ports
[0m10:00:11.870802 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_ports
[0m10:00:11.875514 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m10:00:11.875909 [debug] [Thread-1 (]: finished collecting timing info
[0m10:00:11.876108 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_ports
[0m10:00:11.893458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:13.446754 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_ports"
[0m10:00:13.447259 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_ports: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_ports"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_ports`
    
    
    OPTIONS()
    as (
      with source_vessel_ports as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_ports`
),


vessel_ports_derived_fields as (
    
    select 
        *,
        concat(port,'-',country_code) as unique_port,
        case when left(code,2) = left(country_code,2) then 1 else 0 end as is_correct_code 

    from source_vessel_ports 

),

final as (

    select * from vessel_ports_derived_fields

)

select * from final
    );
  
[0m10:00:17.024997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:eae7f0ac-f1b1-4124-84af-55a6f9de8447:US&page=queryresults
[0m10:00:17.046373 [debug] [Thread-1 (]: finished collecting timing info
[0m10:00:17.046994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a460e8-8476-44fe-94e6-f1a31b56104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c255cdc0>]}
[0m10:00:17.047363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_ports ................ [[32mCREATE TABLE (3.4k rows, 1.4 MB processed)[0m in 5.18s]
[0m10:00:17.047795 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_ports
[0m10:00:17.049341 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:00:17.049860 [info ] [MainThread]: 
[0m10:00:17.050143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m10:00:17.050443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:17.050678 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_ports' was properly closed.
[0m10:00:17.058000 [info ] [MainThread]: 
[0m10:00:17.058311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:17.058792 [info ] [MainThread]: 
[0m10:00:17.059188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:00:17.059601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c350a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c35187c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c34d9720>]}
[0m10:00:17.059860 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 10:48:05.984919 | 510c08c4-0081-444d-86c5-afc79ea55039 ==============================
[0m10:48:05.984930 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:48:05.985587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:48:05.985765 [debug] [MainThread]: Tracking: tracking
[0m10:48:05.987122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c63f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c63fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c63fdf0>]}
[0m10:48:06.034041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:06.034420 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m10:48:06.047830 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m10:48:06.074964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '510c08c4-0081-444d-86c5-afc79ea55039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2b26ccd0>]}
[0m10:48:06.081314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '510c08c4-0081-444d-86c5-afc79ea55039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c3b3ca0>]}
[0m10:48:06.081606 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:48:06.081857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '510c08c4-0081-444d-86c5-afc79ea55039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c3c9720>]}
[0m10:48:06.082835 [info ] [MainThread]: 
[0m10:48:06.083432 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:48:06.084248 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m10:48:06.084513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:08.534932 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m10:48:08.535570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:11.022473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '510c08c4-0081-444d-86c5-afc79ea55039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c3dbc10>]}
[0m10:48:11.023154 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m10:48:11.023468 [info ] [MainThread]: 
[0m10:48:11.029155 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:48:11.029511 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m10:48:11.030180 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m10:48:11.030360 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:48:11.030517 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:48:11.035173 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m10:48:11.035568 [debug] [Thread-1 (]: finished collecting timing info
[0m10:48:11.035776 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:48:11.054401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:13.219873 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m10:48:13.220308 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        concat(port_at_call,'-',port_at_call_country) as port,
    from source_vessel_tracking_events
 
    union

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m10:48:13.711783 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]')
[0m10:48:15.136680 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:fb869496-cde9-40b1-aae8-ff4f53afafab&page=queryresults
[0m10:48:15.137945 [debug] [Thread-1 (]: finished collecting timing info
[0m10:48:15.139411 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m10:48:15.139669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '510c08c4-0081-444d-86c5-afc79ea55039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2b157a60>]}
[0m10:48:15.140016 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 4.11s]
[0m10:48:15.140419 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:48:15.142041 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:48:15.142569 [info ] [MainThread]: 
[0m10:48:15.142868 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.06 seconds (9.06s).
[0m10:48:15.143128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:15.143284 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m10:48:15.151157 [info ] [MainThread]: 
[0m10:48:15.151476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:48:15.151761 [info ] [MainThread]: 
[0m10:48:15.152002 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m10:48:15.152239 [error] [MainThread]:   Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]
[0m10:48:15.152463 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m10:48:15.152692 [info ] [MainThread]: 
[0m10:48:15.152923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:48:15.153232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c3b3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c63d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c3dba60>]}
[0m10:48:15.153475 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 10:48:56.905200 | b0373254-07cb-41d2-b2e1-282da8e9403b ==============================
[0m10:48:56.905210 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:48:56.905581 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:48:56.905750 [debug] [MainThread]: Tracking: tracking
[0m10:48:56.907089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a44c3f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a44c3fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a44c3fcd0>]}
[0m10:48:56.953468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:56.953815 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m10:48:56.966835 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m10:48:56.993762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0373254-07cb-41d2-b2e1-282da8e9403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4406cbe0>]}
[0m10:48:57.000394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0373254-07cb-41d2-b2e1-282da8e9403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a449b3f70>]}
[0m10:48:57.000680 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m10:48:57.000925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0373254-07cb-41d2-b2e1-282da8e9403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a449c9630>]}
[0m10:48:57.001845 [info ] [MainThread]: 
[0m10:48:57.002453 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:48:57.003397 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m10:48:57.003691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:58.891156 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m10:48:58.892045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:00.910578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0373254-07cb-41d2-b2e1-282da8e9403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a44c3c3a0>]}
[0m10:49:00.912424 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m10:49:00.913282 [info ] [MainThread]: 
[0m10:49:00.920094 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:49:00.920444 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m10:49:00.921189 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m10:49:00.921391 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:49:00.921576 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:49:00.926624 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m10:49:00.927028 [debug] [Thread-1 (]: finished collecting timing info
[0m10:49:00.927215 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:49:00.944721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:03.194730 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m10:49:03.195166 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        concat(port_at_call,'-',port_at_call_country) as port,
    from source_vessel_tracking_events
 
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m10:49:07.257765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:085d5e25-7048-4228-8dd6-9cc4ee4c3006:US&page=queryresults
[0m10:49:07.280057 [debug] [Thread-1 (]: finished collecting timing info
[0m10:49:07.280682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0373254-07cb-41d2-b2e1-282da8e9403b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4406c8e0>]}
[0m10:49:07.281047 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (64.4k rows, 164.1 MB processed)[0m in 6.36s]
[0m10:49:07.281482 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m10:49:07.282816 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:49:07.283360 [info ] [MainThread]: 
[0m10:49:07.283642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m10:49:07.283898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:07.284037 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m10:49:07.291312 [info ] [MainThread]: 
[0m10:49:07.291620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:07.291921 [info ] [MainThread]: 
[0m10:49:07.292170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:49:07.292492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a449ec040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a449dbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a449dbdf0>]}
[0m10:49:07.292780 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 11:23:12.822063 | 8b07ead3-3885-4c89-8e78-baf922f5d454 ==============================
[0m11:23:12.822073 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:23:12.822446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:23:12.822611 [debug] [MainThread]: Tracking: tracking
[0m11:23:12.823985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6e27be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6e276a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6e27760>]}
[0m11:23:12.870384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:12.870821 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m11:23:12.884298 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m11:23:12.911714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b07ead3-3885-4c89-8e78-baf922f5d454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d5c5cf40>]}
[0m11:23:12.918334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b07ead3-3885-4c89-8e78-baf922f5d454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6b9f3a0>]}
[0m11:23:12.918599 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:23:12.918905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b07ead3-3885-4c89-8e78-baf922f5d454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6bb5990>]}
[0m11:23:12.919832 [info ] [MainThread]: 
[0m11:23:12.920435 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:12.921288 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m11:23:12.921622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:15.334657 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m11:23:15.335590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:17.358852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b07ead3-3885-4c89-8e78-baf922f5d454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6bc7b20>]}
[0m11:23:17.360629 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m11:23:17.361489 [info ] [MainThread]: 
[0m11:23:17.368621 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:23:17.368935 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m11:23:17.369589 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:23:17.369784 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:23:17.369967 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:23:17.374975 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:23:17.375416 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:17.375643 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:23:17.395900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:19.293191 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:23:19.293637 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        REGEXP_EXTRACT(tags,'(?i)anch.[^,]*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m11:23:20.938890 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: tags at [21:24]')
[0m11:23:22.568395 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:1232513f-3532-4fea-9b70-902679f21853&page=queryresults
[0m11:23:22.569384 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:22.570838 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: tags at [21:24]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m11:23:22.571577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b07ead3-3885-4c89-8e78-baf922f5d454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d5d3ff40>]}
[0m11:23:22.572139 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.20s]
[0m11:23:22.572565 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:23:22.574006 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:22.574533 [info ] [MainThread]: 
[0m11:23:22.574872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.65 seconds (9.65s).
[0m11:23:22.575170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:22.575328 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m11:23:22.584736 [info ] [MainThread]: 
[0m11:23:22.585152 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:23:22.585540 [info ] [MainThread]: 
[0m11:23:22.585872 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m11:23:22.586199 [error] [MainThread]:   Unrecognized name: tags at [21:24]
[0m11:23:22.586508 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m11:23:22.586854 [info ] [MainThread]: 
[0m11:23:22.587175 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:23:22.587595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6bc76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6c192d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d6bd8100>]}
[0m11:23:22.587919 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 11:23:59.304824 | 7dea7c8f-7e38-4b07-993d-eecfed1bbaed ==============================
[0m11:23:59.304834 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:23:59.305195 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:23:59.305369 [debug] [MainThread]: Tracking: tracking
[0m11:23:59.306688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a6b3fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a6b3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a6b3f730>]}
[0m11:23:59.354548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:59.355006 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m11:23:59.368048 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m11:23:59.395233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dea7c8f-7e38-4b07-993d-eecfed1bbaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a5771030>]}
[0m11:23:59.401678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dea7c8f-7e38-4b07-993d-eecfed1bbaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a68b73a0>]}
[0m11:23:59.402008 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:23:59.402254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dea7c8f-7e38-4b07-993d-eecfed1bbaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a68cda80>]}
[0m11:23:59.403244 [info ] [MainThread]: 
[0m11:23:59.403850 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:59.404725 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m11:23:59.404998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:01.486382 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m11:24:01.487042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:03.434067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dea7c8f-7e38-4b07-993d-eecfed1bbaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a68dfee0>]}
[0m11:24:03.435890 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m11:24:03.436749 [info ] [MainThread]: 
[0m11:24:03.443569 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:24:03.443884 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m11:24:03.444537 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:24:03.444713 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:24:03.444875 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:24:03.449700 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:24:03.450091 [debug] [Thread-1 (]: finished collecting timing info
[0m11:24:03.450280 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:24:03.467643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:05.606687 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:24:05.607752 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        REGEXP_EXTRACT(port_at_call,'(?i)anch.[^,]*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m11:24:09.103431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4dd5714f-3728-4095-8af1-a599cbc79972:US&page=queryresults
[0m11:24:09.147784 [debug] [Thread-1 (]: finished collecting timing info
[0m11:24:09.148520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dea7c8f-7e38-4b07-993d-eecfed1bbaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a5770af0>]}
[0m11:24:09.148954 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (62.1k rows, 78.8 MB processed)[0m in 5.70s]
[0m11:24:09.149476 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:24:09.151133 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:24:09.151672 [info ] [MainThread]: 
[0m11:24:09.151959 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m11:24:09.152221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:09.152361 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m11:24:09.159651 [info ] [MainThread]: 
[0m11:24:09.159968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:09.160295 [info ] [MainThread]: 
[0m11:24:09.160541 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:24:09.160893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a68dfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a68f0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a68f1840>]}
[0m11:24:09.161211 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 11:26:23.717080 | 8381750b-299f-4a96-b292-3badf2387a65 ==============================
[0m11:26:23.717090 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:26:23.717458 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:26:23.717619 [debug] [MainThread]: Tracking: tracking
[0m11:26:23.718960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bd27c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bd276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bd27730>]}
[0m11:26:23.764897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:23.765272 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m11:26:23.778621 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m11:26:23.805993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8381750b-299f-4a96-b292-3badf2387a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86a95cfd0>]}
[0m11:26:23.812437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8381750b-299f-4a96-b292-3badf2387a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86ba9f3a0>]}
[0m11:26:23.812764 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:26:23.813024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8381750b-299f-4a96-b292-3badf2387a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bab5a20>]}
[0m11:26:23.813889 [info ] [MainThread]: 
[0m11:26:23.814444 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:26:23.815371 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m11:26:23.815695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:25.973213 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m11:26:25.974111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:27.303321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8381750b-299f-4a96-b292-3badf2387a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bac7be0>]}
[0m11:26:27.305110 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m11:26:27.305960 [info ] [MainThread]: 
[0m11:26:27.313318 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:26:27.313669 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m11:26:27.314411 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:26:27.314611 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:26:27.314823 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:26:27.319771 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:26:27.320168 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:27.320358 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:26:27.337913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:28.865370 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:26:28.865824 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        REGEXP_EXTRACT(port_at_call,'(?i)anch.[^,]*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m11:26:32.016920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4ea25982-3c37-4d75-8fd0-6a6f1ffcdd15:US&page=queryresults
[0m11:26:32.038889 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:32.039520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8381750b-299f-4a96-b292-3badf2387a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86a95cb50>]}
[0m11:26:32.039887 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 4.73s]
[0m11:26:32.040333 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:26:32.041768 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:26:32.042282 [info ] [MainThread]: 
[0m11:26:32.042560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m11:26:32.042833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:32.042970 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m11:26:32.050206 [info ] [MainThread]: 
[0m11:26:32.050515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:32.050833 [info ] [MainThread]: 
[0m11:26:32.051080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:26:32.051400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bac7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bb19360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86bad8340>]}
[0m11:26:32.051645 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 11:29:45.787080 | 9d9a3bca-510a-4599-8386-ba6285b57e65 ==============================
[0m11:29:45.787090 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:29:45.787456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:29:45.787619 [debug] [MainThread]: Tracking: tracking
[0m11:29:45.788916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87ba3f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87ba3fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87ba3fcd0>]}
[0m11:29:45.835994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:29:45.836447 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m11:29:45.849202 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m11:29:45.876414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d9a3bca-510a-4599-8386-ba6285b57e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87a668be0>]}
[0m11:29:45.883153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d9a3bca-510a-4599-8386-ba6285b57e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b7b3f70>]}
[0m11:29:45.883471 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:29:45.883728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9a3bca-510a-4599-8386-ba6285b57e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b7c9630>]}
[0m11:29:45.884630 [info ] [MainThread]: 
[0m11:29:45.885201 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:29:45.886035 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m11:29:45.886346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:48.050195 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m11:29:48.051107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:49.394747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9a3bca-510a-4599-8386-ba6285b57e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87ba3c460>]}
[0m11:29:49.396553 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m11:29:49.397417 [info ] [MainThread]: 
[0m11:29:49.410965 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:29:49.411849 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m11:29:49.413765 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:29:49.414301 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:29:49.414999 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:29:49.419836 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:29:49.420206 [debug] [Thread-1 (]: finished collecting timing info
[0m11:29:49.420389 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:29:49.438583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:50.839532 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:29:50.840002 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        REGEXP_EXTRACT(port_at_call,'(?i)anch*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m11:29:54.245450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:ff7b402b-0e17-4985-a18b-e5ed0295b851:US&page=queryresults
[0m11:29:54.267185 [debug] [Thread-1 (]: finished collecting timing info
[0m11:29:54.267815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9a3bca-510a-4599-8386-ba6285b57e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87a668940>]}
[0m11:29:54.268183 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 4.86s]
[0m11:29:54.268620 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:29:54.270030 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:29:54.270557 [info ] [MainThread]: 
[0m11:29:54.270868 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m11:29:54.271172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:54.271345 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m11:29:54.278792 [info ] [MainThread]: 
[0m11:29:54.279102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:29:54.279569 [info ] [MainThread]: 
[0m11:29:54.279965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:29:54.280368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b7ec040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87ba3eef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87a709210>]}
[0m11:29:54.280632 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 11:30:57.300033 | ca15f83d-d353-47b7-bb88-2495d61413a1 ==============================
[0m11:30:57.300043 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:30:57.300416 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:30:57.300576 [debug] [MainThread]: Tracking: tracking
[0m11:30:57.301908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1d12b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1d12b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1d12b490>]}
[0m11:30:57.347528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:30:57.347884 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m11:30:57.361073 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m11:30:57.391761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca15f83d-d353-47b7-bb88-2495d61413a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e17f13e50>]}
[0m11:30:57.398220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca15f83d-d353-47b7-bb88-2495d61413a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1ce9faf0>]}
[0m11:30:57.398567 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:30:57.398908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca15f83d-d353-47b7-bb88-2495d61413a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1ceb51b0>]}
[0m11:30:57.399820 [info ] [MainThread]: 
[0m11:30:57.400393 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:30:57.401256 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m11:30:57.401524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:59.181480 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m11:30:59.182353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:00.818078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca15f83d-d353-47b7-bb88-2495d61413a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1d12a380>]}
[0m11:31:00.819930 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m11:31:00.820806 [info ] [MainThread]: 
[0m11:31:00.827855 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:31:00.828178 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m11:31:00.828844 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:31:00.829022 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:31:00.829185 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:31:00.834010 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:31:00.834405 [debug] [Thread-1 (]: finished collecting timing info
[0m11:31:00.834597 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:31:00.852367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:02.276358 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m11:31:02.276791 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_EXTRACT(port_at_call,'(?i)anch*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m11:31:05.526185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:68da31b9-c72c-40d6-9451-2d4b89562151:US&page=queryresults
[0m11:31:05.547949 [debug] [Thread-1 (]: finished collecting timing info
[0m11:31:05.548585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15f83d-d353-47b7-bb88-2495d61413a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e17f10be0>]}
[0m11:31:05.548941 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 4.72s]
[0m11:31:05.549367 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m11:31:05.550825 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:31:05.551419 [info ] [MainThread]: 
[0m11:31:05.551702 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m11:31:05.551959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:05.552123 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m11:31:05.559407 [info ] [MainThread]: 
[0m11:31:05.559751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:05.560054 [info ] [MainThread]: 
[0m11:31:05.560301 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:31:05.560627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1ced8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1cec7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1cec7700>]}
[0m11:31:05.560877 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:01:50.905610 | 0fe53ec0-14a9-4dd8-9e17-81eb3c68820a ==============================
[0m12:01:50.905620 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:01:50.906099 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:01:50.906249 [debug] [MainThread]: Tracking: tracking
[0m12:01:50.907753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186193f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186193f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186193f7c0>]}
[0m12:01:50.956265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:01:50.956635 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:01:50.970486 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:01:51.001451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fe53ec0-14a9-4dd8-9e17-81eb3c68820a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1860764ac0>]}
[0m12:01:51.008265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fe53ec0-14a9-4dd8-9e17-81eb3c68820a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18616b3e50>]}
[0m12:01:51.008560 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:01:51.008842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe53ec0-14a9-4dd8-9e17-81eb3c68820a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18616c9510>]}
[0m12:01:51.009835 [info ] [MainThread]: 
[0m12:01:51.010412 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:01:51.011363 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:01:51.011545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:53.677932 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:01:53.678883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:55.572954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe53ec0-14a9-4dd8-9e17-81eb3c68820a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186193e7a0>]}
[0m12:01:55.574811 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:01:55.575696 [info ] [MainThread]: 
[0m12:01:55.588950 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:01:55.589786 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:01:55.591568 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:01:55.592040 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:01:55.592344 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:01:55.596597 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:01:55.597001 [debug] [Thread-1 (]: finished collecting timing info
[0m12:01:55.597267 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:01:55.616582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:57.521716 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:01:57.522157 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_EXTRACT(port_at_call,'(?i)^anch') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:02:01.122347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:9183d41a-b677-420c-b6ce-929a84677249:US&page=queryresults
[0m12:02:01.163802 [debug] [Thread-1 (]: finished collecting timing info
[0m12:02:01.164546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fe53ec0-14a9-4dd8-9e17-81eb3c68820a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1860766110>]}
[0m12:02:01.164972 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 5.57s]
[0m12:02:01.165477 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:02:01.167068 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:02:01.167679 [info ] [MainThread]: 
[0m12:02:01.167994 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m12:02:01.168259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:01.168398 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:02:01.175669 [info ] [MainThread]: 
[0m12:02:01.175988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:01.176294 [info ] [MainThread]: 
[0m12:02:01.176544 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:02:01.176871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18616ec040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186193c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1860808fd0>]}
[0m12:02:01.177123 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:04:10.294686 | 1e804b6a-df5c-4c85-88c2-7c520ccb6255 ==============================
[0m12:04:10.294697 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:04:10.295155 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:04:10.295322 [debug] [MainThread]: Tracking: tracking
[0m12:04:10.296658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f1433a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f143490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f143430>]}
[0m12:04:10.343938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:10.344313 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:04:10.357721 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:04:10.386238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e804b6a-df5c-4c85-88c2-7c520ccb6255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165df6bdf0>]}
[0m12:04:10.393083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e804b6a-df5c-4c85-88c2-7c520ccb6255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165eeb7a90>]}
[0m12:04:10.393365 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:04:10.393603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e804b6a-df5c-4c85-88c2-7c520ccb6255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165eecd150>]}
[0m12:04:10.394514 [info ] [MainThread]: 
[0m12:04:10.395159 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:04:10.396037 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:04:10.396333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:11.734078 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:04:11.734934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:13.705160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e804b6a-df5c-4c85-88c2-7c520ccb6255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f143fd0>]}
[0m12:04:13.706979 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:04:13.707861 [info ] [MainThread]: 
[0m12:04:13.714640 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:13.715011 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:04:13.715747 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:04:13.715947 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:13.716131 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:13.721600 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:04:13.722148 [debug] [Thread-1 (]: finished collecting timing info
[0m12:04:13.722397 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:13.746811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:15.106889 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:04:15.107337 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_CONTAIN(port_at_call,'(?i)^anch') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:04:16.401565 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: REGEXP_CONTAIN; Did you mean regexp_contains? at [22:9]')
[0m12:04:17.762327 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:58d9a3d2-e09d-4ef0-ba9c-e90df764985c&page=queryresults
[0m12:04:17.763770 [debug] [Thread-1 (]: finished collecting timing info
[0m12:04:17.765081 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Function not found: REGEXP_CONTAIN; Did you mean regexp_contains? at [22:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m12:04:17.765348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e804b6a-df5c-4c85-88c2-7c520ccb6255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165de46770>]}
[0m12:04:17.765704 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 4.05s]
[0m12:04:17.766151 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:17.767650 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:04:17.768193 [info ] [MainThread]: 
[0m12:04:17.768488 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m12:04:17.768758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:17.768916 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:04:17.776972 [info ] [MainThread]: 
[0m12:04:17.777305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:17.777656 [info ] [MainThread]: 
[0m12:04:17.777928 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m12:04:17.778167 [error] [MainThread]:   Function not found: REGEXP_CONTAIN; Did you mean regexp_contains? at [22:9]
[0m12:04:17.778395 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m12:04:17.778628 [info ] [MainThread]: 
[0m12:04:17.778877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:04:17.779196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f140c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f1438e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165eedfdf0>]}
[0m12:04:17.779440 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:04:44.644993 | 42be9a6f-ea6d-43ce-955b-e4bcb68f1cdf ==============================
[0m12:04:44.645004 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:04:44.645352 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:04:44.645529 [debug] [MainThread]: Tracking: tracking
[0m12:04:44.646918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812783b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812783b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8127839f00>]}
[0m12:04:44.694442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:44.694902 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:04:44.708912 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:04:44.739342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42be9a6f-ea6d-43ce-955b-e4bcb68f1cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81266650f0>]}
[0m12:04:44.746110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42be9a6f-ea6d-43ce-955b-e4bcb68f1cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812ace0be0>]}
[0m12:04:44.746403 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:04:44.746652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42be9a6f-ea6d-43ce-955b-e4bcb68f1cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81275c9bd0>]}
[0m12:04:44.747750 [info ] [MainThread]: 
[0m12:04:44.748321 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:04:44.749369 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:04:44.749587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:47.140122 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:04:47.140958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:49.159849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42be9a6f-ea6d-43ce-955b-e4bcb68f1cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81275db910>]}
[0m12:04:49.161683 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:04:49.162552 [info ] [MainThread]: 
[0m12:04:49.169028 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:49.169388 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:04:49.170181 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:04:49.170388 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:49.170574 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:49.175331 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:04:49.175735 [debug] [Thread-1 (]: finished collecting timing info
[0m12:04:49.175917 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:49.193752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:51.190072 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:04:51.190535 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_CONTAINS(port_at_call,'(?i)^anch') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:04:54.294634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:447e495e-de28-4534-bbed-ffbe5e90501b:US&page=queryresults
[0m12:04:54.337351 [debug] [Thread-1 (]: finished collecting timing info
[0m12:04:54.338153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42be9a6f-ea6d-43ce-955b-e4bcb68f1cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8126664c40>]}
[0m12:04:54.338585 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 5.17s]
[0m12:04:54.339113 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:04:54.340597 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:04:54.341122 [info ] [MainThread]: 
[0m12:04:54.341406 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m12:04:54.341710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:54.341890 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:04:54.349255 [info ] [MainThread]: 
[0m12:04:54.349579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:54.349986 [info ] [MainThread]: 
[0m12:04:54.350323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:04:54.350770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81275dbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81275ec0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81275ecd00>]}
[0m12:04:54.351035 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:11:21.938695 | 799b24db-c458-46fe-873a-15b97ba03fce ==============================
[0m12:11:21.938752 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:11:21.939160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:11:21.939340 [debug] [MainThread]: Tracking: tracking
[0m12:11:21.940627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc063f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc063fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc063fdf0>]}
[0m12:11:21.991641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:21.992013 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:11:22.005581 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:11:22.034848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '799b24db-c458-46fe-873a-15b97ba03fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdbf264cd0>]}
[0m12:11:22.041721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '799b24db-c458-46fe-873a-15b97ba03fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc03b33a0>]}
[0m12:11:22.042037 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:11:22.042273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799b24db-c458-46fe-873a-15b97ba03fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc03c9720>]}
[0m12:11:22.043234 [info ] [MainThread]: 
[0m12:11:22.043812 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:11:22.044676 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:11:22.044969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:24.177914 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:11:24.178542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:26.081997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799b24db-c458-46fe-873a-15b97ba03fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc03dba90>]}
[0m12:11:26.083823 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:11:26.084685 [info ] [MainThread]: 
[0m12:11:26.091651 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:11:26.091977 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:11:26.092728 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:11:26.092941 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:11:26.093128 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:11:26.098307 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:11:26.098857 [debug] [Thread-1 (]: finished collecting timing info
[0m12:11:26.099111 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:11:26.123152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:27.661873 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:11:27.662377 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_CONTAINS(port_at_call,'(?i)^.*anch.*$') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:11:31.057787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:84802f39-6fbd-442d-9094-5d9e642f4677:US&page=queryresults
[0m12:11:31.082952 [debug] [Thread-1 (]: finished collecting timing info
[0m12:11:31.083598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799b24db-c458-46fe-873a-15b97ba03fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdbf264a60>]}
[0m12:11:31.083937 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 4.99s]
[0m12:11:31.084385 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:11:31.085765 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:11:31.086486 [info ] [MainThread]: 
[0m12:11:31.086920 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m12:11:31.087313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:31.087544 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:11:31.094907 [info ] [MainThread]: 
[0m12:11:31.095358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:31.095647 [info ] [MainThread]: 
[0m12:11:31.095875 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:11:31.096173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc03b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc063c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc03ed990>]}
[0m12:11:31.096405 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:12:44.868330 | 4073d5eb-700a-4911-8515-7546ba3d2cdd ==============================
[0m12:12:44.868348 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:12:44.868926 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:12:44.869199 [debug] [MainThread]: Tracking: tracking
[0m12:12:44.870951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b93f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b93f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b93df30>]}
[0m12:12:44.950008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:44.950464 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:12:44.966492 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:12:44.999881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4073d5eb-700a-4911-8515-7546ba3d2cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a56d120>]}
[0m12:12:45.007278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4073d5eb-700a-4911-8515-7546ba3d2cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017edf21d0>]}
[0m12:12:45.007605 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:12:45.007869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4073d5eb-700a-4911-8515-7546ba3d2cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b6cdc00>]}
[0m12:12:45.008835 [info ] [MainThread]: 
[0m12:12:45.009426 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:12:45.010362 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:12:45.010637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:46.882771 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:12:46.883343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:48.736544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4073d5eb-700a-4911-8515-7546ba3d2cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b6dbf70>]}
[0m12:12:48.738242 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:12:48.739099 [info ] [MainThread]: 
[0m12:12:48.751309 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:12:48.752148 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:12:48.753685 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:12:48.754102 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:12:48.754480 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:12:48.764480 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:12:48.765332 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:48.765811 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:12:48.788635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:50.625117 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:12:50.625572 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_EXTRACT(port_at_call,'(?i)^.*anch.*$') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:12:53.742175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:9704ffb0-d59d-424b-8fc9-96f61fc40d66:US&page=queryresults
[0m12:12:53.784781 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:53.785503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4073d5eb-700a-4911-8515-7546ba3d2cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a56cc10>]}
[0m12:12:53.785931 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 5.03s]
[0m12:12:53.786438 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:12:53.788064 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:12:53.788621 [info ] [MainThread]: 
[0m12:12:53.788912 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m12:12:53.789173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:53.789313 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:12:53.796660 [info ] [MainThread]: 
[0m12:12:53.796971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:53.797273 [info ] [MainThread]: 
[0m12:12:53.797589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:12:53.797948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b6dbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b6f0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b6f0d90>]}
[0m12:12:53.798221 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:28:07.999969 | 2f9603fb-8228-46f3-acf0-733d6682b9ef ==============================
[0m12:28:07.999979 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:28:08.000312 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:28:08.000456 [debug] [MainThread]: Tracking: tracking
[0m12:28:08.001777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a753fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a753f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a753f730>]}
[0m12:28:08.049928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:08.050299 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:28:08.064564 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:28:08.093197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f9603fb-8228-46f3-acf0-733d6682b9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a6168f40>]}
[0m12:28:08.099875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f9603fb-8228-46f3-acf0-733d6682b9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72b73a0>]}
[0m12:28:08.100176 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:28:08.100470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f9603fb-8228-46f3-acf0-733d6682b9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72cd990>]}
[0m12:28:08.101480 [info ] [MainThread]: 
[0m12:28:08.102033 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:28:08.102932 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:28:08.103226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:10.688055 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:28:10.688892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:12.530433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f9603fb-8228-46f3-acf0-733d6682b9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72dfb20>]}
[0m12:28:12.531434 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:28:12.531895 [info ] [MainThread]: 
[0m12:28:12.540641 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:28:12.541236 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:28:12.542459 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:28:12.542809 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:28:12.543117 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:28:12.548627 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:28:12.549038 [debug] [Thread-1 (]: finished collecting timing info
[0m12:28:12.549237 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:28:12.567927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:14.555961 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:28:14.556446 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_EXTRACT(port_at_call,'^.[(?i)anch]*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:28:17.971121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:aaec3fc1-df3e-46a5-b873-dd25a4195630:US&page=queryresults
[0m12:28:17.993990 [debug] [Thread-1 (]: finished collecting timing info
[0m12:28:17.994633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9603fb-8228-46f3-acf0-733d6682b9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a6168c40>]}
[0m12:28:17.995013 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 5.45s]
[0m12:28:17.995457 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:28:17.996925 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:28:17.997482 [info ] [MainThread]: 
[0m12:28:17.997799 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m12:28:17.998133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:17.998311 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:28:18.005656 [info ] [MainThread]: 
[0m12:28:18.005972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:18.006462 [info ] [MainThread]: 
[0m12:28:18.006871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:18.007378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72dfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72f0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a72f0c10>]}
[0m12:28:18.007662 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:29:48.276675 | 23945961-b32c-4380-a17c-69206f4ef6c7 ==============================
[0m12:29:48.276686 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:29:48.277058 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:29:48.277350 [debug] [MainThread]: Tracking: tracking
[0m12:29:48.278907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef7143790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef7143c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef7143bb0>]}
[0m12:29:48.327366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:48.327902 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:29:48.341306 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:29:48.369669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23945961-b32c-4380-a17c-69206f4ef6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef5f68b50>]}
[0m12:29:48.376286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23945961-b32c-4380-a17c-69206f4ef6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef6eb7ee0>]}
[0m12:29:48.376623 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:29:48.376870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23945961-b32c-4380-a17c-69206f4ef6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef6ecd5a0>]}
[0m12:29:48.378094 [info ] [MainThread]: 
[0m12:29:48.378804 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:29:48.379670 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:29:48.379839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:50.734519 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:29:50.735124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:52.080080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23945961-b32c-4380-a17c-69206f4ef6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef7143310>]}
[0m12:29:52.081861 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:29:52.082754 [info ] [MainThread]: 
[0m12:29:52.096776 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:29:52.097699 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:29:52.099494 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:29:52.099962 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:29:52.102250 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:29:52.105936 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:29:52.106290 [debug] [Thread-1 (]: finished collecting timing info
[0m12:29:52.106471 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:29:52.123635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:53.540129 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:29:53.540571 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_EXTRACT(port_at_call,'^.[(?i)anch]+') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:29:56.596076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4132e31d-5efb-4585-8f1c-476015dec190:US&page=queryresults
[0m12:29:56.638153 [debug] [Thread-1 (]: finished collecting timing info
[0m12:29:56.638899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23945961-b32c-4380-a17c-69206f4ef6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef5f68a30>]}
[0m12:29:56.639328 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 4.54s]
[0m12:29:56.639830 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:29:56.641461 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:29:56.641985 [info ] [MainThread]: 
[0m12:29:56.642270 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m12:29:56.642582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:56.642803 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:29:56.650100 [info ] [MainThread]: 
[0m12:29:56.650418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:56.650906 [info ] [MainThread]: 
[0m12:29:56.651310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:29:56.651748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef6ecd540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef6ef14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef71411e0>]}
[0m12:29:56.652006 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:38:05.854136 | b8ad32bc-6c87-472b-9d0e-d875a42c3088 ==============================
[0m12:38:05.854147 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:38:05.854559 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:38:05.854790 [debug] [MainThread]: Tracking: tracking
[0m12:38:05.856099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0513f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0513f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc0513dd80>]}
[0m12:38:05.905107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:05.905499 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:38:05.919206 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:38:05.949214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ad32bc-6c87-472b-9d0e-d875a42c3088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbffd31000>]}
[0m12:38:05.956188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ad32bc-6c87-472b-9d0e-d875a42c3088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04eb73a0>]}
[0m12:38:05.956490 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:38:05.956732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ad32bc-6c87-472b-9d0e-d875a42c3088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04ecda50>]}
[0m12:38:05.957744 [info ] [MainThread]: 
[0m12:38:05.958311 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:38:05.959186 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:38:05.959358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:08.607569 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:38:08.608771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:09.953337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ad32bc-6c87-472b-9d0e-d875a42c3088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04edfbb0>]}
[0m12:38:09.956745 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:38:09.958060 [info ] [MainThread]: 
[0m12:38:09.972613 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:38:09.973829 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:38:09.975857 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:38:09.976371 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:38:09.976826 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:38:09.988576 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:38:09.989573 [debug] [Thread-1 (]: finished collecting timing info
[0m12:38:09.990084 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:38:10.019985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:11.911483 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:38:11.911942 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        REGEXP_EXTRACT(port_at_call,'(?i)anch.*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:38:15.284762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:6a815f7c-6398-4228-9716-455b5c72716d:US&page=queryresults
[0m12:38:15.306020 [debug] [Thread-1 (]: finished collecting timing info
[0m12:38:15.306653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ad32bc-6c87-472b-9d0e-d875a42c3088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbffd30a30>]}
[0m12:38:15.307038 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 5.33s]
[0m12:38:15.307475 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:38:15.309051 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:38:15.309583 [info ] [MainThread]: 
[0m12:38:15.309865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m12:38:15.310123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:15.310259 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:38:15.317590 [info ] [MainThread]: 
[0m12:38:15.317916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:15.318225 [info ] [MainThread]: 
[0m12:38:15.318477 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:15.318825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04edfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04f35390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc04ef02b0>]}
[0m12:38:15.319091 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:39:48.902923 | 7618a142-18a0-4bd0-9d9e-67d5cb11611b ==============================
[0m12:39:48.902933 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:39:48.903299 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:39:48.903490 [debug] [MainThread]: Tracking: tracking
[0m12:39:48.904805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b253f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b253f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b253de70>]}
[0m12:39:48.953483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:48.953843 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:39:48.967128 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:39:48.995970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7618a142-18a0-4bd0-9d9e-67d5cb11611b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b13710f0>]}
[0m12:39:49.002874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7618a142-18a0-4bd0-9d9e-67d5cb11611b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b22b7220>]}
[0m12:39:49.003194 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:39:49.003436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7618a142-18a0-4bd0-9d9e-67d5cb11611b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b22cdb40>]}
[0m12:39:49.004324 [info ] [MainThread]: 
[0m12:39:49.004866 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:39:49.005715 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:39:49.006009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:50.312161 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:39:50.312808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:52.242153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7618a142-18a0-4bd0-9d9e-67d5cb11611b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b22dfc70>]}
[0m12:39:52.244036 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:39:52.244922 [info ] [MainThread]: 
[0m12:39:52.251908 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:39:52.252288 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:39:52.253041 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:39:52.253244 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:39:52.253428 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:39:52.258445 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:39:52.258869 [debug] [Thread-1 (]: finished collecting timing info
[0m12:39:52.259062 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:39:52.276778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:54.161909 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:39:54.162351 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
        regexp_extract(port_at_call,'(?i)anch.*') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:39:57.265348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:68ee3456-f9c9-4c23-b02d-fdc18da65ee6:US&page=queryresults
[0m12:39:57.309195 [debug] [Thread-1 (]: finished collecting timing info
[0m12:39:57.309870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7618a142-18a0-4bd0-9d9e-67d5cb11611b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b1370a00>]}
[0m12:39:57.310259 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 5.06s]
[0m12:39:57.310767 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:39:57.312228 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:39:57.312819 [info ] [MainThread]: 
[0m12:39:57.313138 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m12:39:57.313425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:57.313571 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:39:57.321459 [info ] [MainThread]: 
[0m12:39:57.321797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:57.322098 [info ] [MainThread]: 
[0m12:39:57.322344 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:57.322683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b22dffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b22f0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b22f1870>]}
[0m12:39:57.322966 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:43:26.844779 | 06583473-2d30-4ecd-aeec-6671de312b86 ==============================
[0m12:43:26.844794 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:43:26.845156 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:43:26.845316 [debug] [MainThread]: Tracking: tracking
[0m12:43:26.846640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862dc43610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862dc43700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862dc436a0>]}
[0m12:43:26.894846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:26.895194 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:43:26.908795 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:43:26.936701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06583473-2d30-4ecd-aeec-6671de312b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862c86beb0>]}
[0m12:43:26.943630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06583473-2d30-4ecd-aeec-6671de312b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862d9b7d00>]}
[0m12:43:26.943913 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:43:26.944151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06583473-2d30-4ecd-aeec-6671de312b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862d9cd3c0>]}
[0m12:43:26.945023 [info ] [MainThread]: 
[0m12:43:26.945557 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:43:26.946428 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:43:26.946653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:29.167723 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:43:29.168455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:30.988202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06583473-2d30-4ecd-aeec-6671de312b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862dc40310>]}
[0m12:43:30.988903 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:43:30.989208 [info ] [MainThread]: 
[0m12:43:30.995483 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:43:30.995915 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:43:30.996825 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:43:30.997062 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:43:30.997284 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:43:31.002840 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:43:31.003250 [debug] [Thread-1 (]: finished collecting timing info
[0m12:43:31.003440 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:43:31.021503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:32.326245 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:43:32.326709 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
        mmsi,
        port_at_call,
        port_type,
       regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:43:38.938581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:67692883-a6be-428c-bb86-fba77a4d95be:US&page=queryresults
[0m12:43:38.959635 [debug] [Thread-1 (]: finished collecting timing info
[0m12:43:38.960266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06583473-2d30-4ecd-aeec-6671de312b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862c868ca0>]}
[0m12:43:38.960635 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (23.1k rows, 104.4 MB processed)[0m in 7.96s]
[0m12:43:38.961072 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:43:38.962480 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:43:38.963010 [info ] [MainThread]: 
[0m12:43:38.963299 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.02 seconds (12.02s).
[0m12:43:38.963565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:38.963706 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:43:38.971167 [info ] [MainThread]: 
[0m12:43:38.971490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:38.971805 [info ] [MainThread]: 
[0m12:43:38.972085 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:38.972410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862d9f0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862d9dffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862d9df580>]}
[0m12:43:38.972741 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:45:05.835517 | 6a919e9e-9b1f-4f54-8256-a6ed7f3c2330 ==============================
[0m12:45:05.835528 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:45:05.835887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:45:05.836055 [debug] [MainThread]: Tracking: tracking
[0m12:45:05.837523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7098a3b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7098a3b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7098a39e10>]}
[0m12:45:05.885857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:05.886229 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:45:05.899871 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:45:05.928518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a919e9e-9b1f-4f54-8256-a6ed7f3c2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7098075090>]}
[0m12:45:05.935165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a919e9e-9b1f-4f54-8256-a6ed7f3c2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70987b33a0>]}
[0m12:45:05.935615 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:45:05.935872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a919e9e-9b1f-4f54-8256-a6ed7f3c2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70987c9ae0>]}
[0m12:45:05.936797 [info ] [MainThread]: 
[0m12:45:05.937503 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:45:05.938413 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:45:05.938639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:08.158524 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:45:08.159024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:09.959124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a919e9e-9b1f-4f54-8256-a6ed7f3c2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70987dbeb0>]}
[0m12:45:09.959721 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:45:09.959991 [info ] [MainThread]: 
[0m12:45:09.964708 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:45:09.964996 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:45:09.965602 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:45:09.965752 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:45:09.965889 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:45:09.969895 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:45:09.970248 [debug] [Thread-1 (]: finished collecting timing info
[0m12:45:09.970453 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:45:09.986564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:11.804581 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:45:11.805023 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
       # port_at_call,
        port_type,
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

   # where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:45:14.889498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:d338e9bf-4852-4d70-bbbe-90340be2e1cb:US&page=queryresults
[0m12:45:14.929863 [debug] [Thread-1 (]: finished collecting timing info
[0m12:45:14.930573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a919e9e-9b1f-4f54-8256-a6ed7f3c2330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7098074b80>]}
[0m12:45:14.931003 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (7.0 rows, 25.6 MB processed)[0m in 4.97s]
[0m12:45:14.931531 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:45:14.933072 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:45:14.933662 [info ] [MainThread]: 
[0m12:45:14.933939 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.00 seconds (9.00s).
[0m12:45:14.934196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:14.934333 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:45:14.941552 [info ] [MainThread]: 
[0m12:45:14.941863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:14.942204 [info ] [MainThread]: 
[0m12:45:14.942450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:14.942790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70987dbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70987ece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70987ecca0>]}
[0m12:45:14.943039 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:46:04.096565 | 550da56f-6f3b-4000-bb4b-215c0cf52cf2 ==============================
[0m12:46:04.096576 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:46:04.096966 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:46:04.097173 [debug] [MainThread]: Tracking: tracking
[0m12:46:04.098742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54d3ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54d3bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54d3beb0>]}
[0m12:46:04.147749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:04.148130 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:46:04.161779 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:46:04.191404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550da56f-6f3b-4000-bb4b-215c0cf52cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43928df0>]}
[0m12:46:04.198536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550da56f-6f3b-4000-bb4b-215c0cf52cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54ab33a0>]}
[0m12:46:04.198901 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:46:04.199136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550da56f-6f3b-4000-bb4b-215c0cf52cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54ac9840>]}
[0m12:46:04.200060 [info ] [MainThread]: 
[0m12:46:04.200646 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:46:04.201591 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:46:04.201896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:05.442526 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:46:05.443454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:06.664889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550da56f-6f3b-4000-bb4b-215c0cf52cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54adbd00>]}
[0m12:46:06.666692 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:46:06.667650 [info ] [MainThread]: 
[0m12:46:06.674460 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:46:06.674786 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:46:06.675428 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:46:06.675599 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:46:06.675755 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:46:06.680827 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:46:06.681272 [debug] [Thread-1 (]: finished collecting timing info
[0m12:46:06.681507 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:46:06.705664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:07.973906 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:46:07.974347 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
       # port_at_call,
        port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

   # where port_type = 'Anchorage'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:46:10.864390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:f7d70493-639e-4dff-a0df-f176b3612502:US&page=queryresults
[0m12:46:10.885684 [debug] [Thread-1 (]: finished collecting timing info
[0m12:46:10.886308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550da56f-6f3b-4000-bb4b-215c0cf52cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f43928bb0>]}
[0m12:46:10.886668 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (7.0 rows, 25.6 MB processed)[0m in 4.21s]
[0m12:46:10.887176 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:46:10.888617 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:46:10.889153 [info ] [MainThread]: 
[0m12:46:10.889437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m12:46:10.889738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:10.889912 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:46:10.897297 [info ] [MainThread]: 
[0m12:46:10.897728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:10.898214 [info ] [MainThread]: 
[0m12:46:10.898586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:10.899008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54adbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54aec700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f54aecc70>]}
[0m12:46:10.899270 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:50:13.103985 | 9cc317a3-7425-4c02-a532-052584b3e27e ==============================
[0m12:50:13.103996 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:50:13.104478 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:50:13.104634 [debug] [MainThread]: Tracking: tracking
[0m12:50:13.105958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4663f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4663f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b4663e0e0>]}
[0m12:50:13.155133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:13.155517 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:50:13.169085 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:50:13.198225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cc317a3-7425-4c02-a532-052584b3e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b464224d0>]}
[0m12:50:13.205528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cc317a3-7425-4c02-a532-052584b3e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b49ae4be0>]}
[0m12:50:13.205836 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:50:13.206095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc317a3-7425-4c02-a532-052584b3e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b463cdde0>]}
[0m12:50:13.207128 [info ] [MainThread]: 
[0m12:50:13.207797 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:50:13.208787 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:50:13.209135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:15.378458 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:50:15.379162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:16.628645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc317a3-7425-4c02-a532-052584b3e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b463dff40>]}
[0m12:50:16.630517 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:50:16.631429 [info ] [MainThread]: 
[0m12:50:16.645084 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:50:16.645987 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:50:16.647893 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:50:16.648553 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:50:16.649024 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:50:16.660816 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:50:16.661597 [debug] [Thread-1 (]: finished collecting timing info
[0m12:50:16.661982 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:50:16.683936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:17.954416 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:50:17.955330 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Shelter'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:50:21.059477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:16354c01-ba9f-4af4-9ebb-65c2c9f916a6:US&page=queryresults
[0m12:50:21.081297 [debug] [Thread-1 (]: finished collecting timing info
[0m12:50:21.081935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc317a3-7425-4c02-a532-052584b3e27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b45274d90>]}
[0m12:50:21.082307 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (5.0 rows, 66.8 MB processed)[0m in 4.43s]
[0m12:50:21.082755 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:50:21.084163 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:50:21.084703 [info ] [MainThread]: 
[0m12:50:21.084986 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m12:50:21.085289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:21.085463 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:50:21.092826 [info ] [MainThread]: 
[0m12:50:21.093141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:21.093620 [info ] [MainThread]: 
[0m12:50:21.094022 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:21.094434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b463b72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b463cdd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b453098d0>]}
[0m12:50:21.094691 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:51:16.678452 | d1885ebc-d2cd-4a1c-9f0f-eb1121c10395 ==============================
[0m12:51:16.678462 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:51:16.678903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:51:16.679058 [debug] [MainThread]: Tracking: tracking
[0m12:51:16.680354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aef43880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aef43d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aef43ca0>]}
[0m12:51:16.730621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:51:16.731040 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:51:16.744380 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:51:16.772954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1885ebc-d2cd-4a1c-9f0f-eb1121c10395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53add68be0>]}
[0m12:51:16.779707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1885ebc-d2cd-4a1c-9f0f-eb1121c10395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aecb7f70>]}
[0m12:51:16.780001 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:51:16.780237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1885ebc-d2cd-4a1c-9f0f-eb1121c10395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aeccd630>]}
[0m12:51:16.781298 [info ] [MainThread]: 
[0m12:51:16.781871 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:51:16.782815 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:51:16.783117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:18.458247 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:51:18.458915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:19.694505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1885ebc-d2cd-4a1c-9f0f-eb1121c10395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aef41210>]}
[0m12:51:19.696379 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:51:19.697239 [info ] [MainThread]: 
[0m12:51:19.711165 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:51:19.712117 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:51:19.713960 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:51:19.714419 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:51:19.714891 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:51:19.726009 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:51:19.726967 [debug] [Thread-1 (]: finished collecting timing info
[0m12:51:19.727469 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:51:19.751773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:21.008005 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:51:21.008428 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Marina'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:51:23.836989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:d4256ef6-5c1d-4191-818f-e398e34e30eb:US&page=queryresults
[0m12:51:23.858723 [debug] [Thread-1 (]: finished collecting timing info
[0m12:51:23.859359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1885ebc-d2cd-4a1c-9f0f-eb1121c10395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53add688b0>]}
[0m12:51:23.859728 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (45.0 rows, 66.8 MB processed)[0m in 4.15s]
[0m12:51:23.860199 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:51:23.861691 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:51:23.862217 [info ] [MainThread]: 
[0m12:51:23.862498 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m12:51:23.862779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:23.862925 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:51:23.870389 [info ] [MainThread]: 
[0m12:51:23.870721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:23.871051 [info ] [MainThread]: 
[0m12:51:23.871301 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:23.871635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aecb7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53aecf0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ade0d2a0>]}
[0m12:51:23.871888 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:52:14.683634 | fd6a12b4-eb2a-427c-869a-575327de1f90 ==============================
[0m12:52:14.683644 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:52:14.684031 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:52:14.684201 [debug] [MainThread]: Tracking: tracking
[0m12:52:14.685538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1d2b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1d2b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1d2b7c0>]}
[0m12:52:14.734676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:14.735120 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:52:14.748656 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:52:14.778160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd6a12b4-eb2a-427c-869a-575327de1f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde0b58ac0>]}
[0m12:52:14.785325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd6a12b4-eb2a-427c-869a-575327de1f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1a9fe50>]}
[0m12:52:14.785642 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:52:14.785884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6a12b4-eb2a-427c-869a-575327de1f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1ab5510>]}
[0m12:52:14.786850 [info ] [MainThread]: 
[0m12:52:14.787538 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:52:14.788482 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:52:14.788781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:15.998822 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:52:15.999160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:17.230116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6a12b4-eb2a-427c-869a-575327de1f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1d284c0>]}
[0m12:52:17.231990 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:52:17.232774 [info ] [MainThread]: 
[0m12:52:17.245951 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:52:17.246973 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:52:17.248945 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:52:17.249469 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:52:17.249885 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:52:17.261168 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:52:17.262137 [debug] [Thread-1 (]: finished collecting timing info
[0m12:52:17.262675 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:52:17.284353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:18.626343 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:52:18.626816 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Canal'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:52:21.395417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:3b9fbc58-fc9b-4c69-b8f4-2bbc30a6a8cb:US&page=queryresults
[0m12:52:21.417904 [debug] [Thread-1 (]: finished collecting timing info
[0m12:52:21.418545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6a12b4-eb2a-427c-869a-575327de1f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde0b58970>]}
[0m12:52:21.418924 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (5.0 rows, 66.8 MB processed)[0m in 4.17s]
[0m12:52:21.419382 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:52:21.420801 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:52:21.421342 [info ] [MainThread]: 
[0m12:52:21.421633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.63 seconds (6.63s).
[0m12:52:21.421899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:21.422042 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:52:21.429543 [info ] [MainThread]: 
[0m12:52:21.429866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:21.430174 [info ] [MainThread]: 
[0m12:52:21.430455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:21.430803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1ad8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1d28160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde1ac77c0>]}
[0m12:52:21.431056 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:53:02.082330 | 0ef510ea-a282-448b-87a6-d15e7857a455 ==============================
[0m12:53:02.082342 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:53:02.082734 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:53:02.082902 [debug] [MainThread]: Tracking: tracking
[0m12:53:02.084238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc943670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc943760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc943700>]}
[0m12:53:02.134260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:02.134679 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:53:02.149354 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:53:02.179734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ef510ea-a282-448b-87a6-d15e7857a455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac77249d0>]}
[0m12:53:02.186763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ef510ea-a282-448b-87a6-d15e7857a455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc6b7d60>]}
[0m12:53:02.187072 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:53:02.187364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ef510ea-a282-448b-87a6-d15e7857a455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc6cd420>]}
[0m12:53:02.188340 [info ] [MainThread]: 
[0m12:53:02.188899 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:53:02.189804 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:53:02.190108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:03.878534 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:53:03.879309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:05.144631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ef510ea-a282-448b-87a6-d15e7857a455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc942530>]}
[0m12:53:05.146426 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:53:05.147313 [info ] [MainThread]: 
[0m12:53:05.154358 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:53:05.154726 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:53:05.155471 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:53:05.155673 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:53:05.155854 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:53:05.160837 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:53:05.161276 [debug] [Thread-1 (]: finished collecting timing info
[0m12:53:05.161498 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:53:05.181108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:06.507721 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:53:06.508176 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Offshore Terminal'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:53:09.469697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:0e65472b-8fc8-4ec2-9017-bf31bad9b190:US&page=queryresults
[0m12:53:09.491327 [debug] [Thread-1 (]: finished collecting timing info
[0m12:53:09.491955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ef510ea-a282-448b-87a6-d15e7857a455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac7726020>]}
[0m12:53:09.492351 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (40.0 rows, 66.8 MB processed)[0m in 4.34s]
[0m12:53:09.492790 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:53:09.494211 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:53:09.494741 [info ] [MainThread]: 
[0m12:53:09.495027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.31 seconds (7.31s).
[0m12:53:09.495281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:09.495418 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:53:09.502736 [info ] [MainThread]: 
[0m12:53:09.503049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:09.503365 [info ] [MainThread]: 
[0m12:53:09.503612 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:53:09.503984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc6f00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc6df670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc6df5e0>]}
[0m12:53:09.504234 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:55:16.082876 | b255b1de-bd1e-45d0-95eb-81f4fda4d1bc ==============================
[0m12:55:16.082888 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:55:16.083263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:55:16.083436 [debug] [MainThread]: Tracking: tracking
[0m12:55:16.084816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb363bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb363b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb363bfa0>]}
[0m12:55:16.134053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:55:16.134435 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:55:16.148113 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:55:16.176895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b255b1de-bd1e-45d0-95eb-81f4fda4d1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb2464eb0>]}
[0m12:55:16.183934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b255b1de-bd1e-45d0-95eb-81f4fda4d1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33b33a0>]}
[0m12:55:16.184216 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:55:16.184451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b255b1de-bd1e-45d0-95eb-81f4fda4d1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33c9900>]}
[0m12:55:16.185368 [info ] [MainThread]: 
[0m12:55:16.185946 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:55:16.186918 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:55:16.187088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:18.229983 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:55:18.230794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:19.487496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b255b1de-bd1e-45d0-95eb-81f4fda4d1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33db9a0>]}
[0m12:55:19.489355 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:55:19.490236 [info ] [MainThread]: 
[0m12:55:19.497236 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:55:19.497608 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:55:19.498272 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:55:19.498448 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:55:19.498605 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:55:19.503037 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:55:19.503483 [debug] [Thread-1 (]: finished collecting timing info
[0m12:55:19.503680 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:55:19.521231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:20.766491 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:55:20.766952 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Demolition Yard'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:55:23.549074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:f1e99f67-503a-4102-bece-ce150d320c02:US&page=queryresults
[0m12:55:23.591716 [debug] [Thread-1 (]: finished collecting timing info
[0m12:55:23.592579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b255b1de-bd1e-45d0-95eb-81f4fda4d1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb2464a60>]}
[0m12:55:23.593012 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (2.0 rows, 66.8 MB processed)[0m in 4.09s]
[0m12:55:23.593550 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:55:23.595157 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:55:23.595692 [info ] [MainThread]: 
[0m12:55:23.595973 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m12:55:23.596230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:23.596367 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:55:23.603644 [info ] [MainThread]: 
[0m12:55:23.603950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:23.604244 [info ] [MainThread]: 
[0m12:55:23.604476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:55:23.604789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33dbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33ece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb33ecc10>]}
[0m12:55:23.605033 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:56:19.598653 | 6db08c0c-375e-4815-8fa9-6498a5d2f607 ==============================
[0m12:56:19.598666 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:56:19.599062 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:56:19.599226 [debug] [MainThread]: Tracking: tracking
[0m12:56:19.600505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15053fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15053feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15053fe50>]}
[0m12:56:19.648583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:19.649024 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:56:19.662324 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:56:19.692260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6db08c0c-375e-4815-8fa9-6498a5d2f607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14f370d30>]}
[0m12:56:19.699314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6db08c0c-375e-4815-8fa9-6498a5d2f607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1502b73a0>]}
[0m12:56:19.699609 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:56:19.699852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db08c0c-375e-4815-8fa9-6498a5d2f607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1502cd780>]}
[0m12:56:19.700765 [info ] [MainThread]: 
[0m12:56:19.701361 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:56:19.702245 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:56:19.702540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:21.368714 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:56:21.369349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:22.598004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db08c0c-375e-4815-8fa9-6498a5d2f607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1502dfb80>]}
[0m12:56:22.599982 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:56:22.600854 [info ] [MainThread]: 
[0m12:56:22.616070 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:56:22.616955 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:56:22.618880 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:56:22.619407 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:56:22.619870 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:56:22.624854 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:56:22.625211 [debug] [Thread-1 (]: finished collecting timing info
[0m12:56:22.625414 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:56:22.642824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:23.945284 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:56:23.945742 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Port'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:56:26.811408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:b3e5e2cf-6304-4d9c-b4c9-553f751ccf6e:US&page=queryresults
[0m12:56:26.833662 [debug] [Thread-1 (]: finished collecting timing info
[0m12:56:26.834283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db08c0c-375e-4815-8fa9-6498a5d2f607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd14f3707f0>]}
[0m12:56:26.834653 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.4k rows, 66.8 MB processed)[0m in 4.22s]
[0m12:56:26.835098 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:56:26.836567 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:56:26.837083 [info ] [MainThread]: 
[0m12:56:26.837419 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m12:56:26.837710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:26.837878 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:56:26.845120 [info ] [MainThread]: 
[0m12:56:26.845459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:26.845769 [info ] [MainThread]: 
[0m12:56:26.846014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:56:26.846338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1502b7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1502dfc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1502f0790>]}
[0m12:56:26.846586 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 12:57:53.893434 | e7547990-90f0-48d2-81f8-09741cca3dc3 ==============================
[0m12:57:53.893445 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:57:53.893806 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:53.893946 [debug] [MainThread]: Tracking: tracking
[0m12:57:53.895307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356f276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356f27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356f25ff0>]}
[0m12:57:53.944571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:53.944957 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m12:57:53.959674 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m12:57:53.992206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7547990-90f0-48d2-81f8-09741cca3dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356d0a3b0>]}
[0m12:57:54.000437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7547990-90f0-48d2-81f8-09741cca3dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235a5ccaf0>]}
[0m12:57:54.000764 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:57:54.001057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7547990-90f0-48d2-81f8-09741cca3dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356cb5cc0>]}
[0m12:57:54.002088 [info ] [MainThread]: 
[0m12:57:54.002754 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:57:54.003759 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m12:57:54.004091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:56.230716 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m12:57:56.231082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:57.542544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7547990-90f0-48d2-81f8-09741cca3dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356cc7dc0>]}
[0m12:57:57.544472 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m12:57:57.545331 [info ] [MainThread]: 
[0m12:57:57.559165 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:57:57.560069 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m12:57:57.561906 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:57:57.562403 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:57:57.562904 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:57:57.575298 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:57:57.576240 [debug] [Thread-1 (]: finished collecting timing info
[0m12:57:57.576748 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:57:57.608772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:59.432945 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m12:57:59.433399 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       #regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'') as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Offshore Terminal'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m12:58:02.136843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:06871917-e96c-44a0-a341-a5792c8a1502:US&page=queryresults
[0m12:58:02.158150 [debug] [Thread-1 (]: finished collecting timing info
[0m12:58:02.158797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7547990-90f0-48d2-81f8-09741cca3dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2355b5cd30>]}
[0m12:58:02.159166 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (40.0 rows, 66.8 MB processed)[0m in 4.60s]
[0m12:58:02.159596 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m12:58:02.161061 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:58:02.161578 [info ] [MainThread]: 
[0m12:58:02.161854 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m12:58:02.162150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:02.162320 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m12:58:02.170711 [info ] [MainThread]: 
[0m12:58:02.171226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:02.171589 [info ] [MainThread]: 
[0m12:58:02.171873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:58:02.172247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356d0a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356cc7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356d1c880>]}
[0m12:58:02.172501 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:10:12.694077 | d0e9f751-b619-4978-b7e0-b62a24ce4464 ==============================
[0m13:10:12.694088 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:10:12.694477 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:10:12.694637 [debug] [MainThread]: Tracking: tracking
[0m13:10:12.696021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a9276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a927220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a925e10>]}
[0m13:10:12.744435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:12.744794 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:10:12.758433 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:10:12.786211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0e9f751-b619-4978-b7e0-b62a24ce4464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c89759090>]}
[0m13:10:12.793020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0e9f751-b619-4978-b7e0-b62a24ce4464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a69f3a0>]}
[0m13:10:12.793330 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:10:12.793564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0e9f751-b619-4978-b7e0-b62a24ce4464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a6b5ae0>]}
[0m13:10:12.794464 [info ] [MainThread]: 
[0m13:10:12.795088 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:10:12.796031 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:10:12.796201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:15.082695 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:10:15.083359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:16.637963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0e9f751-b619-4978-b7e0-b62a24ce4464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a6c7eb0>]}
[0m13:10:16.639837 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:10:16.640703 [info ] [MainThread]: 
[0m13:10:16.654064 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:10:16.655071 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:10:16.657300 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:10:16.657983 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:10:16.658540 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:10:16.671408 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:10:16.672813 [debug] [Thread-1 (]: finished collecting timing info
[0m13:10:16.673463 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:10:16.703556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:18.322152 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:10:18.322618 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       case when port_type = 'Achorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)marin.*'),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as test
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Offshore Terminal'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:10:21.316760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:0ec936a8-b1d8-43c8-8d21-fa2f8fa238b2:US&page=queryresults
[0m13:10:21.337967 [debug] [Thread-1 (]: finished collecting timing info
[0m13:10:21.338598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e9f751-b619-4978-b7e0-b62a24ce4464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c89758a90>]}
[0m13:10:21.338979 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (40.0 rows, 66.8 MB processed)[0m in 4.68s]
[0m13:10:21.339409 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:10:21.340874 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:10:21.341386 [info ] [MainThread]: 
[0m13:10:21.341658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m13:10:21.341903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:21.342036 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:10:21.349310 [info ] [MainThread]: 
[0m13:10:21.349626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:21.349924 [info ] [MainThread]: 
[0m13:10:21.350167 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:10:21.350488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a6c7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a720520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8a6d8460>]}
[0m13:10:21.350748 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:11:04.292090 | c0109186-2adf-48ab-af90-a135b6edefdd ==============================
[0m13:11:04.292100 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:11:04.292470 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:11:04.292626 [debug] [MainThread]: Tracking: tracking
[0m13:11:04.293937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943583ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943583bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943583beb0>]}
[0m13:11:04.342490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:04.342918 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:11:04.356283 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:11:04.385682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0109186-2adf-48ab-af90-a135b6edefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9434468dc0>]}
[0m13:11:04.392826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0109186-2adf-48ab-af90-a135b6edefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94355b33a0>]}
[0m13:11:04.393146 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:11:04.393378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0109186-2adf-48ab-af90-a135b6edefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94355c9810>]}
[0m13:11:04.394259 [info ] [MainThread]: 
[0m13:11:04.394875 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:11:04.395749 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:11:04.396045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:06.231530 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:11:06.232440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:07.776021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0109186-2adf-48ab-af90-a135b6edefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94355dbbe0>]}
[0m13:11:07.777839 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:11:07.778779 [info ] [MainThread]: 
[0m13:11:07.792509 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:11:07.793428 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:11:07.795334 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:11:07.795845 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:11:07.796303 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:11:07.808465 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:11:07.809224 [debug] [Thread-1 (]: finished collecting timing info
[0m13:11:07.809622 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:11:07.831963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:09.126626 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:11:09.127070 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       case when port_type = 'Achorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)marin.*'),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

    where port_type = 'Offshore Terminal'
 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:11:12.390925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:47539f6e-89c8-43a6-aa2f-60c835af0852:US&page=queryresults
[0m13:11:12.434648 [debug] [Thread-1 (]: finished collecting timing info
[0m13:11:12.435310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0109186-2adf-48ab-af90-a135b6edefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9434468a90>]}
[0m13:11:12.435677 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (40.0 rows, 66.8 MB processed)[0m in 4.64s]
[0m13:11:12.436147 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:11:12.437666 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:11:12.438214 [info ] [MainThread]: 
[0m13:11:12.438493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m13:11:12.438771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:12.438910 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:11:12.445998 [info ] [MainThread]: 
[0m13:11:12.446315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:12.446615 [info ] [MainThread]: 
[0m13:11:12.446868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:12.447185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94355dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943583add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94345052a0>]}
[0m13:11:12.447482 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:12:02.408481 | ed63aaf3-dc19-4498-9beb-96b45428950f ==============================
[0m13:12:02.408491 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:12:02.408850 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:12:02.409008 [debug] [MainThread]: Tracking: tracking
[0m13:12:02.410317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bd438b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bd43d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bd43cd0>]}
[0m13:12:02.458622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:02.459056 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:12:02.472258 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:12:02.500270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed63aaf3-dc19-4498-9beb-96b45428950f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465ab70be0>]}
[0m13:12:02.506921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed63aaf3-dc19-4498-9beb-96b45428950f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bab7f70>]}
[0m13:12:02.507310 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:12:02.507697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed63aaf3-dc19-4498-9beb-96b45428950f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bacd630>]}
[0m13:12:02.508672 [info ] [MainThread]: 
[0m13:12:02.509302 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:12:02.510172 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:12:02.510460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:04.376964 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:12:04.377803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:06.508572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed63aaf3-dc19-4498-9beb-96b45428950f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bd403a0>]}
[0m13:12:06.510492 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:12:06.511423 [info ] [MainThread]: 
[0m13:12:06.524958 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:12:06.525861 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:12:06.527769 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:12:06.528287 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:12:06.528751 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:12:06.534155 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:12:06.534539 [debug] [Thread-1 (]: finished collecting timing info
[0m13:12:06.534736 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:12:06.552117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:08.772457 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:12:08.772920 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
       # port_type
       case when port_type = 'Achorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)marin.*'),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:12:12.125740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:09c414d5-466a-4f91-8de2-299248c6b33b:US&page=queryresults
[0m13:12:12.171040 [debug] [Thread-1 (]: finished collecting timing info
[0m13:12:12.171859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed63aaf3-dc19-4498-9beb-96b45428950f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465ab709a0>]}
[0m13:12:12.172283 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (2.3k rows, 66.8 MB processed)[0m in 5.65s]
[0m13:12:12.172750 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:12:12.174210 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:12:12.174783 [info ] [MainThread]: 
[0m13:12:12.175095 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.67 seconds (9.67s).
[0m13:12:12.175448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:12.175659 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:12:12.184477 [info ] [MainThread]: 
[0m13:12:12.184828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:12.185136 [info ] [MainThread]: 
[0m13:12:12.185386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:12:12.185715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465baf0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465bd42ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f465ac0d1b0>]}
[0m13:12:12.185963 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:13:03.586764 | 96e69091-492c-483a-9e1e-aecb164b47c3 ==============================
[0m13:13:03.586789 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:13:03.587184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:13:03.587428 [debug] [MainThread]: Tracking: tracking
[0m13:13:03.588887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173513f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173513f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173513e0e0>]}
[0m13:13:03.638079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:03.638454 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:13:03.651918 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:13:03.680249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e69091-492c-483a-9e1e-aecb164b47c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1734f224d0>]}
[0m13:13:03.686804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e69091-492c-483a-9e1e-aecb164b47c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17385f2140>]}
[0m13:13:03.687113 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:13:03.687465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e69091-492c-483a-9e1e-aecb164b47c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1734ecdde0>]}
[0m13:13:03.688482 [info ] [MainThread]: 
[0m13:13:03.689064 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:13:03.689921 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:13:03.690089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:05.218977 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:13:05.219518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:06.747084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e69091-492c-483a-9e1e-aecb164b47c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1734edbf70>]}
[0m13:13:06.749064 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:13:06.749950 [info ] [MainThread]: 
[0m13:13:06.756780 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:06.757129 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:13:06.757918 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:13:06.758119 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:06.759165 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:06.763220 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:13:06.763625 [debug] [Thread-1 (]: finished collecting timing info
[0m13:13:06.763818 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:06.781812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:09.044324 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:13:09.044773 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
         port_type
       case when port_type = 'Achorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)marin.*'),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port,

    from source_vessel_tracking_events

 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:13:09.547766 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword CASE at [22:8]')
[0m13:13:10.157129 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:b9357987-8b1e-4740-99e5-d4fe8e66a39d&page=queryresults
[0m13:13:10.158643 [debug] [Thread-1 (]: finished collecting timing info
[0m13:13:10.160198 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got keyword CASE at [22:8]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m13:13:10.160942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e69091-492c-483a-9e1e-aecb164b47c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172ffd5ed0>]}
[0m13:13:10.161921 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.40s]
[0m13:13:10.163121 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:10.166649 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:13:10.168478 [info ] [MainThread]: 
[0m13:13:10.169338 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m13:13:10.170117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:10.170757 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:13:10.191745 [info ] [MainThread]: 
[0m13:13:10.192284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:13:10.192719 [info ] [MainThread]: 
[0m13:13:10.193092 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m13:13:10.193457 [error] [MainThread]:   Syntax error: Expected ")" but got keyword CASE at [22:8]
[0m13:13:10.193803 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m13:13:10.194155 [info ] [MainThread]: 
[0m13:13:10.194504 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:13:10.194992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1734eb72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1734ecdd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1734ef0100>]}
[0m13:13:10.195361 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:13:33.532227 | a780f77e-a50b-40c8-afb1-1361365b0250 ==============================
[0m13:13:33.532238 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:13:33.532575 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:13:33.532721 [debug] [MainThread]: Tracking: tracking
[0m13:13:33.534072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0761c3f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0761c3fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0761c3fb80>]}
[0m13:13:33.581602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:33.581964 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:13:33.595785 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:13:33.624764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a780f77e-a50b-40c8-afb1-1361365b0250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0760868b20>]}
[0m13:13:33.631770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a780f77e-a50b-40c8-afb1-1361365b0250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07619b3eb0>]}
[0m13:13:33.632064 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:13:33.632314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a780f77e-a50b-40c8-afb1-1361365b0250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07619c9570>]}
[0m13:13:33.633286 [info ] [MainThread]: 
[0m13:13:33.633871 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:13:33.634760 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:13:33.635055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:35.451491 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:13:35.452386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:36.829961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a780f77e-a50b-40c8-afb1-1361365b0250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0761c3ee30>]}
[0m13:13:36.832069 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:13:36.832945 [info ] [MainThread]: 
[0m13:13:36.846805 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:36.847740 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:13:36.849783 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:13:36.850286 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:36.850787 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:36.862874 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:13:36.863619 [debug] [Thread-1 (]: finished collecting timing info
[0m13:13:36.863990 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:36.885884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:38.333095 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:13:38.333536 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Achorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)marin.*'),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events

 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:13:41.658994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:399cc9bf-8d2f-4778-819a-86e740289ab5:US&page=queryresults
[0m13:13:41.701269 [debug] [Thread-1 (]: finished collecting timing info
[0m13:13:41.701928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a780f77e-a50b-40c8-afb1-1361365b0250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0760868970>]}
[0m13:13:41.702316 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (2.3k rows, 66.8 MB processed)[0m in 4.85s]
[0m13:13:41.702816 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:13:41.704241 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:13:41.704787 [info ] [MainThread]: 
[0m13:13:41.705075 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m13:13:41.705337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:41.705475 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:13:41.712805 [info ] [MainThread]: 
[0m13:13:41.713109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:41.713396 [info ] [MainThread]: 
[0m13:13:41.713629 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:13:41.714055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07619ec0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07619dbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07619db880>]}
[0m13:13:41.714309 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:14:56.884662 | 7b4579d0-507b-402e-8239-368533a05f33 ==============================
[0m13:14:56.884672 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:14:56.885042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:14:56.885203 [debug] [MainThread]: Tracking: tracking
[0m13:14:56.886581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad63f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad63fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad63fdf0>]}
[0m13:14:56.934262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:56.934620 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:14:56.948320 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:14:56.976787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b4579d0-507b-402e-8239-368533a05f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbac468cd0>]}
[0m13:14:56.983973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b4579d0-507b-402e-8239-368533a05f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad3b33a0>]}
[0m13:14:56.984287 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:14:56.984518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b4579d0-507b-402e-8239-368533a05f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad3c9720>]}
[0m13:14:56.985445 [info ] [MainThread]: 
[0m13:14:56.986021 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:14:56.986918 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:14:56.987088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:58.775919 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:14:58.776788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:01.025174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b4579d0-507b-402e-8239-368533a05f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad3dbb80>]}
[0m13:15:01.025880 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:15:01.026190 [info ] [MainThread]: 
[0m13:15:01.031899 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:15:01.032268 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:15:01.032993 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:15:01.033186 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:15:01.033359 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:15:01.038347 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:15:01.038730 [debug] [Thread-1 (]: finished collecting timing info
[0m13:15:01.038943 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:15:01.056128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:03.317988 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:15:03.318433 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)marin.*'),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events

 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:15:09.353453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:36c85c69-2950-45cb-b134-9df161efa021:US&page=queryresults
[0m13:15:09.374579 [debug] [Thread-1 (]: finished collecting timing info
[0m13:15:09.375220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b4579d0-507b-402e-8239-368533a05f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbac468970>]}
[0m13:15:09.375581 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (2.3k rows, 66.8 MB processed)[0m in 8.34s]
[0m13:15:09.376048 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:15:09.377522 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:15:09.378058 [info ] [MainThread]: 
[0m13:15:09.378340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m13:15:09.378594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:09.378744 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:15:09.386139 [info ] [MainThread]: 
[0m13:15:09.386453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:09.386791 [info ] [MainThread]: 
[0m13:15:09.387042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:15:09.387362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad3b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad3edb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad63d2a0>]}
[0m13:15:09.387614 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:36:11.829214 | 80e97b77-3665-4a7f-912a-58a3afb1ad24 ==============================
[0m13:36:11.829225 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:36:11.829833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:36:11.830067 [debug] [MainThread]: Tracking: tracking
[0m13:36:11.831952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc863bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc863b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc863b730>]}
[0m13:36:11.893414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:11.893834 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:36:11.908263 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:36:11.937644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e97b77-3665-4a7f-912a-58a3afb1ad24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc7470f10>]}
[0m13:36:11.944409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e97b77-3665-4a7f-912a-58a3afb1ad24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc83b33a0>]}
[0m13:36:11.944703 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:36:11.944978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e97b77-3665-4a7f-912a-58a3afb1ad24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc83c9960>]}
[0m13:36:11.945927 [info ] [MainThread]: 
[0m13:36:11.946514 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:36:11.947425 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:36:11.947737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:14.604746 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:36:14.605625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:16.024730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e97b77-3665-4a7f-912a-58a3afb1ad24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc83dbbb0>]}
[0m13:36:16.026567 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:36:16.027477 [info ] [MainThread]: 
[0m13:36:16.042593 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:36:16.043510 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:36:16.045380 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:36:16.045895 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:36:16.046369 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:36:16.058855 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:36:16.059900 [debug] [Thread-1 (]: finished collecting timing info
[0m13:36:16.060451 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:36:16.083766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:17.462509 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:36:17.462971 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)anch.*'),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)canal.*'),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, regexp_extract(port_at_call,'(?i)terminal.*'),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events

 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:36:23.329636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:e87aed5f-9255-4c4e-9882-a2a385f3394f:US&page=queryresults
[0m13:36:23.351880 [debug] [Thread-1 (]: finished collecting timing info
[0m13:36:23.352524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e97b77-3665-4a7f-912a-58a3afb1ad24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc7470b50>]}
[0m13:36:23.352894 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (2.3k rows, 66.8 MB processed)[0m in 7.31s]
[0m13:36:23.353330 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:36:23.354798 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:36:23.355321 [info ] [MainThread]: 
[0m13:36:23.355603 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m13:36:23.355857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:23.355994 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:36:23.363373 [info ] [MainThread]: 
[0m13:36:23.363696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:23.364191 [info ] [MainThread]: 
[0m13:36:23.364566 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:36:23.364974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc83dbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc842d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc83ec340>]}
[0m13:36:23.365236 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:38:33.418238 | 1886d56d-aa25-4dad-8b03-eb60f1c00e0e ==============================
[0m13:38:33.418249 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:38:33.418606 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:38:33.418814 [debug] [MainThread]: Tracking: tracking
[0m13:38:33.420121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd82b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd82be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd82bdc0>]}
[0m13:38:33.467372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:33.467800 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:38:33.481574 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:38:33.510817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1886d56d-aa25-4dad-8b03-eb60f1c00e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc65cca0>]}
[0m13:38:33.517940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1886d56d-aa25-4dad-8b03-eb60f1c00e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd59f4f0>]}
[0m13:38:33.518221 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:38:33.518460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1886d56d-aa25-4dad-8b03-eb60f1c00e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd5b56f0>]}
[0m13:38:33.519443 [info ] [MainThread]: 
[0m13:38:33.520005 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:38:33.520899 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:38:33.521196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:35.881050 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:38:35.881693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:37.745079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1886d56d-aa25-4dad-8b03-eb60f1c00e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd5c7be0>]}
[0m13:38:37.746917 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:38:37.747792 [info ] [MainThread]: 
[0m13:38:37.761343 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:38:37.762224 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:38:37.764180 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:38:37.764688 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:38:37.765145 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:38:37.777258 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:38:37.778029 [debug] [Thread-1 (]: finished collecting timing info
[0m13:38:37.778454 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:38:37.800500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:39.222057 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:38:39.222479 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_interaction as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events

 /*
    union all

    select distinct
        mmsi,
        case when destination_port is null then concat(voyage_origin_port,'-',origin_port_country)
             when voyage_origin_port is null then concat(destination_port,'-',destination_port_country)
            else 'other' end as port
    from source_vessel_tracking_events */
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m13:38:44.940526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:46cdcc06-e726-45ae-ad3a-c1fa731e4e9a:US&page=queryresults
[0m13:38:44.984004 [debug] [Thread-1 (]: finished collecting timing info
[0m13:38:44.984740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1886d56d-aa25-4dad-8b03-eb60f1c00e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc65ca00>]}
[0m13:38:44.985185 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (2.3k rows, 66.8 MB processed)[0m in 7.22s]
[0m13:38:44.985690 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:38:44.987104 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:38:44.987687 [info ] [MainThread]: 
[0m13:38:44.987991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m13:38:44.988252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:44.988390 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:38:44.995566 [info ] [MainThread]: 
[0m13:38:44.995870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:44.996162 [info ] [MainThread]: 
[0m13:38:44.996404 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:38:44.996724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd59f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd5c7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dd5c7a00>]}
[0m13:38:44.996965 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:49:21.418939 | 6551618c-017f-4f78-8154-0d2122afbda4 ==============================
[0m13:49:21.418949 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:49:21.419332 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:49:21.419523 [debug] [MainThread]: Tracking: tracking
[0m13:49:21.420805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8aff3bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8aff3b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8aff3b730>]}
[0m13:49:21.469887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:21.470270 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:49:21.484221 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:49:21.512995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6551618c-017f-4f78-8154-0d2122afbda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8aeb68fd0>]}
[0m13:49:21.520134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6551618c-017f-4f78-8154-0d2122afbda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8afcb33a0>]}
[0m13:49:21.520415 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:49:21.520650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6551618c-017f-4f78-8154-0d2122afbda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8afcc9a20>]}
[0m13:49:21.521571 [info ] [MainThread]: 
[0m13:49:21.522131 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:49:21.522982 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:49:21.523279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:23.631913 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:49:23.632814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:25.063248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6551618c-017f-4f78-8154-0d2122afbda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8afcdbbe0>]}
[0m13:49:25.065045 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:49:25.065915 [info ] [MainThread]: 
[0m13:49:25.073078 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:49:25.073397 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:49:25.074079 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:49:25.074271 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:49:25.074447 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:49:25.079361 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:49:25.079735 [debug] [Thread-1 (]: finished collecting timing info
[0m13:49:25.079919 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:49:25.097488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:26.523483 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:49:26.523941 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        coalesce(detination_port, voyage_origin_port) as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m13:49:28.058796 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: detination_port; Did you mean destination_port? at [36:18]')
[0m13:49:29.639320 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:d05ae6e4-1969-45aa-90f0-e1bfde7c5da5&page=queryresults
[0m13:49:29.640617 [debug] [Thread-1 (]: finished collecting timing info
[0m13:49:29.642159 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: detination_port; Did you mean destination_port? at [36:18]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m13:49:29.642975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6551618c-017f-4f78-8154-0d2122afbda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8aec17970>]}
[0m13:49:29.643998 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 4.57s]
[0m13:49:29.645215 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:49:29.648819 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:49:29.650326 [info ] [MainThread]: 
[0m13:49:29.651212 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m13:49:29.651975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:29.652383 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:49:29.673266 [info ] [MainThread]: 
[0m13:49:29.673914 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:29.674366 [info ] [MainThread]: 
[0m13:49:29.674759 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m13:49:29.675137 [error] [MainThread]:   Unrecognized name: detination_port; Did you mean destination_port? at [36:18]
[0m13:49:29.675491 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m13:49:29.675853 [info ] [MainThread]: 
[0m13:49:29.676218 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:49:29.676716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8afcdbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8afd2d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8afcec100>]}
[0m13:49:29.677103 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:50:59.123238 | 62cbf716-25a4-487f-a665-f86d98122dbe ==============================
[0m13:50:59.123249 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:50:59.123642 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:50:59.123799 [debug] [MainThread]: Tracking: tracking
[0m13:50:59.125106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a53f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a53f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a53de70>]}
[0m13:50:59.172921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:59.173378 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:50:59.186450 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:50:59.214371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62cbf716-25a4-487f-a665-f86d98122dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838936d0f0>]}
[0m13:50:59.221312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62cbf716-25a4-487f-a665-f86d98122dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a2b7220>]}
[0m13:50:59.221660 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:50:59.221938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cbf716-25a4-487f-a665-f86d98122dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a2cdb40>]}
[0m13:50:59.222913 [info ] [MainThread]: 
[0m13:50:59.223523 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:50:59.224384 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:50:59.224710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:00.990630 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:51:00.991582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:02.481841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cbf716-25a4-487f-a665-f86d98122dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a2dfc70>]}
[0m13:51:02.483841 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:51:02.484721 [info ] [MainThread]: 
[0m13:51:02.491841 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:51:02.492177 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:51:02.492817 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:51:02.493005 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:51:02.493160 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:51:02.497964 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:51:02.498368 [debug] [Thread-1 (]: finished collecting timing info
[0m13:51:02.498551 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:51:02.517223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:04.473858 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:51:04.474309 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        coalesce(destination_port, voyage_origin_port) as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m13:51:07.888402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:fecb1da5-b72e-42dd-aced-c3717a2e1ba2:US&page=queryresults
[0m13:51:07.930224 [debug] [Thread-1 (]: finished collecting timing info
[0m13:51:07.930922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cbf716-25a4-487f-a665-f86d98122dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838936cb20>]}
[0m13:51:07.931356 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (62.3k rows, 85.4 MB processed)[0m in 5.44s]
[0m13:51:07.931835 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:51:07.933437 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:51:07.933994 [info ] [MainThread]: 
[0m13:51:07.934293 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m13:51:07.934569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:07.934803 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:51:07.942468 [info ] [MainThread]: 
[0m13:51:07.942853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:07.943171 [info ] [MainThread]: 
[0m13:51:07.943422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:51:07.943777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a2dfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a2f0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f838a2f0d00>]}
[0m13:51:07.944039 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:53:19.521324 | 0b149285-af82-4471-9e9c-e02e54de1a9d ==============================
[0m13:53:19.521335 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:53:19.521684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:53:19.521836 [debug] [MainThread]: Tracking: tracking
[0m13:53:19.523177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb023b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb023b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb0239f60>]}
[0m13:53:19.573878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:19.574290 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:53:19.589163 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:53:19.622601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b149285-af82-4471-9e9c-e02e54de1a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb001e320>]}
[0m13:53:19.629947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b149285-af82-4471-9e9c-e02e54de1a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb36ee1d0>]}
[0m13:53:19.630260 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:53:19.630528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b149285-af82-4471-9e9c-e02e54de1a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaffc9c30>]}
[0m13:53:19.631524 [info ] [MainThread]: 
[0m13:53:19.632153 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:53:19.633114 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:53:19.633435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:21.312295 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:53:21.312937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:22.524666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b149285-af82-4471-9e9c-e02e54de1a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaffd7e80>]}
[0m13:53:22.526500 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:53:22.527429 [info ] [MainThread]: 
[0m13:53:22.534393 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:53:22.534712 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:53:22.535361 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:53:22.535566 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:53:22.535747 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:53:22.540756 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:53:22.541250 [debug] [Thread-1 (]: finished collecting timing info
[0m13:53:22.541494 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:53:22.563640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:23.949679 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:53:23.950144 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        coalesce(destination_port, voyage_origin_port) as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m13:53:27.711879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:ad68984e-8b6d-4604-ad83-d2ec995bca0a:US&page=queryresults
[0m13:53:27.735411 [debug] [Thread-1 (]: finished collecting timing info
[0m13:53:27.736071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b149285-af82-4471-9e9c-e02e54de1a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaf068e50>]}
[0m13:53:27.736438 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (99.4k rows, 85.4 MB processed)[0m in 5.20s]
[0m13:53:27.736885 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:53:27.738307 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:53:27.738873 [info ] [MainThread]: 
[0m13:53:27.739200 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m13:53:27.739467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:27.739607 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:53:27.747212 [info ] [MainThread]: 
[0m13:53:27.747538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:27.747849 [info ] [MainThread]: 
[0m13:53:27.748099 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:53:27.748428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaffc9c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaffb3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb00307f0>]}
[0m13:53:27.748699 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 13:56:47.327047 | 8c4d236e-ef23-4861-a1fb-47cd625c0d05 ==============================
[0m13:56:47.327057 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:56:47.327573 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:56:47.327824 [debug] [MainThread]: Tracking: tracking
[0m13:56:47.329153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea113bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea113bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea113bf70>]}
[0m13:56:47.377665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:47.378029 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m13:56:47.391139 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m13:56:47.419452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4d236e-ef23-4861-a1fb-47cd625c0d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9bd20e80>]}
[0m13:56:47.425900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c4d236e-ef23-4861-a1fb-47cd625c0d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea0eb33a0>]}
[0m13:56:47.426180 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:56:47.426491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4d236e-ef23-4861-a1fb-47cd625c0d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea0ec98d0>]}
[0m13:56:47.427623 [info ] [MainThread]: 
[0m13:56:47.428179 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:56:47.429185 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m13:56:47.429356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:49.052936 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m13:56:49.053841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:50.291375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4d236e-ef23-4861-a1fb-47cd625c0d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea0edbbb0>]}
[0m13:56:50.292041 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:56:50.292341 [info ] [MainThread]: 
[0m13:56:50.298340 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:56:50.298660 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m13:56:50.299320 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:56:50.299489 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:56:50.299664 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:56:50.304528 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:56:50.305001 [debug] [Thread-1 (]: finished collecting timing info
[0m13:56:50.305231 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:56:50.327678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:51.645433 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m13:56:51.645873 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        coalesce(voyage_origin_port,destination_port) as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m13:56:55.328816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:c1039dd3-c49e-465f-bb3a-946d17d99021:US&page=queryresults
[0m13:56:55.373780 [debug] [Thread-1 (]: finished collecting timing info
[0m13:56:55.374585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4d236e-ef23-4861-a1fb-47cd625c0d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9bd20b20>]}
[0m13:56:55.375080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (99.4k rows, 85.4 MB processed)[0m in 5.08s]
[0m13:56:55.375532 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m13:56:55.377006 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:56:55.377609 [info ] [MainThread]: 
[0m13:56:55.377982 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m13:56:55.378257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:55.378402 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m13:56:55.385916 [info ] [MainThread]: 
[0m13:56:55.386243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:55.386543 [info ] [MainThread]: 
[0m13:56:55.386802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:56:55.387128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea0edbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea0eecd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea0eecca0>]}
[0m13:56:55.387393 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:00:44.109170 | 01ce50e1-67e4-4225-849a-420e9af6debc ==============================
[0m14:00:44.109181 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:00:44.109572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:00:44.109723 [debug] [MainThread]: Tracking: tracking
[0m14:00:44.111157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec8436a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec843790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec843730>]}
[0m14:00:44.159471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:44.159850 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:00:44.173263 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:00:44.201881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ce50e1-67e4-4225-849a-420e9af6debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb46ca00>]}
[0m14:00:44.208864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ce50e1-67e4-4225-849a-420e9af6debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec5b7d90>]}
[0m14:00:44.209184 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:00:44.209422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ce50e1-67e4-4225-849a-420e9af6debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec5cd450>]}
[0m14:00:44.210360 [info ] [MainThread]: 
[0m14:00:44.210967 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:00:44.211847 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:00:44.212143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:46.030262 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:00:46.031161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:47.288210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ce50e1-67e4-4225-849a-420e9af6debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec8423b0>]}
[0m14:00:47.290046 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:00:47.290963 [info ] [MainThread]: 
[0m14:00:47.297768 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:00:47.298138 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:00:47.298917 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:00:47.299128 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:00:47.299314 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:00:47.304527 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:00:47.304910 [debug] [Thread-1 (]: finished collecting timing info
[0m14:00:47.305096 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:00:47.322796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:48.611631 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:00:48.612082 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port is null then destination_port
             when destination_port is null then voyage_origin_port 
             else 'other' end as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:00:52.313608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:7bbfeebc-92c3-4ee9-a71c-05ae45bdcbda:US&page=queryresults
[0m14:00:52.335410 [debug] [Thread-1 (]: finished collecting timing info
[0m14:00:52.336051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ce50e1-67e4-4225-849a-420e9af6debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb46c820>]}
[0m14:00:52.336418 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (99.4k rows, 85.4 MB processed)[0m in 5.04s]
[0m14:00:52.336847 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:00:52.338318 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:00:52.338891 [info ] [MainThread]: 
[0m14:00:52.339178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m14:00:52.339433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:52.339568 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:00:52.346949 [info ] [MainThread]: 
[0m14:00:52.347284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:52.347600 [info ] [MainThread]: 
[0m14:00:52.347850 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:52.348179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec5f00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec842770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eb509150>]}
[0m14:00:52.348429 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:02:52.411851 | 74fbd5f3-92ac-40b8-a150-f61f7964cfc9 ==============================
[0m14:02:52.411862 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:02:52.412202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:02:52.412367 [debug] [MainThread]: Tracking: tracking
[0m14:02:52.413814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1513043670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1513043760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1513043700>]}
[0m14:02:52.461362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:02:52.461732 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:02:52.475514 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:02:52.503933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74fbd5f3-92ac-40b8-a150-f61f7964cfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1511e709d0>]}
[0m14:02:52.510877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74fbd5f3-92ac-40b8-a150-f61f7964cfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1512db7d60>]}
[0m14:02:52.511195 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:02:52.511427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74fbd5f3-92ac-40b8-a150-f61f7964cfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1512dcd420>]}
[0m14:02:52.512384 [info ] [MainThread]: 
[0m14:02:52.512948 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:02:52.513819 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:02:52.514084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:55.149278 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:02:55.150199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:56.987093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74fbd5f3-92ac-40b8-a150-f61f7964cfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15130405e0>]}
[0m14:02:56.988986 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:02:56.989901 [info ] [MainThread]: 
[0m14:02:56.996647 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:02:56.996975 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:02:56.997692 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:02:56.997900 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:02:56.998069 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:02:57.003186 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:02:57.003641 [debug] [Thread-1 (]: finished collecting timing info
[0m14:02:57.003887 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:02:57.027680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:58.905661 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:02:58.906106 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        left(destination_port,1) as str,
        case when voyage_origin_port is null then destination_port
             when destination_port is null then voyage_origin_port 
             else 'other' end as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:03:02.919748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:6d42b0d7-4776-40ad-8d7f-2a639a503fca:US&page=queryresults
[0m14:03:02.941117 [debug] [Thread-1 (]: finished collecting timing info
[0m14:03:02.941785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74fbd5f3-92ac-40b8-a150-f61f7964cfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1511e708e0>]}
[0m14:03:02.942171 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (99.4k rows, 85.4 MB processed)[0m in 5.94s]
[0m14:03:02.942612 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:03:02.944030 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:03:02.944554 [info ] [MainThread]: 
[0m14:03:02.944835 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.43 seconds (10.43s).
[0m14:03:02.945089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:02.945227 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:03:02.952797 [info ] [MainThread]: 
[0m14:03:02.953113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:02.953419 [info ] [MainThread]: 
[0m14:03:02.953661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:03:02.954001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1512df00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1513043310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1511f0d060>]}
[0m14:03:02.954251 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:04:07.208847 | b3d1f9f4-ec20-41b4-b686-a46d25a31519 ==============================
[0m14:04:07.208858 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:04:07.209231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:04:07.209408 [debug] [MainThread]: Tracking: tracking
[0m14:04:07.210688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c733fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c733f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c733ffd0>]}
[0m14:04:07.258955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:07.259328 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:04:07.272533 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:04:07.301027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d1f9f4-ec20-41b4-b686-a46d25a31519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c6168ee0>]}
[0m14:04:07.308259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d1f9f4-ec20-41b4-b686-a46d25a31519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c70b73a0>]}
[0m14:04:07.308557 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:04:07.308801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d1f9f4-ec20-41b4-b686-a46d25a31519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c70cd930>]}
[0m14:04:07.309720 [info ] [MainThread]: 
[0m14:04:07.310292 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:04:07.311178 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:04:07.311470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:09.606656 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:04:09.607549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:11.433342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d1f9f4-ec20-41b4-b686-a46d25a31519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c70dfbb0>]}
[0m14:04:11.435165 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:04:11.436034 [info ] [MainThread]: 
[0m14:04:11.449645 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:11.450916 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:04:11.453612 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:04:11.454359 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:11.455028 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:11.466917 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:04:11.467995 [debug] [Thread-1 (]: finished collecting timing info
[0m14:04:11.468610 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:11.496633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:13.367603 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:04:13.368058 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port '-' then voyage_origin_port 
             else 'other' end as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:04:13.800883 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal '-' at [39:36]")
[0m14:04:15.077471 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:dcab36b3-ab3d-4be5-a16a-597ab937ea35&page=queryresults
[0m14:04:15.078865 [debug] [Thread-1 (]: finished collecting timing info
[0m14:04:15.080440 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Unexpected string literal '-' at [39:36]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:04:15.080716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d1f9f4-ec20-41b4-b686-a46d25a31519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c6046560>]}
[0m14:04:15.081081 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.63s]
[0m14:04:15.081512 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:15.083151 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:04:15.083702 [info ] [MainThread]: 
[0m14:04:15.083996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m14:04:15.084268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:15.084413 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:04:15.093112 [info ] [MainThread]: 
[0m14:04:15.093486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:04:15.093823 [info ] [MainThread]: 
[0m14:04:15.094110 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:04:15.094393 [error] [MainThread]:   Syntax error: Unexpected string literal '-' at [39:36]
[0m14:04:15.094662 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:04:15.094971 [info ] [MainThread]: 
[0m14:04:15.095247 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:04:15.095616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c70dff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c7131270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c70f0070>]}
[0m14:04:15.095910 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:04:41.479294 | 2ce45fbe-b38d-43d1-8d4f-56ed78e3352a ==============================
[0m14:04:41.479305 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:04:41.479691 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:04:41.479855 [debug] [MainThread]: Tracking: tracking
[0m14:04:41.481137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993db3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993db3f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993db3de70>]}
[0m14:04:41.533626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:41.534013 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:04:41.547975 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:04:41.576815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce45fbe-b38d-43d1-8d4f-56ed78e3352a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c76d0f0>]}
[0m14:04:41.584135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce45fbe-b38d-43d1-8d4f-56ed78e3352a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993d8b7220>]}
[0m14:04:41.584434 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:04:41.584687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce45fbe-b38d-43d1-8d4f-56ed78e3352a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993d8cdb40>]}
[0m14:04:41.585590 [info ] [MainThread]: 
[0m14:04:41.586149 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:04:41.587057 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:04:41.587370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:43.856134 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:04:43.856770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:45.896852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce45fbe-b38d-43d1-8d4f-56ed78e3352a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993d8dfc70>]}
[0m14:04:45.898797 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:04:45.899685 [info ] [MainThread]: 
[0m14:04:45.906588 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:45.906920 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:04:45.907656 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:04:45.907860 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:45.908030 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:45.912759 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:04:45.913184 [debug] [Thread-1 (]: finished collecting timing info
[0m14:04:45.913375 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:45.931747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:47.824631 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:04:47.825101 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port
    from source_vessel_tracking_events 
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:04:51.717283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:df03fa3b-8994-4a7e-ab07-6ec7db409fcb:US&page=queryresults
[0m14:04:51.738678 [debug] [Thread-1 (]: finished collecting timing info
[0m14:04:51.739338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce45fbe-b38d-43d1-8d4f-56ed78e3352a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c76caf0>]}
[0m14:04:51.739721 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (99.4k rows, 85.4 MB processed)[0m in 5.83s]
[0m14:04:51.740159 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:04:51.741728 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:04:51.742251 [info ] [MainThread]: 
[0m14:04:51.742532 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m14:04:51.742809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:51.742953 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:04:51.750389 [info ] [MainThread]: 
[0m14:04:51.750699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:51.751094 [info ] [MainThread]: 
[0m14:04:51.751483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:51.751988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993d8dfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993d8f0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993d8f1840>]}
[0m14:04:51.752308 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:16:26.882420 | 916e2649-b1c3-454b-be6f-a2936929b830 ==============================
[0m14:16:26.882431 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:16:26.883310 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:16:26.883492 [debug] [MainThread]: Tracking: tracking
[0m14:16:26.885330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b327b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b327fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b327f40>]}
[0m14:16:27.322295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:27.322785 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:16:27.341596 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:16:27.372762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '916e2649-b1c3-454b-be6f-a2936929b830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff879f58e50>]}
[0m14:16:27.393609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '916e2649-b1c3-454b-be6f-a2936929b830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b09f3a0>]}
[0m14:16:27.394094 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:16:27.394516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '916e2649-b1c3-454b-be6f-a2936929b830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b0b58a0>]}
[0m14:16:27.396079 [info ] [MainThread]: 
[0m14:16:27.397060 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:16:27.398549 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:16:27.399003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:29.468856 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:16:29.469730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:30.859484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '916e2649-b1c3-454b-be6f-a2936929b830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b0c7bb0>]}
[0m14:16:30.861307 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:16:30.862173 [info ] [MainThread]: 
[0m14:16:31.019441 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:16:31.020396 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:16:31.022324 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:16:31.022882 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:16:31.023356 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:16:31.037372 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:16:31.079037 [debug] [Thread-1 (]: finished collecting timing info
[0m14:16:31.079711 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:16:31.119180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:32.620320 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:16:32.622008 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country,
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,

    from source_vessel_tracking_events 


)



vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:16:33.120488 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "vessel_tracked_events_origin" at [75:1]')
[0m14:16:34.147290 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:d3e9c2c6-ad3d-45a2-928b-db3ec09bcecd&page=queryresults
[0m14:16:34.148569 [debug] [Thread-1 (]: finished collecting timing info
[0m14:16:34.150117 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "vessel_tracked_events_origin" at [75:1]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:16:34.150531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '916e2649-b1c3-454b-be6f-a2936929b830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87a03ef20>]}
[0m14:16:34.150906 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.13s]
[0m14:16:34.151334 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:16:34.152750 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:16:34.153344 [info ] [MainThread]: 
[0m14:16:34.153678 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m14:16:34.153980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:34.154142 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:16:34.165536 [info ] [MainThread]: 
[0m14:16:34.165891 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:34.166206 [info ] [MainThread]: 
[0m14:16:34.166475 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:16:34.166753 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "vessel_tracked_events_origin" at [75:1]
[0m14:16:34.167008 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:16:34.167274 [info ] [MainThread]: 
[0m14:16:34.167622 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:34.167991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b325480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b326830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87b0d8700>]}
[0m14:16:34.168281 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:17:20.625433 | e3859b06-7460-446e-ba1b-08ad3896d77a ==============================
[0m14:17:20.625444 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:17:20.625971 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:17:20.626152 [debug] [MainThread]: Tracking: tracking
[0m14:17:20.627697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66e3bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66e3b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66e3bfa0>]}
[0m14:17:20.675939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:20.676309 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:17:20.690013 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:17:20.718983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3859b06-7460-446e-ba1b-08ad3896d77a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb65c70eb0>]}
[0m14:17:20.725863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3859b06-7460-446e-ba1b-08ad3896d77a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66bb33a0>]}
[0m14:17:20.726138 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:17:20.726373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3859b06-7460-446e-ba1b-08ad3896d77a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66bc9900>]}
[0m14:17:20.727534 [info ] [MainThread]: 
[0m14:17:20.728159 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:17:20.729044 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:17:20.729220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:22.682165 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:17:22.682824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:24.142043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3859b06-7460-446e-ba1b-08ad3896d77a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66bdb9a0>]}
[0m14:17:24.143907 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:17:24.144784 [info ] [MainThread]: 
[0m14:17:24.158811 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:17:24.159776 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:17:24.161663 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:17:24.162171 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:17:24.162638 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:17:24.175911 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:17:24.177028 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:24.177705 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:17:24.207606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:26.138493 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:17:26.138947 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country,
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,

    from source_vessel_tracking_events 


),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:17:30.176494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:a227d90f-5387-4964-83f8-41a620d291cb:US&page=queryresults
[0m14:17:30.197498 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.198172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3859b06-7460-446e-ba1b-08ad3896d77a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb65c70a60>]}
[0m14:17:30.198549 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (99.4k rows, 109.2 MB processed)[0m in 6.04s]
[0m14:17:30.199048 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:17:30.200530 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:17:30.201044 [info ] [MainThread]: 
[0m14:17:30.201325 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m14:17:30.201580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:30.201717 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:17:30.209390 [info ] [MainThread]: 
[0m14:17:30.209708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:30.210012 [info ] [MainThread]: 
[0m14:17:30.210308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:30.210679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66bdbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66c2ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb66bec340>]}
[0m14:17:30.210969 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:23:10.653991 | def99944-1a46-432e-8e3e-6315cd05eda3 ==============================
[0m14:23:10.654001 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:23:10.654354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:23:10.654505 [debug] [MainThread]: Tracking: tracking
[0m14:23:10.656016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8bb2b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8bb2bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8bb2bcd0>]}
[0m14:23:10.709543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:10.709942 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:23:10.725002 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:23:10.757807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'def99944-1a46-432e-8e3e-6315cd05eda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8a764be0>]}
[0m14:23:10.765258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'def99944-1a46-432e-8e3e-6315cd05eda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8b89ff70>]}
[0m14:23:10.765550 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:23:10.765800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def99944-1a46-432e-8e3e-6315cd05eda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8b8b5630>]}
[0m14:23:10.766863 [info ] [MainThread]: 
[0m14:23:10.767541 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:23:10.768507 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:23:10.768694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:13.120710 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:23:13.121343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:14.526664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def99944-1a46-432e-8e3e-6315cd05eda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8bb2b670>]}
[0m14:23:14.528606 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:23:14.529559 [info ] [MainThread]: 
[0m14:23:14.536412 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:23:14.536717 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:23:14.537361 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:23:14.537534 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:23:14.538485 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:23:14.542383 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:23:14.542773 [debug] [Thread-1 (]: finished collecting timing info
[0m14:23:14.542962 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:23:14.561996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:15.892936 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:23:15.893354 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select
        mmsi,
        port,
        country_code

    from vessel_ports_all




vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_origin_destination_ports

)

select * from final
    );
  
[0m14:23:16.409531 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AS at [86:30]')
[0m14:23:17.124742 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:07f9778b-8e41-43b7-93df-2a4fc7482b83&page=queryresults
[0m14:23:17.126008 [debug] [Thread-1 (]: finished collecting timing info
[0m14:23:17.127614 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got keyword AS at [86:30]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:23:17.128506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def99944-1a46-432e-8e3e-6315cd05eda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8a83fa60>]}
[0m14:23:17.129517 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 2.59s]
[0m14:23:17.130700 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:23:17.134236 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:23:17.135808 [info ] [MainThread]: 
[0m14:23:17.136678 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m14:23:17.137984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:17.138752 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:23:17.163438 [info ] [MainThread]: 
[0m14:23:17.164267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:23:17.165209 [info ] [MainThread]: 
[0m14:23:17.166292 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:23:17.167581 [error] [MainThread]:   Syntax error: Expected ")" but got keyword AS at [86:30]
[0m14:23:17.168401 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:23:17.169111 [info ] [MainThread]: 
[0m14:23:17.169947 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:23:17.170846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8b8c7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8b8c7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e8b8d8c70>]}
[0m14:23:17.171490 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:23:56.876598 | b8f43c96-872f-4dae-82df-12376536363c ==============================
[0m14:23:56.876609 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:23:56.876979 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:23:56.877134 [debug] [MainThread]: Tracking: tracking
[0m14:23:56.878666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de33fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de33f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de33ffa0>]}
[0m14:23:56.926808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:56.927239 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:23:56.940744 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:23:56.969390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8f43c96-872f-4dae-82df-12376536363c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dd170eb0>]}
[0m14:23:56.976636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8f43c96-872f-4dae-82df-12376536363c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de0b73a0>]}
[0m14:23:56.976919 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:23:56.977189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f43c96-872f-4dae-82df-12376536363c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de0cd900>]}
[0m14:23:56.978269 [info ] [MainThread]: 
[0m14:23:56.978873 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:23:56.979788 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:23:56.980086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:58.809047 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:23:58.809874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:00.088500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f43c96-872f-4dae-82df-12376536363c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de0df9a0>]}
[0m14:24:00.090305 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:24:00.091214 [info ] [MainThread]: 
[0m14:24:00.104924 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:24:00.105833 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:24:00.107807 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:24:00.108516 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:24:00.108992 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:24:00.121726 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:24:00.122812 [debug] [Thread-1 (]: finished collecting timing info
[0m14:24:00.123332 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:24:00.152334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:01.623956 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:24:01.624400 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select
        mmsi,
        port,
        country_code

    from vessel_ports_all




vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:24:02.125413 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AS at [86:30]')
[0m14:24:03.447414 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:c9bce4d7-5de8-48a2-bc74-8ede7fa29d86&page=queryresults
[0m14:24:03.448932 [debug] [Thread-1 (]: finished collecting timing info
[0m14:24:03.450488 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got keyword AS at [86:30]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:24:03.451287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f43c96-872f-4dae-82df-12376536363c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dd0465f0>]}
[0m14:24:03.452287 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.34s]
[0m14:24:03.453600 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:24:03.457402 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:24:03.458993 [info ] [MainThread]: 
[0m14:24:03.459850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m14:24:03.460656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:03.461083 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:24:03.469618 [info ] [MainThread]: 
[0m14:24:03.470035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:24:03.470329 [info ] [MainThread]: 
[0m14:24:03.470585 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:24:03.470874 [error] [MainThread]:   Syntax error: Expected ")" but got keyword AS at [86:30]
[0m14:24:03.471152 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:24:03.471393 [info ] [MainThread]: 
[0m14:24:03.471628 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:24:03.471953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de33c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de33e830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41de0f0dc0>]}
[0m14:24:03.472205 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:25:30.125314 | 17d84cb8-d008-409c-9ecb-f36525e0bc39 ==============================
[0m14:25:30.125325 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:25:30.125709 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:25:30.125856 [debug] [MainThread]: Tracking: tracking
[0m14:25:30.127218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9533bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9533b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9533b730>]}
[0m14:25:30.175260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:30.175684 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:25:30.190096 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:25:30.219575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17d84cb8-d008-409c-9ecb-f36525e0bc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b77f20f10>]}
[0m14:25:30.227485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17d84cb8-d008-409c-9ecb-f36525e0bc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b950b33a0>]}
[0m14:25:30.227838 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:25:30.228090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17d84cb8-d008-409c-9ecb-f36525e0bc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b950c9960>]}
[0m14:25:30.229035 [info ] [MainThread]: 
[0m14:25:30.229611 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:25:30.230526 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:25:30.230721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:31.954775 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:25:31.955313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:33.348529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17d84cb8-d008-409c-9ecb-f36525e0bc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b950dbbb0>]}
[0m14:25:33.350357 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:25:33.351267 [info ] [MainThread]: 
[0m14:25:33.364664 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:25:33.365549 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:25:33.367446 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:25:33.367987 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:25:33.370556 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:25:33.379108 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:25:33.379845 [debug] [Thread-1 (]: finished collecting timing info
[0m14:25:33.380384 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:25:33.401027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:34.696146 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:25:34.696599 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:25:42.115997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:032f7ff7-eed1-4fdc-a26c-d6823d0a8dea:US&page=queryresults
[0m14:25:42.159955 [debug] [Thread-1 (]: finished collecting timing info
[0m14:25:42.160730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17d84cb8-d008-409c-9ecb-f36525e0bc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b77f209d0>]}
[0m14:25:42.161185 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 8.79s]
[0m14:25:42.161630 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:25:42.163170 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:25:42.163744 [info ] [MainThread]: 
[0m14:25:42.164036 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.93 seconds (11.93s).
[0m14:25:42.164298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:42.164438 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:25:42.172619 [info ] [MainThread]: 
[0m14:25:42.172979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:42.173281 [info ] [MainThread]: 
[0m14:25:42.173524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:25:42.173860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b950dbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b950edd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b950ecc40>]}
[0m14:25:42.174118 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:32:07.226129 | b0a0efe8-3b41-4eaa-b6b9-70145b914cf3 ==============================
[0m14:32:07.226139 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:32:07.226503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:32:07.226659 [debug] [MainThread]: Tracking: tracking
[0m14:32:07.228293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0fb3b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0fb3b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0fb39f90>]}
[0m14:32:07.284048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:07.284408 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:32:07.297764 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:32:07.326978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0a0efe8-3b41-4eaa-b6b9-70145b914cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0f91e350>]}
[0m14:32:07.334638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0a0efe8-3b41-4eaa-b6b9-70145b914cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf12fe0af0>]}
[0m14:32:07.334975 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:32:07.335226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a0efe8-3b41-4eaa-b6b9-70145b914cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0f8c9c60>]}
[0m14:32:07.336138 [info ] [MainThread]: 
[0m14:32:07.336690 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:07.337622 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:32:07.337938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:09.959223 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:32:09.959864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:11.795065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a0efe8-3b41-4eaa-b6b9-70145b914cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0f8dbdf0>]}
[0m14:32:11.796880 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:32:11.797994 [info ] [MainThread]: 
[0m14:32:11.811742 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:32:11.812858 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:32:11.814840 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:32:11.815365 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:32:11.815833 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:32:11.831616 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:32:11.832802 [debug] [Thread-1 (]: finished collecting timing info
[0m14:32:11.833353 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:32:11.863483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:13.748837 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:32:13.749284 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else coalesce(orgin_port_country, destination_port_country) end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:32:15.385613 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: orgin_port_country; Did you mean origin_port_country? at [67:28]')
[0m14:32:17.776335 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:5b6ff002-6780-46f1-aca1-1278b3c91420&page=queryresults
[0m14:32:17.777633 [debug] [Thread-1 (]: finished collecting timing info
[0m14:32:17.779238 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: orgin_port_country; Did you mean origin_port_country? at [67:28]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:32:17.780037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a0efe8-3b41-4eaa-b6b9-70145b914cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ea17100>]}
[0m14:32:17.780516 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.97s]
[0m14:32:17.780950 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:32:17.782332 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:17.782872 [info ] [MainThread]: 
[0m14:32:17.783173 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m14:32:17.783503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:17.783697 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:32:17.793419 [info ] [MainThread]: 
[0m14:32:17.793850 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:17.794267 [info ] [MainThread]: 
[0m14:32:17.794633 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:32:17.795013 [error] [MainThread]:   Unrecognized name: orgin_port_country; Did you mean origin_port_country? at [67:28]
[0m14:32:17.795365 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:32:17.795720 [info ] [MainThread]: 
[0m14:32:17.796068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:17.796541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0f8b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0f8dbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0f8ec040>]}
[0m14:32:17.796856 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:32:57.367147 | ad2ffcda-6d9a-473e-81bf-e44b2ba98c6b ==============================
[0m14:32:57.367171 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:32:57.367700 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:32:57.367888 [debug] [MainThread]: Tracking: tracking
[0m14:32:57.369317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f53f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f53f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f53df90>]}
[0m14:32:57.418024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:57.418382 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:32:57.432063 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:32:57.460892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad2ffcda-6d9a-473e-81bf-e44b2ba98c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f322350>]}
[0m14:32:57.468406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad2ffcda-6d9a-473e-81bf-e44b2ba98c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec129e4af0>]}
[0m14:32:57.468695 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:32:57.468933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad2ffcda-6d9a-473e-81bf-e44b2ba98c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f2cdc60>]}
[0m14:32:57.469846 [info ] [MainThread]: 
[0m14:32:57.470419 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:57.471365 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:32:57.471661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:59.732216 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:32:59.732830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:01.554923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad2ffcda-6d9a-473e-81bf-e44b2ba98c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f2dbdf0>]}
[0m14:33:01.556711 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:33:01.557572 [info ] [MainThread]: 
[0m14:33:01.570991 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:33:01.571889 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:33:01.573771 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:33:01.574229 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:33:01.574674 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:33:01.586290 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:33:01.587288 [debug] [Thread-1 (]: finished collecting timing info
[0m14:33:01.587918 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:33:01.617075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:03.481943 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:33:03.482382 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (

    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all

    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else coalesce(origin_port_country, destination_port_country) end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:33:11.494413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:4ba866d7-68cd-41b2-b2e9-45ea43b801f8:US&page=queryresults
[0m14:33:11.537863 [debug] [Thread-1 (]: finished collecting timing info
[0m14:33:11.538685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2ffcda-6d9a-473e-81bf-e44b2ba98c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0e36cd90>]}
[0m14:33:11.539077 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 9.97s]
[0m14:33:11.539530 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:33:11.540952 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:33:11.541501 [info ] [MainThread]: 
[0m14:33:11.541785 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.07 seconds (14.07s).
[0m14:33:11.542059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:11.542197 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:33:11.549935 [info ] [MainThread]: 
[0m14:33:11.550266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:11.550566 [info ] [MainThread]: 
[0m14:33:11.550913 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:33:11.551364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f2cdc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f2b7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0f2f0d90>]}
[0m14:33:11.551617 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:36:04.364596 | fb273166-5c2a-454c-b8e5-d167d9ef1a6a ==============================
[0m14:36:04.364606 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:36:04.364946 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:36:04.365094 [debug] [MainThread]: Tracking: tracking
[0m14:36:04.366407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac689435e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac689436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac68943670>]}
[0m14:36:04.415524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:04.415896 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:36:04.429789 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:36:04.459228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb273166-5c2a-454c-b8e5-d167d9ef1a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac6350beb0>]}
[0m14:36:04.466766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb273166-5c2a-454c-b8e5-d167d9ef1a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac686b7cd0>]}
[0m14:36:04.467069 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:36:04.467339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb273166-5c2a-454c-b8e5-d167d9ef1a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac686cd390>]}
[0m14:36:04.468303 [info ] [MainThread]: 
[0m14:36:04.468860 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:36:04.469756 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:36:04.470059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:06.704360 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:36:06.705252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:08.524738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb273166-5c2a-454c-b8e5-d167d9ef1a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac689422f0>]}
[0m14:36:08.526525 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:36:08.527577 [info ] [MainThread]: 
[0m14:36:08.541523 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:08.542413 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:36:08.544289 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:36:08.544825 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:08.545280 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:08.556835 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:36:08.557618 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:08.557943 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:08.579194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:09.993364 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:36:09.993782 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (
/*
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
*/
    select
        mmsi,
        destination_origin_country,
        origin_port_country,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else coalesce(origin_port_country, destination_port_country) end as country_code,
        port_type


    from source_vessel_tracking_events 

),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:36:11.537332 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: destination_origin_country; Did you mean destination_port_country? at [62:9]')
[0m14:36:13.637361 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:b87e5a92-cf5e-49f8-bc7f-94afc1697ab9&page=queryresults
[0m14:36:13.638933 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:13.640478 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: destination_origin_country; Did you mean destination_port_country? at [62:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:36:13.641214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb273166-5c2a-454c-b8e5-d167d9ef1a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac635d3ee0>]}
[0m14:36:13.641711 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.10s]
[0m14:36:13.642159 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:13.643769 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:36:13.644301 [info ] [MainThread]: 
[0m14:36:13.644587 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m14:36:13.644849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:13.644988 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:36:13.653197 [info ] [MainThread]: 
[0m14:36:13.653518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:36:13.653806 [info ] [MainThread]: 
[0m14:36:13.654053 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:36:13.654295 [error] [MainThread]:   Unrecognized name: destination_origin_country; Did you mean destination_port_country? at [62:9]
[0m14:36:13.654526 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:36:13.654789 [info ] [MainThread]: 
[0m14:36:13.655048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:36:13.655365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac68734c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac68734400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac686dfc10>]}
[0m14:36:13.655609 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:36:49.945040 | 9483b4e9-d162-46eb-b727-848e65e4f066 ==============================
[0m14:36:49.945050 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:36:49.945431 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:36:49.945594 [debug] [MainThread]: Tracking: tracking
[0m14:36:49.946928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a652b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a652bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a652bbe0>]}
[0m14:36:49.995988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:49.996365 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:36:50.009989 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:36:50.039236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9483b4e9-d162-46eb-b727-848e65e4f066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a5358bb0>]}
[0m14:36:50.046335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9483b4e9-d162-46eb-b727-848e65e4f066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a629ff40>]}
[0m14:36:50.046623 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:36:50.046944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9483b4e9-d162-46eb-b727-848e65e4f066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a62b5600>]}
[0m14:36:50.048072 [info ] [MainThread]: 
[0m14:36:50.048656 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:36:50.049509 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:36:50.049805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:52.303211 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:36:52.303869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:53.676393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9483b4e9-d162-46eb-b727-848e65e4f066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a6529000>]}
[0m14:36:53.678199 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:36:53.679197 [info ] [MainThread]: 
[0m14:36:53.685897 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:53.686219 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:36:53.686940 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:36:53.687121 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:53.687284 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:53.692009 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:36:53.692421 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:53.692616 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:36:53.710989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:55.108014 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:36:55.108507 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (
/*
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
*/
    select
        mmsi,
        destination_port_country,
        origin_port_country,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else coalesce(origin_port_country, destination_port_country) end as country_code,
        port_type


    from source_vessel_tracking_events 

),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:37:02.337702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:34a805b4-97ac-42cd-ad83-3ba8c525ad65:US&page=queryresults
[0m14:37:02.380670 [debug] [Thread-1 (]: finished collecting timing info
[0m14:37:02.381401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9483b4e9-d162-46eb-b727-848e65e4f066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a53589d0>]}
[0m14:37:02.381821 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (512.0k rows, 467.5 MB processed)[0m in 8.69s]
[0m14:37:02.382327 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:37:02.383780 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:37:02.384300 [info ] [MainThread]: 
[0m14:37:02.384587 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.34 seconds (12.34s).
[0m14:37:02.384854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:02.384995 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:37:02.392614 [info ] [MainThread]: 
[0m14:37:02.392923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:02.393248 [info ] [MainThread]: 
[0m14:37:02.393495 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:37:02.393811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a62d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a65293c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a62c78b0>]}
[0m14:37:02.394075 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:46:27.612091 | 42fe675f-2c22-41bd-8fb5-5828dbfb027f ==============================
[0m14:46:27.612101 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:46:27.612456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:46:27.612601 [debug] [MainThread]: Tracking: tracking
[0m14:46:27.613952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e93b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e93b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e939f00>]}
[0m14:46:27.676901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:46:27.677348 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:46:27.692201 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:46:27.727359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42fe675f-2c22-41bd-8fb5-5828dbfb027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240d76d0f0>]}
[0m14:46:27.807393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42fe675f-2c22-41bd-8fb5-5828dbfb027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2411dee140>]}
[0m14:46:27.808268 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:46:27.809062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fe675f-2c22-41bd-8fb5-5828dbfb027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e6c9bd0>]}
[0m14:46:27.811681 [info ] [MainThread]: 
[0m14:46:27.813280 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:46:27.815591 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:46:27.816340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:30.492235 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:46:30.492606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:32.350427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fe675f-2c22-41bd-8fb5-5828dbfb027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e6db910>]}
[0m14:46:32.352315 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:46:32.353173 [info ] [MainThread]: 
[0m14:46:32.367339 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:46:32.368272 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:46:32.370143 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:46:32.370651 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:46:32.371144 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:46:32.376658 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:46:32.377034 [debug] [Thread-1 (]: finished collecting timing info
[0m14:46:32.377252 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:46:32.394512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:33.867857 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:46:33.868325 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (
    
    select 
        mmsi,
        vessel_name,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        vessel_name,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type


    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        vessel_name,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port_at_call end as port
        country_code,
        from vessel_ports_all
)



vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:46:34.304687 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "country_code" at [88:9]')
[0m14:46:35.616118 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:5deecbb2-fbd5-4fbd-ba8a-258fb453dec7&page=queryresults
[0m14:46:35.617508 [debug] [Thread-1 (]: finished collecting timing info
[0m14:46:35.618800 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got identifier "country_code" at [88:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:46:35.619078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fe675f-2c22-41bd-8fb5-5828dbfb027f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240d8160b0>]}
[0m14:46:35.619442 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.25s]
[0m14:46:35.619883 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:46:35.621482 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:46:35.622010 [info ] [MainThread]: 
[0m14:46:35.622288 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m14:46:35.622685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:35.622848 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:46:35.631624 [info ] [MainThread]: 
[0m14:46:35.631987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:46:35.632310 [info ] [MainThread]: 
[0m14:46:35.632587 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:46:35.632855 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "country_code" at [88:9]
[0m14:46:35.633122 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:46:35.633380 [info ] [MainThread]: 
[0m14:46:35.633637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:46:35.634037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e93a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e93bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240e6ec0a0>]}
[0m14:46:35.634313 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:47:15.055875 | 6c243a25-8278-4ff1-924e-f3b10e5450d7 ==============================
[0m14:47:15.055886 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:47:15.056270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:47:15.056437 [debug] [MainThread]: Tracking: tracking
[0m14:47:15.058015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d743970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d743df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d743d90>]}
[0m14:47:15.108129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:15.108529 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:47:15.122506 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:47:15.157442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c243a25-8278-4ff1-924e-f3b10e5450d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646c570c70>]}
[0m14:47:15.165085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c243a25-8278-4ff1-924e-f3b10e5450d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d4b7490>]}
[0m14:47:15.165372 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:47:15.165618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c243a25-8278-4ff1-924e-f3b10e5450d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d4cd6c0>]}
[0m14:47:15.166531 [info ] [MainThread]: 
[0m14:47:15.167159 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:47:15.168106 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:47:15.168412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:16.920294 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:47:16.921202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:18.776593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c243a25-8278-4ff1-924e-f3b10e5450d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d4dfa30>]}
[0m14:47:18.778578 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:47:18.779507 [info ] [MainThread]: 
[0m14:47:18.786123 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:47:18.786441 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:47:18.787204 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:47:18.787387 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:47:18.787552 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:47:18.792660 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:47:18.793055 [debug] [Thread-1 (]: finished collecting timing info
[0m14:47:18.793239 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:47:18.810710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:20.216096 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:47:20.216563 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_at_call as (

    select distinct
       # mmsi,
         port_at_call,
         port_type,
       case when port_type = 'Anchorage' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)anch.*'),''),'')
            when port_type = 'Marina' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)marin.*'),''),'')
            when port_type = 'Canal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)canal.*'),''),'')
            when port_type = 'Offshore Terminal' then regexp_replace(port_at_call, coalesce(regexp_extract(port_at_call,'(?i)terminal.*'),''),'')
             else port_at_call end as port
       #concat(port_at_call,'-',port_at_call_country) as port

    from source_vessel_tracking_events
),

 vessel_origin_destination_ports as (

    select distinct
        mmsi,
        destination_port,
        voyage_origin_port,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,


    from source_vessel_tracking_events 
),

vessel_ports_all as (
    
    select 
        mmsi,
        vessel_name,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        vessel_name,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,
        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type


    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        vessel_name,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port_at_call end as port
        country_code,
        from vessel_ports_all
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:47:20.674406 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "country_code" at [88:9]')
[0m14:47:21.759183 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:39191b45-6764-453d-bb20-a876c32bd2ff&page=queryresults
[0m14:47:21.760479 [debug] [Thread-1 (]: finished collecting timing info
[0m14:47:21.761993 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got identifier "country_code" at [88:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:47:21.762765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c243a25-8278-4ff1-924e-f3b10e5450d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646c4563b0>]}
[0m14:47:21.763356 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 2.98s]
[0m14:47:21.763781 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:47:21.765271 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:47:21.765808 [info ] [MainThread]: 
[0m14:47:21.766112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m14:47:21.766384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:21.766530 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:47:21.775233 [info ] [MainThread]: 
[0m14:47:21.775615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:47:21.775940 [info ] [MainThread]: 
[0m14:47:21.776218 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:47:21.776490 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "country_code" at [88:9]
[0m14:47:21.776751 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:47:21.777064 [info ] [MainThread]: 
[0m14:47:21.777429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:47:21.777829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d4b7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d743220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646d4df760>]}
[0m14:47:21.778109 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:52:07.286218 | d01f1ef3-5bfb-4d5e-b624-f90f9547863d ==============================
[0m14:52:07.286229 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:52:07.286594 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:52:07.286822 [debug] [MainThread]: Tracking: tracking
[0m14:52:07.288314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e54276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e5427220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e5426020>]}
[0m14:52:07.335696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:07.336064 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:52:07.349530 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:52:07.378041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd01f1ef3-5bfb-4d5e-b624-f90f9547863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e520a3e0>]}
[0m14:52:07.385440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd01f1ef3-5bfb-4d5e-b624-f90f9547863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e88e6140>]}
[0m14:52:07.385734 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:52:07.385978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01f1ef3-5bfb-4d5e-b624-f90f9547863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e51b5cf0>]}
[0m14:52:07.386959 [info ] [MainThread]: 
[0m14:52:07.387566 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:52:07.388480 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:52:07.388787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:09.422275 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:52:09.422950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:10.678470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01f1ef3-5bfb-4d5e-b624-f90f9547863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e51c3fd0>]}
[0m14:52:10.680354 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:52:10.681229 [info ] [MainThread]: 
[0m14:52:10.688008 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:52:10.688390 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:52:10.689159 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:52:10.689356 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:52:10.689537 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:52:10.695146 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:52:10.695629 [debug] [Thread-1 (]: finished collecting timing info
[0m14:52:10.695875 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:52:10.723069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:11.968953 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:52:11.969397 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        vessel_name,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        vessel_name,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        vessel_name,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port_at_call end as port,
        country_code

        from vessel_ports_all
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m14:52:12.452267 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).')
[0m14:52:13.799233 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:03d3f862-8732-49a9-9af1-381023bf6c75&page=queryresults
[0m14:52:13.800565 [debug] [Thread-1 (]: finished collecting timing info
[0m14:52:13.802097 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:52:13.802878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd01f1ef3-5bfb-4d5e-b624-f90f9547863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e4301ba0>]}
[0m14:52:13.803871 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.11s]
[0m14:52:13.805081 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:52:13.808721 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:52:13.810289 [info ] [MainThread]: 
[0m14:52:13.811173 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m14:52:13.811946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:13.812362 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:52:13.832956 [info ] [MainThread]: 
[0m14:52:13.833764 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:13.834542 [info ] [MainThread]: 
[0m14:52:13.835282 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:52:13.835999 [error] [MainThread]:   Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).
[0m14:52:13.836620 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:52:13.837239 [info ] [MainThread]: 
[0m14:52:13.837705 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:52:13.838530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e51c3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e521c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e51d9690>]}
[0m14:52:13.839105 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:55:01.785859 | a7de196d-c8c3-4d95-9b29-982212354aec ==============================
[0m14:55:01.785869 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:55:01.786217 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:55:01.786374 [debug] [MainThread]: Tracking: tracking
[0m14:55:01.787885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b083baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b083bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b083bf10>]}
[0m14:55:01.836093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:01.836447 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:55:01.850314 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:55:01.879184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7de196d-c8c3-4d95-9b29-982212354aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b0068e20>]}
[0m14:55:01.886341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7de196d-c8c3-4d95-9b29-982212354aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b05b33a0>]}
[0m14:55:01.886634 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:55:01.886986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7de196d-c8c3-4d95-9b29-982212354aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b05c9870>]}
[0m14:55:01.888175 [info ] [MainThread]: 
[0m14:55:01.888817 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:55:01.889752 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:55:01.889924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:03.518013 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:55:03.518879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:04.812053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7de196d-c8c3-4d95-9b29-982212354aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b05dbb20>]}
[0m14:55:04.813842 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:55:04.814748 [info ] [MainThread]: 
[0m14:55:04.821584 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:55:04.821969 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:55:04.822739 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:55:04.822945 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:55:04.824039 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:55:04.828390 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:55:04.828838 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:04.829058 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:55:04.849149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:06.159267 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:55:06.159704 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        vessel_name,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        vessel_name,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        vessel_name,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port_at_call end as port,
        country_code

        from vessel_ports_all
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:55:07.549210 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: vessel_name at [20:9]')
[0m14:55:09.862596 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:0a1472fd-930f-4fb0-a632-3f27a03316ad&page=queryresults
[0m14:55:09.863977 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:09.865570 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: vessel_name at [20:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:55:09.866324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7de196d-c8c3-4d95-9b29-982212354aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ab50ac80>]}
[0m14:55:09.867358 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.04s]
[0m14:55:09.868679 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:55:09.872266 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:55:09.873796 [info ] [MainThread]: 
[0m14:55:09.874646 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.99 seconds (7.99s).
[0m14:55:09.875467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:09.875916 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:55:09.883772 [info ] [MainThread]: 
[0m14:55:09.884101 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:09.884396 [info ] [MainThread]: 
[0m14:55:09.884648 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:55:09.884896 [error] [MainThread]:   Unrecognized name: vessel_name at [20:9]
[0m14:55:09.885129 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:55:09.885367 [info ] [MainThread]: 
[0m14:55:09.885605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:55:09.885973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b05dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b08383d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b05ec070>]}
[0m14:55:09.886232 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:56:04.664442 | 5134256e-7cdc-47cc-92ee-228eb401aa97 ==============================
[0m14:56:04.664453 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:56:04.664795 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:56:04.664943 [debug] [MainThread]: Tracking: tracking
[0m14:56:04.666230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b53f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b53f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b53e0e0>]}
[0m14:56:04.716410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:04.716769 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:56:04.730393 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:56:04.759966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5134256e-7cdc-47cc-92ee-228eb401aa97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b3224d0>]}
[0m14:56:04.766933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5134256e-7cdc-47cc-92ee-228eb401aa97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018e9f21d0>]}
[0m14:56:04.767249 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:56:04.767526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5134256e-7cdc-47cc-92ee-228eb401aa97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b2cdde0>]}
[0m14:56:04.768463 [info ] [MainThread]: 
[0m14:56:04.769024 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:56:04.769913 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:56:04.770210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:06.632576 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:56:06.633439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:08.028951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5134256e-7cdc-47cc-92ee-228eb401aa97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b2dbf40>]}
[0m14:56:08.030842 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:56:08.031738 [info ] [MainThread]: 
[0m14:56:08.046723 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:56:08.047737 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:56:08.049632 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:56:08.050141 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:56:08.050606 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:56:08.063847 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:56:08.064998 [debug] [Thread-1 (]: finished collecting timing info
[0m14:56:08.065554 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:56:08.096498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:09.512594 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:56:09.513065 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port_at_call end as port,
        country_code

        from vessel_ports_all
),

vessel_tracked_events_origin as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as origin_port_time_stamp,
        time_at_port,
        destination_port,
        destination_port_country,
        load_condition,
        in_transit_port_calls
    
    from source_vessel_tracking_events 
    
    where port_call_type = 'DEPARTURE' 

),

vessel_tracked_events_destination as (

    select
        mmsi,
        port_type,
        port_at_call,
        port_at_call_country,
        ata_atd as destination_port_time_stamp,
        voyage_origin_port,
        origin_port_country,
        voyage_time_underway,
        voyage_distance_travelled,
        leg_start_port_anch,
        leg_time_underway,
        leg_distance_travelled
        load_condition,
        in_transit_port_calls
        
    from source_vessel_tracking_events 
    
    where port_call_type = 'ARRIVAL' 

),


vessel_tracked_events_joined as (

    select  
        a.port_type,
        a.port_at_call,
        a.port_at_call_country,
        a.origin_port_time_stamp,
        a.time_at_port,
        a.destination_port,
        a.destination_port_country,
        a.load_condition,
        b.* 

    from vessel_tracked_events_origin a
    right join vessel_tracked_events_destination b
    on a.mmsi = b.mmsi

),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:56:10.842150 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: port_at_call at [51:20]')
[0m14:56:12.583437 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:4c941b8b-f391-428c-af06-f1df54b9132a&page=queryresults
[0m14:56:12.584747 [debug] [Thread-1 (]: finished collecting timing info
[0m14:56:12.586298 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: port_at_call at [51:20]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:56:12.587087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5134256e-7cdc-47cc-92ee-228eb401aa97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018a41a9b0>]}
[0m14:56:12.587828 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 4.54s]
[0m14:56:12.588278 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:56:12.589725 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:56:12.590334 [info ] [MainThread]: 
[0m14:56:12.590675 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m14:56:12.591014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:12.591179 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:56:12.599344 [info ] [MainThread]: 
[0m14:56:12.599701 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:12.600026 [info ] [MainThread]: 
[0m14:56:12.600278 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:56:12.600525 [error] [MainThread]:   Unrecognized name: port_at_call at [51:20]
[0m14:56:12.600759 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:56:12.601036 [info ] [MainThread]: 
[0m14:56:12.601278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:12.601599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b3220e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b2b72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018b2f0dc0>]}
[0m14:56:12.601839 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 14:57:40.989811 | 93c200d3-0114-4e2e-ba5e-1c7099e13a7a ==============================
[0m14:57:40.989920 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:57:40.991220 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:57:40.991612 [debug] [MainThread]: Tracking: tracking
[0m14:57:40.993791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5db437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5db43310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5db43850>]}
[0m14:57:41.085243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:41.085831 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m14:57:41.101380 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m14:57:41.130084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c200d3-0114-4e2e-ba5e-1c7099e13a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c76caf0>]}
[0m14:57:41.138012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c200d3-0114-4e2e-ba5e-1c7099e13a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5d8b7e80>]}
[0m14:57:41.138306 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:57:41.138552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c200d3-0114-4e2e-ba5e-1c7099e13a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5d8cd540>]}
[0m14:57:41.139531 [info ] [MainThread]: 
[0m14:57:41.140117 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:57:41.141039 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m14:57:41.141219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:53.241184 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m14:57:53.242069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:54.458762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c200d3-0114-4e2e-ba5e-1c7099e13a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5db43310>]}
[0m14:57:54.460593 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m14:57:54.461477 [info ] [MainThread]: 
[0m14:57:54.468331 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:57:54.468672 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m14:57:54.469334 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:57:54.469511 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:57:54.470469 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:57:54.474220 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:57:54.474634 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:54.474860 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:57:54.494330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:55.706697 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m14:57:55.707143 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port_at_call end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m14:57:57.172102 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: port_at_call at [51:20]')
[0m14:58:03.987411 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:e8593361-0bbf-4445-9fae-bff4a68b781b&page=queryresults
[0m14:58:03.988898 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:03.989460 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Unrecognized name: port_at_call at [51:20]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:58:03.989728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c200d3-0114-4e2e-ba5e-1c7099e13a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c65bfd0>]}
[0m14:58:03.990109 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 9.52s]
[0m14:58:03.990569 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m14:58:03.992137 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:58:03.992741 [info ] [MainThread]: 
[0m14:58:03.993078 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.85 seconds (22.85s).
[0m14:58:03.993388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:03.993560 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m14:58:04.002006 [info ] [MainThread]: 
[0m14:58:04.002358 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:04.002814 [info ] [MainThread]: 
[0m14:58:04.003076 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m14:58:04.003329 [error] [MainThread]:   Unrecognized name: port_at_call at [51:20]
[0m14:58:04.003569 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m14:58:04.003813 [info ] [MainThread]: 
[0m14:58:04.004055 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:58:04.004380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5db40520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5db412d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5d8dfdc0>]}
[0m14:58:04.004628 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:00:19.468823 | 9a67efda-9c8b-490c-9a00-25dd5eb0833b ==============================
[0m15:00:19.468834 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:00:19.469202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:00:19.469369 [debug] [MainThread]: Tracking: tracking
[0m15:00:19.470672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce503f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce503f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce503de70>]}
[0m15:00:19.517988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:19.518343 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:00:19.530903 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:00:19.557914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a67efda-9c8b-490c-9a00-25dd5eb0833b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce40710f0>]}
[0m15:00:19.565021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a67efda-9c8b-490c-9a00-25dd5eb0833b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4db7220>]}
[0m15:00:19.565347 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:00:19.565610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a67efda-9c8b-490c-9a00-25dd5eb0833b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4dcdb40>]}
[0m15:00:19.566508 [info ] [MainThread]: 
[0m15:00:19.567150 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:00:19.568023 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:00:19.568341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:21.966991 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:00:21.967625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:23.398477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a67efda-9c8b-490c-9a00-25dd5eb0833b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4ddfc70>]}
[0m15:00:23.400263 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:00:23.401116 [info ] [MainThread]: 
[0m15:00:23.408189 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:00:23.408540 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:00:23.409268 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:00:23.409468 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:00:23.409649 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:00:23.414486 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:00:23.414888 [debug] [Thread-1 (]: finished collecting timing info
[0m15:00:23.415076 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:00:23.432670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:24.927988 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:00:24.928433 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m15:00:33.004728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:2de510d7-5616-4eb1-973f-58da4406c3b3:US&page=queryresults
[0m15:00:33.026366 [debug] [Thread-1 (]: finished collecting timing info
[0m15:00:33.026999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a67efda-9c8b-490c-9a00-25dd5eb0833b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4070bb0>]}
[0m15:00:33.027361 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 9.62s]
[0m15:00:33.027792 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:00:33.029290 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:00:33.029804 [info ] [MainThread]: 
[0m15:00:33.030085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.46 seconds (13.46s).
[0m15:00:33.030342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:33.030478 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:00:33.038067 [info ] [MainThread]: 
[0m15:00:33.038378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:33.038676 [info ] [MainThread]: 
[0m15:00:33.038940 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:00:33.039407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4ddffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4df0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4df1900>]}
[0m15:00:33.039666 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:01:04.429311 | 61d01730-63d8-49b6-8ffa-9bc4147de818 ==============================
[0m15:01:04.429322 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:01:04.429696 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:01:04.429870 [debug] [MainThread]: Tracking: tracking
[0m15:01:04.431253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3ca276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3ca27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3ca25ed0>]}
[0m15:01:04.477543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:04.477894 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:01:04.490646 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:01:04.517898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61d01730-63d8-49b6-8ffa-9bc4147de818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c0610c0>]}
[0m15:01:04.525360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61d01730-63d8-49b6-8ffa-9bc4147de818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a40560be0>]}
[0m15:01:04.525690 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:01:04.525940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d01730-63d8-49b6-8ffa-9bc4147de818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c7b5ba0>]}
[0m15:01:04.526922 [info ] [MainThread]: 
[0m15:01:04.527537 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:01:04.528480 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:01:04.528816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:06.367760 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:01:06.368650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:07.737057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d01730-63d8-49b6-8ffa-9bc4147de818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c7c7e20>]}
[0m15:01:07.738914 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:01:07.739775 [info ] [MainThread]: 
[0m15:01:07.746623 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:01:07.746952 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:01:07.747623 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:01:07.747822 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:01:07.748004 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:01:07.752818 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:01:07.753212 [debug] [Thread-1 (]: finished collecting timing info
[0m15:01:07.753400 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:01:07.770808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:09.300606 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:01:09.301042 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:01:10.095868 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).')
[0m15:01:10.913511 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:78adf84c-37a2-4653-9e5d-af745d7a99c3&page=queryresults
[0m15:01:10.915220 [debug] [Thread-1 (]: finished collecting timing info
[0m15:01:10.916777 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:01:10.917049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61d01730-63d8-49b6-8ffa-9bc4147de818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c1074f0>]}
[0m15:01:10.917410 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.17s]
[0m15:01:10.917845 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:01:10.919322 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:01:10.919868 [info ] [MainThread]: 
[0m15:01:10.920163 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.39 seconds (6.39s).
[0m15:01:10.920435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:10.920580 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:01:10.928598 [info ] [MainThread]: 
[0m15:01:10.928933 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:10.929226 [info ] [MainThread]: 
[0m15:01:10.929470 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:01:10.929710 [error] [MainThread]:   Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).
[0m15:01:10.929940 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:01:10.930171 [info ] [MainThread]: 
[0m15:01:10.930404 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:01:10.930742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c8206a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c8205b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3c7d8190>]}
[0m15:01:10.931002 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:03:26.046912 | fc686e28-28c7-41c2-adf0-4fa19eee0bee ==============================
[0m15:03:26.046922 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:03:26.047295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:26.047458 [debug] [MainThread]: Tracking: tracking
[0m15:03:26.048729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaf03ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaf03beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaf03be50>]}
[0m15:03:26.095428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:26.095802 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:03:26.108603 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:03:26.136549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc686e28-28c7-41c2-adf0-4fa19eee0bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aade6cd30>]}
[0m15:03:26.143611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc686e28-28c7-41c2-adf0-4fa19eee0bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaedb33a0>]}
[0m15:03:26.143886 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:03:26.144128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc686e28-28c7-41c2-adf0-4fa19eee0bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaedc9780>]}
[0m15:03:26.145046 [info ] [MainThread]: 
[0m15:03:26.145665 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:03:26.146486 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:03:26.146656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:28.144259 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:03:28.144888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:29.646317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc686e28-28c7-41c2-adf0-4fa19eee0bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaeddbbe0>]}
[0m15:03:29.648115 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:03:29.648966 [info ] [MainThread]: 
[0m15:03:29.655952 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:03:29.656277 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:03:29.656934 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:03:29.657111 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:03:29.658049 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:03:29.662092 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:03:29.662478 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:29.662749 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:03:29.680334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:31.227358 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:03:31.227797 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_

)

select * from final
    );
  
[0m15:03:31.813410 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "vessel_ports_" must be qualified with a dataset (e.g. dataset.table).')
[0m15:03:32.837259 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:d739887f-745c-4e86-94c2-450c81a38a28&page=queryresults
[0m15:03:32.838559 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:32.840142 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Table "vessel_ports_" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:03:32.840452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc686e28-28c7-41c2-adf0-4fa19eee0bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aadd56cb0>]}
[0m15:03:32.840810 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.18s]
[0m15:03:32.841236 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:03:32.842778 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:03:32.843359 [info ] [MainThread]: 
[0m15:03:32.843686 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m15:03:32.843982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:32.844149 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:03:32.852658 [info ] [MainThread]: 
[0m15:03:32.852978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:32.853290 [info ] [MainThread]: 
[0m15:03:32.853563 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:03:32.853833 [error] [MainThread]:   Table "vessel_ports_" must be qualified with a dataset (e.g. dataset.table).
[0m15:03:32.854087 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:03:32.854345 [info ] [MainThread]: 
[0m15:03:32.854604 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:03:32.854972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaedb3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaeddbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aaedec0d0>]}
[0m15:03:32.855245 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:04:09.996035 | 47285527-9881-4e9f-b958-7020371105f3 ==============================
[0m15:04:09.996045 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:04:09.996393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:04:09.996562 [debug] [MainThread]: Tracking: tracking
[0m15:04:09.998011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265613fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265613f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265613f760>]}
[0m15:04:10.044426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:10.044781 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:04:10.057695 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:04:10.084997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47285527-9881-4e9f-b958-7020371105f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654f6cf40>]}
[0m15:04:10.091751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47285527-9881-4e9f-b958-7020371105f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2655eb73a0>]}
[0m15:04:10.092101 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:04:10.092368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47285527-9881-4e9f-b958-7020371105f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2655ecd990>]}
[0m15:04:10.093250 [info ] [MainThread]: 
[0m15:04:10.093816 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:04:10.094666 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:04:10.095076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.856056 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:04:11.856883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:13.153601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47285527-9881-4e9f-b958-7020371105f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2655edfb20>]}
[0m15:04:13.155455 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:04:13.156338 [info ] [MainThread]: 
[0m15:04:13.163298 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:04:13.163615 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:04:13.164280 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:04:13.164457 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:04:13.164650 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:04:13.169400 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:04:13.169798 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:13.169989 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:04:13.187269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:14.646179 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:04:14.646633 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_all

)

select * from final
    );
  
[0m15:04:22.297378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:6eaabba1-75b2-4f1d-8056-ac3e5185b1c8:US&page=queryresults
[0m15:04:22.318961 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:22.319582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47285527-9881-4e9f-b958-7020371105f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654f6cbe0>]}
[0m15:04:22.319954 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 9.16s]
[0m15:04:22.320392 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:04:22.321909 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:04:22.322424 [info ] [MainThread]: 
[0m15:04:22.322719 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.23 seconds (12.23s).
[0m15:04:22.322987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:22.323126 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:04:22.330645 [info ] [MainThread]: 
[0m15:04:22.330986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:22.331290 [info ] [MainThread]: 
[0m15:04:22.331580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:04:22.331965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2655edfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2655ef0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2655ef0c10>]}
[0m15:04:22.332237 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:06:31.873878 | 8d3353c7-df13-480f-9294-76ab800a45af ==============================
[0m15:06:31.873889 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:06:31.874231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:06:31.874394 [debug] [MainThread]: Tracking: tracking
[0m15:06:31.875778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74bc3b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74bc3b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74bc3a020>]}
[0m15:06:31.921661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:31.922015 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:06:31.935047 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:06:31.962305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d3353c7-df13-480f-9294-76ab800a45af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ba1e3e0>]}
[0m15:06:31.969298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d3353c7-df13-480f-9294-76ab800a45af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74f0e0af0>]}
[0m15:06:31.969600 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:06:31.969850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d3353c7-df13-480f-9294-76ab800a45af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b9c9cf0>]}
[0m15:06:31.970852 [info ] [MainThread]: 
[0m15:06:31.971416 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:06:31.972272 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:06:31.972439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:34.298205 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:06:34.299122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:35.623176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d3353c7-df13-480f-9294-76ab800a45af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b9dbfd0>]}
[0m15:06:35.624970 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:06:35.625831 [info ] [MainThread]: 
[0m15:06:35.632755 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:06:35.633114 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:06:35.633861 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:06:35.634062 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:06:35.634246 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:06:35.639259 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:06:35.639653 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:35.639844 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:06:35.657356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:37.185457 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:06:37.185902 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interation as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:06:37.771615 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).')
[0m15:06:38.606528 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:89530c93-278c-43a8-ba57-3829ab1284b4&page=queryresults
[0m15:06:38.607829 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:38.609351 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:06:38.609753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3353c7-df13-480f-9294-76ab800a45af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ab16170>]}
[0m15:06:38.610115 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 2.98s]
[0m15:06:38.610537 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:06:38.612153 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:06:38.612775 [info ] [MainThread]: 
[0m15:06:38.613101 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m15:06:38.613405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:38.613577 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:06:38.622272 [info ] [MainThread]: 
[0m15:06:38.622593 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:06:38.622905 [info ] [MainThread]: 
[0m15:06:38.623154 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:06:38.623400 [error] [MainThread]:   Table "vessel_ports_interaction" must be qualified with a dataset (e.g. dataset.table).
[0m15:06:38.623757 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:06:38.624170 [info ] [MainThread]: 
[0m15:06:38.624714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:06:38.625102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b9b32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ba1e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b9ec0d0>]}
[0m15:06:38.625355 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:09:15.651503 | f901be99-bdc2-4730-ab0f-70a6d6aee3f0 ==============================
[0m15:09:15.651513 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:09:15.651875 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:09:15.652025 [debug] [MainThread]: Tracking: tracking
[0m15:09:15.653321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209ce3bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209ce3bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209ce3bee0>]}
[0m15:09:15.700066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:15.700419 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:09:15.713276 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:09:15.740720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f901be99-bdc2-4730-ab0f-70a6d6aee3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209c070df0>]}
[0m15:09:15.748193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f901be99-bdc2-4730-ab0f-70a6d6aee3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cbb33a0>]}
[0m15:09:15.748478 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:09:15.748728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f901be99-bdc2-4730-ab0f-70a6d6aee3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cbc9840>]}
[0m15:09:15.749656 [info ] [MainThread]: 
[0m15:09:15.750269 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:09:15.751138 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:09:15.751466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:18.439895 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:09:18.440542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:20.588388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f901be99-bdc2-4730-ab0f-70a6d6aee3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cbdbbb0>]}
[0m15:09:20.590179 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:09:20.591067 [info ] [MainThread]: 
[0m15:09:20.597849 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:09:20.598215 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:09:20.598982 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:09:20.599260 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:09:20.599450 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:09:20.604295 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:09:20.604692 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:20.604885 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:09:20.622543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:22.662941 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:09:22.663385 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports

)

select * from final
    );
  
[0m15:09:24.441745 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name port at [10:8]')
[0m15:09:25.852339 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:acdb8ac9-74da-40f0-8c99-b43f8866ae2e&page=queryresults
[0m15:09:25.853603 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:25.855024 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  CREATE TABLE has columns with duplicate name port at [10:8]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:09:25.855305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f901be99-bdc2-4730-ab0f-70a6d6aee3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2097b13f10>]}
[0m15:09:25.855676 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.26s]
[0m15:09:25.856098 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:09:25.857710 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:09:25.858321 [info ] [MainThread]: 
[0m15:09:25.858651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m15:09:25.858968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:25.859127 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:09:25.867439 [info ] [MainThread]: 
[0m15:09:25.867775 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:25.868096 [info ] [MainThread]: 
[0m15:09:25.868349 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:09:25.868595 [error] [MainThread]:   CREATE TABLE has columns with duplicate name port at [10:8]
[0m15:09:25.868833 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:09:25.869075 [info ] [MainThread]: 
[0m15:09:25.869316 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:25.869637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cbdbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cbdbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cbece50>]}
[0m15:09:25.869877 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:10:06.523497 | d387f73a-14ed-4e8a-95d6-43bf9a202502 ==============================
[0m15:10:06.523508 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:10:06.523882 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:10:06.524045 [debug] [MainThread]: Tracking: tracking
[0m15:10:06.525354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6d027700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6d027250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6d026110>]}
[0m15:10:06.572158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:06.572509 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:10:06.585431 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:10:06.612820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd387f73a-14ed-4e8a-95d6-43bf9a202502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6ce0a500>]}
[0m15:10:06.619474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd387f73a-14ed-4e8a-95d6-43bf9a202502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec704e6140>]}
[0m15:10:06.619762 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:10:06.620010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd387f73a-14ed-4e8a-95d6-43bf9a202502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6cdb5e10>]}
[0m15:10:06.621005 [info ] [MainThread]: 
[0m15:10:06.621635 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:10:06.622486 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:10:06.622775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:09.128433 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:10:09.129325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:10.559616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd387f73a-14ed-4e8a-95d6-43bf9a202502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6ce0a530>]}
[0m15:10:10.561426 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:10:10.562286 [info ] [MainThread]: 
[0m15:10:10.569168 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:10:10.569520 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:10:10.570255 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:10:10.570455 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:10:10.570638 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:10:10.575416 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:10:10.575784 [debug] [Thread-1 (]: finished collecting timing info
[0m15:10:10.575973 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:10:10.593784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:11.858653 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:10:11.859727 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

ships_ports as (

    select distinct
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports

)

select * from final
    );
  
[0m15:10:12.268148 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "vessel_ports" must be qualified with a dataset (e.g. dataset.table).')
[0m15:10:13.218552 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:b66b6dc1-7a5d-4cf4-806c-81ff794ffd76&page=queryresults
[0m15:10:13.219861 [debug] [Thread-1 (]: finished collecting timing info
[0m15:10:13.221229 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Table "vessel_ports" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:10:13.221493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd387f73a-14ed-4e8a-95d6-43bf9a202502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6c103be0>]}
[0m15:10:13.221856 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 2.65s]
[0m15:10:13.222280 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:10:13.223698 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:10:13.224294 [info ] [MainThread]: 
[0m15:10:13.224627 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m15:10:13.224926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:13.225087 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:10:13.233900 [info ] [MainThread]: 
[0m15:10:13.234278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:10:13.234630 [info ] [MainThread]: 
[0m15:10:13.234942 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:10:13.235237 [error] [MainThread]:   Table "vessel_ports" must be qualified with a dataset (e.g. dataset.table).
[0m15:10:13.235515 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:10:13.235803 [info ] [MainThread]: 
[0m15:10:13.236310 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:10:13.236909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6ce0a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6cd9f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6cdd8d90>]}
[0m15:10:13.237200 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:12:25.817437 | ba8601d3-00d5-4d77-b1df-768bf0ec336c ==============================
[0m15:12:25.817447 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:12:25.817787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:12:25.817932 [debug] [MainThread]: Tracking: tracking
[0m15:12:25.819299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173eb3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173eb3f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173eb3f760>]}
[0m15:12:25.870513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:12:25.870939 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:12:25.883910 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:12:25.911254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba8601d3-00d5-4d77-b1df-768bf0ec336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173d964a60>]}
[0m15:12:25.918765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba8601d3-00d5-4d77-b1df-768bf0ec336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173e8b3df0>]}
[0m15:12:25.919095 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:12:25.919372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba8601d3-00d5-4d77-b1df-768bf0ec336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173e8c94b0>]}
[0m15:12:25.920429 [info ] [MainThread]: 
[0m15:12:25.921231 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:12:25.922165 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:12:25.922485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:28.699289 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:12:28.699926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:30.017343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba8601d3-00d5-4d77-b1df-768bf0ec336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173eb3c520>]}
[0m15:12:30.018019 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:12:30.018330 [info ] [MainThread]: 
[0m15:12:30.024169 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:12:30.024526 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:12:30.025268 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:12:30.025469 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:12:30.025654 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:12:30.030904 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:12:30.031310 [debug] [Thread-1 (]: finished collecting timing info
[0m15:12:30.031504 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:12:30.048886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:32.102699 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:12:32.103151 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

ships_ports as (

    select *
/*
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code
*/
        from vessel_ports_all
),

final as (

    select * from ships_ports

)

select * from final
    );
  
[0m15:12:41.876152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:c40eadeb-43e3-4de9-b8a6-0c7bde37d265:US&page=queryresults
[0m15:12:41.919752 [debug] [Thread-1 (]: finished collecting timing info
[0m15:12:41.920513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8601d3-00d5-4d77-b1df-768bf0ec336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173d966140>]}
[0m15:12:41.920942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 11.90s]
[0m15:12:41.921400 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:12:41.923036 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:12:41.923572 [info ] [MainThread]: 
[0m15:12:41.923860 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.00 seconds (16.00s).
[0m15:12:41.924126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:41.924268 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:12:41.931445 [info ] [MainThread]: 
[0m15:12:41.931741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:41.932031 [info ] [MainThread]: 
[0m15:12:41.932267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:12:41.932721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173e8ec520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173e8dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173e8dbe20>]}
[0m15:12:41.932983 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:13:24.461401 | 60e6b9e1-fbca-4f58-a082-f714666fb321 ==============================
[0m15:13:24.461411 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:13:24.461769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:13:24.461926 [debug] [MainThread]: Tracking: tracking
[0m15:13:24.463277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd62b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd62b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd62b850>]}
[0m15:13:24.508983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:24.509330 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:13:24.522207 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:13:24.549431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e6b9e1-fbca-4f58-a082-f714666fb321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bc458af0>]}
[0m15:13:24.556185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e6b9e1-fbca-4f58-a082-f714666fb321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd39fe80>]}
[0m15:13:24.556457 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:13:24.556711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e6b9e1-fbca-4f58-a082-f714666fb321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd3b5540>]}
[0m15:13:24.557594 [info ] [MainThread]: 
[0m15:13:24.558172 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:13:24.559072 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:13:24.559394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:26.811930 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:13:26.812831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:28.824386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e6b9e1-fbca-4f58-a082-f714666fb321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd62a7d0>]}
[0m15:13:28.826185 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:13:28.827100 [info ] [MainThread]: 
[0m15:13:28.833906 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:13:28.834223 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:13:28.834895 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:13:28.835073 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:13:28.835234 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:13:28.839953 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:13:28.840323 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:28.840510 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:13:28.857605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:30.868574 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:13:30.869022 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select *
/*
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code
*/
        from vessel_ports_all
),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:13:38.636279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:e862e336-c300-4881-a92a-ff21a109e1c2:US&page=queryresults
[0m15:13:38.658043 [debug] [Thread-1 (]: finished collecting timing info
[0m15:13:38.658659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60e6b9e1-fbca-4f58-a082-f714666fb321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bc4589a0>]}
[0m15:13:38.659031 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 9.82s]
[0m15:13:38.659464 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:13:38.660896 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:13:38.661410 [info ] [MainThread]: 
[0m15:13:38.661687 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m15:13:38.661937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:38.662073 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:13:38.669403 [info ] [MainThread]: 
[0m15:13:38.669709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:38.670010 [info ] [MainThread]: 
[0m15:13:38.670253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:38.670569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd3d80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd3c7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93bd3c7790>]}
[0m15:13:38.670824 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:14:13.643438 | ce89146c-2b55-4653-9320-2861203d8529 ==============================
[0m15:14:13.643448 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:14:13.643817 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:14:13.644002 [debug] [MainThread]: Tracking: tracking
[0m15:14:13.645350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1ab3f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1ab3fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1ab3fdc0>]}
[0m15:14:13.693200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:13.693725 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:14:13.706582 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:14:13.733563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce89146c-2b55-4653-9320-2861203d8529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc19968ca0>]}
[0m15:14:13.740171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce89146c-2b55-4653-9320-2861203d8529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1a8b34f0>]}
[0m15:14:13.740459 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:14:13.740705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce89146c-2b55-4653-9320-2861203d8529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1a8c96f0>]}
[0m15:14:13.741635 [info ] [MainThread]: 
[0m15:14:13.742239 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:14:13.743125 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:14:13.743430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:15.913051 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:14:15.913906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:17.964344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce89146c-2b55-4653-9320-2861203d8529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1a8dbac0>]}
[0m15:14:17.966626 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:14:17.967602 [info ] [MainThread]: 
[0m15:14:17.974064 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:17.974395 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:14:17.975099 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:14:17.975281 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:17.975447 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:17.980091 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:14:17.980486 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:17.980676 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:17.998260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:19.519989 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:14:19.520496 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select *
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:14:20.210963 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "mmsi" at [45:9]')
[0m15:14:20.722184 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:7cd3709c-dc87-48e9-855d-f956a2f43c1e&page=queryresults
[0m15:14:20.723501 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:20.725158 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got identifier "mmsi" at [45:9]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:14:20.725596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce89146c-2b55-4653-9320-2861203d8529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc19855ff0>]}
[0m15:14:20.725994 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 2.75s]
[0m15:14:20.726451 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:20.727985 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:14:20.728594 [info ] [MainThread]: 
[0m15:14:20.728943 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m15:14:20.729247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:20.729410 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:14:20.738462 [info ] [MainThread]: 
[0m15:14:20.738863 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:14:20.739201 [info ] [MainThread]: 
[0m15:14:20.739486 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:14:20.739768 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "mmsi" at [45:9]
[0m15:14:20.740044 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:14:20.740317 [info ] [MainThread]: 
[0m15:14:20.740587 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:14:20.740955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1a8b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1ab3c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1a8dbd00>]}
[0m15:14:20.741240 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:14:53.916199 | 7b4d6d3b-8ef0-486f-a472-dc43623f5c39 ==============================
[0m15:14:53.916209 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:14:53.916549 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:14:53.916712 [debug] [MainThread]: Tracking: tracking
[0m15:14:53.917991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc3c3fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc3c3f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc3c3f790>]}
[0m15:14:53.964119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:53.964476 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:14:53.980760 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:14:54.008425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b4d6d3b-8ef0-486f-a472-dc43623f5c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc2a70f70>]}
[0m15:14:54.014935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b4d6d3b-8ef0-486f-a472-dc43623f5c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc39b73a0>]}
[0m15:14:54.015219 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:14:54.015486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b4d6d3b-8ef0-486f-a472-dc43623f5c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc39cd9c0>]}
[0m15:14:54.016358 [info ] [MainThread]: 
[0m15:14:54.016928 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:14:54.017768 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:14:54.018058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:56.058972 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:14:56.059860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.475237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b4d6d3b-8ef0-486f-a472-dc43623f5c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc39dfac0>]}
[0m15:14:57.477021 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:14:57.478000 [info ] [MainThread]: 
[0m15:14:57.484616 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:57.484983 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:14:57.485726 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:14:57.485930 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:57.486109 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:57.491069 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:14:57.491512 [debug] [Thread-1 (]: finished collecting timing info
[0m15:14:57.491748 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:14:57.511436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.052317 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:14:59.052752 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:15:00.711105 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name port at [10:8]')
[0m15:15:02.809209 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:c9a700ce-f9b3-4cf3-81d2-9a1dfe1b39c4&page=queryresults
[0m15:15:02.810537 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:02.812093 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  CREATE TABLE has columns with duplicate name port at [10:8]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:15:02.812678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b4d6d3b-8ef0-486f-a472-dc43623f5c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc2956230>]}
[0m15:15:02.813043 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.33s]
[0m15:15:02.813481 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:15:02.815047 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:15:02.815596 [info ] [MainThread]: 
[0m15:15:02.815885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m15:15:02.816146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:02.816288 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:15:02.824467 [info ] [MainThread]: 
[0m15:15:02.824825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:02.825144 [info ] [MainThread]: 
[0m15:15:02.825395 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:15:02.825641 [error] [MainThread]:   CREATE TABLE has columns with duplicate name port at [10:8]
[0m15:15:02.825888 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:15:02.826152 [info ] [MainThread]: 
[0m15:15:02.826393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:02.826747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc3c3c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc3c3e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfc39f0e50>]}
[0m15:15:02.827009 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:16:00.860439 | 951e4785-ffa7-4a39-9bd4-c10e36af9b04 ==============================
[0m15:16:00.860449 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:16:00.860790 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:16:00.860937 [debug] [MainThread]: Tracking: tracking
[0m15:16:00.862234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0c276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0c27220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0c25d80>]}
[0m15:16:00.908693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:00.909040 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:16:00.921754 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:16:00.948905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '951e4785-ffa7-4a39-9bd4-c10e36af9b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0061030>]}
[0m15:16:00.955865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '951e4785-ffa7-4a39-9bd4-c10e36af9b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f099f3a0>]}
[0m15:16:00.956183 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:16:00.956474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '951e4785-ffa7-4a39-9bd4-c10e36af9b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f09b5a80>]}
[0m15:16:00.957408 [info ] [MainThread]: 
[0m15:16:00.958051 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:16:00.958971 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:16:00.959261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:03.022549 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:16:03.023109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:05.079490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '951e4785-ffa7-4a39-9bd4-c10e36af9b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f09c7e20>]}
[0m15:16:05.081323 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:16:05.082189 [info ] [MainThread]: 
[0m15:16:05.089035 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:16:05.089394 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:16:05.090137 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:16:05.090337 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:16:05.090521 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:16:05.095599 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:16:05.096000 [debug] [Thread-1 (]: finished collecting timing info
[0m15:16:05.096196 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:16:05.113476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:07.178208 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:16:07.178674 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:16:16.477984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:fd65ccc2-bb39-42dd-ad66-2f9459066b73:US&page=queryresults
[0m15:16:16.521311 [debug] [Thread-1 (]: finished collecting timing info
[0m15:16:16.522065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '951e4785-ffa7-4a39-9bd4-c10e36af9b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0060bb0>]}
[0m15:16:16.522512 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 11.43s]
[0m15:16:16.523072 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:16:16.524685 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:16:16.525229 [info ] [MainThread]: 
[0m15:16:16.525519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.57 seconds (15.57s).
[0m15:16:16.525781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:16.525921 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:16:16.532924 [info ] [MainThread]: 
[0m15:16:16.533220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:16.533503 [info ] [MainThread]: 
[0m15:16:16.533865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:16.534186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f09c7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0a193c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f09d8340>]}
[0m15:16:16.534474 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:20:09.181801 | 526cabf7-e20d-426b-ba9c-9e1d089af10c ==============================
[0m15:20:09.181812 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:20:09.182162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:20:09.182312 [debug] [MainThread]: Tracking: tracking
[0m15:20:09.183748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff9b3fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff9b3fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff9b3fe20>]}
[0m15:20:09.230251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:09.230602 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:20:09.244020 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:20:09.272463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526cabf7-e20d-426b-ba9c-9e1d089af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff8964d00>]}
[0m15:20:09.279113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526cabf7-e20d-426b-ba9c-9e1d089af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff98b33a0>]}
[0m15:20:09.279537 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:20:09.279815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526cabf7-e20d-426b-ba9c-9e1d089af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff98c9750>]}
[0m15:20:09.280732 [info ] [MainThread]: 
[0m15:20:09.281376 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:09.282233 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:20:09.282404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:11.256351 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:20:11.257414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:12.458827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526cabf7-e20d-426b-ba9c-9e1d089af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff98dbc10>]}
[0m15:20:12.460691 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:20:12.461599 [info ] [MainThread]: 
[0m15:20:12.468678 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:20:12.469037 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:20:12.469720 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:20:12.469902 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:20:12.470067 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:20:12.474540 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:20:12.474970 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:12.475163 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:20:12.493069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:13.729972 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:20:13.730422 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        concat(port,'-',country_code) as unique_port

        from vessel_ports_all
),


final as (

    select * from vessel_ports_interaction

)

select * from final
    );
  
[0m15:20:28.647061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:f4fddeb7-8696-4549-8746-7ba9e84a0669:US&page=queryresults
[0m15:20:28.668906 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:28.669533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526cabf7-e20d-426b-ba9c-9e1d089af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff8964a00>]}
[0m15:20:28.669897 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (1.0m rows, 467.5 MB processed)[0m in 16.20s]
[0m15:20:28.670341 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:20:28.671725 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:28.672249 [info ] [MainThread]: 
[0m15:20:28.672531 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.39 seconds (19.39s).
[0m15:20:28.672787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:28.672923 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:20:28.680162 [info ] [MainThread]: 
[0m15:20:28.680503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:28.680822 [info ] [MainThread]: 
[0m15:20:28.681119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:28.681589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff98b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff98dbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff9b3ed70>]}
[0m15:20:28.681842 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:21:14.501258 | a1a81e88-e0ff-4cdd-b3c9-66a7447f8278 ==============================
[0m15:21:14.501268 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:21:14.501601 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:21:14.501746 [debug] [MainThread]: Tracking: tracking
[0m15:21:14.503083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a31927700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a31927250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a31926080>]}
[0m15:21:14.548750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:14.549111 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:21:14.562097 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:21:14.588905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a81e88-e0ff-4cdd-b3c9-66a7447f8278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a3170a470>]}
[0m15:21:14.595519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a81e88-e0ff-4cdd-b3c9-66a7447f8278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a34fccbe0>]}
[0m15:21:14.595877 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:21:14.596157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a81e88-e0ff-4cdd-b3c9-66a7447f8278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a316b5d80>]}
[0m15:21:14.597032 [info ] [MainThread]: 
[0m15:21:14.597700 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:21:14.598559 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:21:14.598892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:15.958617 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:21:15.959004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:17.070809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a81e88-e0ff-4cdd-b3c9-66a7447f8278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a316c3eb0>]}
[0m15:21:17.072604 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:21:17.073456 [info ] [MainThread]: 
[0m15:21:17.080106 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:21:17.080460 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:21:17.081201 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:21:17.081404 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:21:17.081589 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:21:17.086491 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:21:17.086924 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:17.087120 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:21:17.104535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:18.339190 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:21:18.339658 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        concat(port,'-',country_code) as unique_port

        from vessel_ports_all
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:21:25.237400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:215f2c34-13d4-4b3b-9051-2ca40a19b236:US&page=queryresults
[0m15:21:25.281895 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:25.282656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a81e88-e0ff-4cdd-b3c9-66a7447f8278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a30760d30>]}
[0m15:21:25.283109 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (64.6k rows, 467.5 MB processed)[0m in 8.20s]
[0m15:21:25.283634 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:21:25.285195 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:21:25.285729 [info ] [MainThread]: 
[0m15:21:25.286023 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m15:21:25.286294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:25.286437 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:21:25.293545 [info ] [MainThread]: 
[0m15:21:25.293849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:25.294192 [info ] [MainThread]: 
[0m15:21:25.294438 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:25.294767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a3170a080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a316b5d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a316d8d60>]}
[0m15:21:25.295009 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:37:09.680189 | e89eb0e4-3c72-40f6-83ff-134ecabcd181 ==============================
[0m15:37:09.680200 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:37:09.680736 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:37:09.680875 [debug] [MainThread]: Tracking: tracking
[0m15:37:09.682192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0573f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0573fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0573fbe0>]}
[0m15:37:09.750861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:09.751235 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:37:09.765074 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:37:09.792884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e89eb0e4-3c72-40f6-83ff-134ecabcd181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c04564b80>]}
[0m15:37:09.800411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e89eb0e4-3c72-40f6-83ff-134ecabcd181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c054b3f10>]}
[0m15:37:09.800705 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:37:09.800938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89eb0e4-3c72-40f6-83ff-134ecabcd181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c054c95d0>]}
[0m15:37:09.801858 [info ] [MainThread]: 
[0m15:37:09.802417 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:37:09.803368 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:37:09.803540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:12.382014 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:37:12.383030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:14.426344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89eb0e4-3c72-40f6-83ff-134ecabcd181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0573fc40>]}
[0m15:37:14.427065 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:37:14.427378 [info ] [MainThread]: 
[0m15:37:14.435054 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:37:14.435434 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:37:14.436185 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:37:14.436388 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:37:14.437437 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:37:14.442001 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:37:14.442500 [debug] [Thread-1 (]: finished collecting timing info
[0m15:37:14.442774 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:37:14.465761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:16.603436 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:37:16.604310 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        concat(port,'-',country_code) as unique_port

        from vessel_ports_interaction
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:37:24.256033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:fcbf4ec1-1053-4601-8edb-fced02a946ba:US&page=queryresults
[0m15:37:24.277577 [debug] [Thread-1 (]: finished collecting timing info
[0m15:37:24.278189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89eb0e4-3c72-40f6-83ff-134ecabcd181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c04564ac0>]}
[0m15:37:24.278551 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (85.6k rows, 467.5 MB processed)[0m in 9.84s]
[0m15:37:24.278996 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:37:24.280464 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:37:24.280983 [info ] [MainThread]: 
[0m15:37:24.281256 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.48 seconds (14.48s).
[0m15:37:24.281508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:24.281644 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:37:24.289243 [info ] [MainThread]: 
[0m15:37:24.289553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:24.289855 [info ] [MainThread]: 
[0m15:37:24.290097 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:37:24.290419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c054ec1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0573c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0573c4f0>]}
[0m15:37:24.290675 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:38:55.805296 | cca822ab-d2a1-4466-8de9-d4edd74f72a9 ==============================
[0m15:38:55.805306 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:38:55.805675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:55.805884 [debug] [MainThread]: Tracking: tracking
[0m15:38:55.807353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced83bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced83b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced83b760>]}
[0m15:38:55.853198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:55.853554 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:38:55.866321 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:38:55.893765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cca822ab-d2a1-4466-8de9-d4edd74f72a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cec668f70>]}
[0m15:38:55.901208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cca822ab-d2a1-4466-8de9-d4edd74f72a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced5b33a0>]}
[0m15:38:55.901482 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:38:55.901751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca822ab-d2a1-4466-8de9-d4edd74f72a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced5c99c0>]}
[0m15:38:55.902631 [info ] [MainThread]: 
[0m15:38:55.903273 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:38:55.904130 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:38:55.904449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:57.236203 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:38:57.237027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:59.291816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca822ab-d2a1-4466-8de9-d4edd74f72a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced5dbac0>]}
[0m15:38:59.293669 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:38:59.294538 [info ] [MainThread]: 
[0m15:38:59.301595 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:38:59.301954 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:38:59.302728 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:38:59.302935 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:38:59.303119 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:38:59.308483 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:38:59.308975 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:59.309222 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:38:59.332277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:01.390872 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:39:01.391315 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(port,' - ',country_code) as unique_port

        from vessel_ports_interaction
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:39:09.730628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:ea279c16-aa2d-418e-af69-2bec374329ee:US&page=queryresults
[0m15:39:09.752470 [debug] [Thread-1 (]: finished collecting timing info
[0m15:39:09.753093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca822ab-d2a1-4466-8de9-d4edd74f72a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cec668c70>]}
[0m15:39:09.753458 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (122.1k rows, 467.5 MB processed)[0m in 10.45s]
[0m15:39:09.753899 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:39:09.755384 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:39:09.755909 [info ] [MainThread]: 
[0m15:39:09.756189 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.85 seconds (13.85s).
[0m15:39:09.756492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:09.756669 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:39:09.764409 [info ] [MainThread]: 
[0m15:39:09.764725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:09.765033 [info ] [MainThread]: 
[0m15:39:09.765275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:09.765631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced5dbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced5ece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ced5ecca0>]}
[0m15:39:09.765915 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:41:39.239343 | f629ab9b-f333-4622-bf8a-8841a5c38cd6 ==============================
[0m15:41:39.239352 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:41:39.239694 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:41:39.239859 [debug] [MainThread]: Tracking: tracking
[0m15:41:39.241171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe651943940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe651943dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe651943d60>]}
[0m15:41:39.287532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:39.287895 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:41:39.301083 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:41:39.329643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f629ab9b-f333-4622-bf8a-8841a5c38cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe650770c40>]}
[0m15:41:39.338004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f629ab9b-f333-4622-bf8a-8841a5c38cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6516b7fd0>]}
[0m15:41:39.338304 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:41:39.338543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f629ab9b-f333-4622-bf8a-8841a5c38cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6516cd690>]}
[0m15:41:39.339468 [info ] [MainThread]: 
[0m15:41:39.340024 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:41:39.340910 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:41:39.341212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:41.785558 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:41:41.786469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:43.936856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f629ab9b-f333-4622-bf8a-8841a5c38cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6519403d0>]}
[0m15:41:43.938652 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:41:43.939551 [info ] [MainThread]: 
[0m15:41:43.946678 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:41:43.946999 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:41:43.947654 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:41:43.947852 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:41:43.948036 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:41:43.952790 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:41:43.953177 [debug] [Thread-1 (]: finished collecting timing info
[0m15:41:43.953365 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:41:43.971139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:45.266462 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:41:45.266944 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),' - ',country_code) as unique_port

        from vessel_ports_interaction
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:41:51.285557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:ae269ab6-38db-425e-bbed-a3b0b89fe184:US&page=queryresults
[0m15:41:51.306949 [debug] [Thread-1 (]: finished collecting timing info
[0m15:41:51.307570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f629ab9b-f333-4622-bf8a-8841a5c38cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe650770ac0>]}
[0m15:41:51.307936 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (106.5k rows, 467.5 MB processed)[0m in 7.36s]
[0m15:41:51.308376 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:41:51.309891 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:41:51.310401 [info ] [MainThread]: 
[0m15:41:51.310682 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.97 seconds (11.97s).
[0m15:41:51.310952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:51.311090 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:41:51.318296 [info ] [MainThread]: 
[0m15:41:51.318602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:51.318912 [info ] [MainThread]: 
[0m15:41:51.319159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:41:51.319485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6516cd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6516f14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6516dfa60>]}
[0m15:41:51.319735 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:43:12.130644 | eafb1206-a05d-47ee-916b-66c58ef84f11 ==============================
[0m15:43:12.130654 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:43:12.131023 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:43:12.131184 [debug] [MainThread]: Tracking: tracking
[0m15:43:12.132671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0e23baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0e23bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0e23bf10>]}
[0m15:43:12.178872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:12.179323 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:43:12.192520 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:43:12.219903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eafb1206-a05d-47ee-916b-66c58ef84f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0d06ce20>]}
[0m15:43:12.252416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eafb1206-a05d-47ee-916b-66c58ef84f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dfb33a0>]}
[0m15:43:12.252740 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:43:12.253013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eafb1206-a05d-47ee-916b-66c58ef84f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dfc9870>]}
[0m15:43:12.254037 [info ] [MainThread]: 
[0m15:43:12.254669 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:43:12.255663 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:43:12.255989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:13.735058 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:43:13.735896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:15.679513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eafb1206-a05d-47ee-916b-66c58ef84f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dfdbb20>]}
[0m15:43:15.681309 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:43:15.682180 [info ] [MainThread]: 
[0m15:43:15.689214 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:43:15.689534 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:43:15.690189 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:43:15.690369 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:43:15.690532 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:43:15.695214 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:43:15.695593 [debug] [Thread-1 (]: finished collecting timing info
[0m15:43:15.695775 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:43:15.713094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:17.894484 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:43:17.894933 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when port_type = 'Anchorage' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when port_type = 'Marina' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when port_type = 'Canal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when port_type = 'Offshore Terminal' then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:43:25.098779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:b9ce8195-55b2-4d37-84bc-edf79a63a004:US&page=queryresults
[0m15:43:25.120411 [debug] [Thread-1 (]: finished collecting timing info
[0m15:43:25.121025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eafb1206-a05d-47ee-916b-66c58ef84f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0d06cc10>]}
[0m15:43:25.121389 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (106.5k rows, 467.5 MB processed)[0m in 9.43s]
[0m15:43:25.121820 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:43:25.123207 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:43:25.123733 [info ] [MainThread]: 
[0m15:43:25.124019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.87 seconds (12.87s).
[0m15:43:25.124278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:25.124418 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:43:25.131614 [info ] [MainThread]: 
[0m15:43:25.131929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:25.132233 [info ] [MainThread]: 
[0m15:43:25.132481 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:43:25.132813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dfdbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dfec670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dfecd00>]}
[0m15:43:25.133071 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:49:30.226282 | 7c1de18e-443a-4999-b9e8-89047ee1e774 ==============================
[0m15:49:30.226292 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:49:30.226668 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:49:30.226846 [debug] [MainThread]: Tracking: tracking
[0m15:49:30.228230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf93f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf93f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf93de10>]}
[0m15:49:30.273910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:30.274287 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:49:30.287033 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:49:30.314102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1de18e-443a-4999-b9e8-89047ee1e774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be769090>]}
[0m15:49:30.321399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1de18e-443a-4999-b9e8-89047ee1e774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf6b73a0>]}
[0m15:49:30.321720 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:49:30.321965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1de18e-443a-4999-b9e8-89047ee1e774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf6cdae0>]}
[0m15:49:30.322965 [info ] [MainThread]: 
[0m15:49:30.323563 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:49:30.324411 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:49:30.324701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:32.503608 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:49:32.504477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:34.434019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1de18e-443a-4999-b9e8-89047ee1e774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf6dfeb0>]}
[0m15:49:34.435880 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:49:34.436758 [info ] [MainThread]: 
[0m15:49:34.443759 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:49:34.444069 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:49:34.444701 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:49:34.444871 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:49:34.445026 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:49:34.449713 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:49:34.450093 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:34.450282 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:49:34.467576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:35.728346 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:49:35.728783 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*' is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*' is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*' is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*' is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:49:36.186514 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword THEN at [47:61]')
[0m15:49:37.504761 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:1e88a5e7-0faa-44a9-9e35-87a1931f3803&page=queryresults
[0m15:49:37.506051 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:37.507612 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected ")" but got keyword THEN at [47:61]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:49:37.508357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1de18e-443a-4999-b9e8-89047ee1e774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be81a470>]}
[0m15:49:37.509323 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.06s]
[0m15:49:37.510494 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:49:37.514121 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:49:37.515731 [info ] [MainThread]: 
[0m15:49:37.516581 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m15:49:37.517260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:37.517404 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:49:37.525363 [info ] [MainThread]: 
[0m15:49:37.525700 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:37.525998 [info ] [MainThread]: 
[0m15:49:37.526261 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m15:49:37.526501 [error] [MainThread]:   Syntax error: Expected ")" but got keyword THEN at [47:61]
[0m15:49:37.526753 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m15:49:37.526996 [info ] [MainThread]: 
[0m15:49:37.527230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:49:37.527556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf6dff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf7385b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf6f0070>]}
[0m15:49:37.527797 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 15:50:47.168623 | e829301e-8ae6-4a58-8a79-b5c96e08d5e3 ==============================
[0m15:50:47.168634 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:50:47.168976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:50:47.169138 [debug] [MainThread]: Tracking: tracking
[0m15:50:47.170398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776a23f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776a23fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776a23fd60>]}
[0m15:50:47.215927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:47.216403 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m15:50:47.229321 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m15:50:47.257206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e829301e-8ae6-4a58-8a79-b5c96e08d5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769068c40>]}
[0m15:50:47.264107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e829301e-8ae6-4a58-8a79-b5c96e08d5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769fb3fd0>]}
[0m15:50:47.264397 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:50:47.264646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e829301e-8ae6-4a58-8a79-b5c96e08d5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769fc9690>]}
[0m15:50:47.265579 [info ] [MainThread]: 
[0m15:50:47.266215 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:50:47.267121 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m15:50:47.267291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:49.508498 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m15:50:49.509420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:50.850793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e829301e-8ae6-4a58-8a79-b5c96e08d5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776a23fdc0>]}
[0m15:50:50.852590 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:50:50.853461 [info ] [MainThread]: 
[0m15:50:50.860637 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:50:50.860957 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m15:50:50.861641 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:50:50.861822 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:50:50.862780 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:50:50.866792 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:50:50.867205 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:50.867399 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:50:50.884859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:52.398856 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m15:50:52.399306 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),


final as (

    select * from vessel_ports_interaction_dedupe

)

select * from final
    );
  
[0m15:51:00.567822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:44beb52c-3850-47e9-8b7a-0dd19ddbe689:US&page=queryresults
[0m15:51:00.589729 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:00.590354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e829301e-8ae6-4a58-8a79-b5c96e08d5e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769068970>]}
[0m15:51:00.590728 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (90.8k rows, 467.5 MB processed)[0m in 9.73s]
[0m15:51:00.591166 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m15:51:00.592727 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:51:00.593245 [info ] [MainThread]: 
[0m15:51:00.593523 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m15:51:00.593779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:00.593918 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m15:51:00.601159 [info ] [MainThread]: 
[0m15:51:00.601470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:00.601769 [info ] [MainThread]: 
[0m15:51:00.602017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:00.602502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769fdbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769fdb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7769fed660>]}
[0m15:51:00.602915 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 16:03:37.046125 | 60f4f6eb-1b75-496b-ba61-07078ed8458a ==============================
[0m16:03:37.046136 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:03:37.046957 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:03:37.047117 [debug] [MainThread]: Tracking: tracking
[0m16:03:37.048429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad73f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad73f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad73e0e0>]}
[0m16:03:37.095010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:37.095403 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m16:03:37.108342 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m16:03:37.136175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f4f6eb-1b75-496b-ba61-07078ed8458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad51e4d0>]}
[0m16:03:37.143401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f4f6eb-1b75-496b-ba61-07078ed8458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b0bf2140>]}
[0m16:03:37.143678 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:03:37.143924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f4f6eb-1b75-496b-ba61-07078ed8458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad4cdde0>]}
[0m16:03:37.144819 [info ] [MainThread]: 
[0m16:03:37.145361 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:03:37.146214 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m16:03:37.146471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:39.546238 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m16:03:39.547158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:41.613358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f4f6eb-1b75-496b-ba61-07078ed8458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad4dff40>]}
[0m16:03:41.615177 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:03:41.616046 [info ] [MainThread]: 
[0m16:03:41.623316 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:03:41.623660 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m16:03:41.624371 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:03:41.624563 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:03:41.624737 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:03:41.629702 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:03:41.630078 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:41.630263 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:03:41.647595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:43.726670 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:03:43.727148 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),

vessel_sines_rodman as (

    select * from source_vessel_tracking_events

    where regexp_like(voyage_origin_port,'(?i)sines') is true

)

final as (

    select * from vessel_sines_rodman

)

select * from final
    );
  
[0m16:03:44.151179 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [75:1]')
[0m16:03:45.481620 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:b22ecca4-7bc0-486b-9d86-7199ea9e3051&page=queryresults
[0m16:03:45.482943 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:45.484483 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [75:1]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m16:03:45.484752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f4f6eb-1b75-496b-ba61-07078ed8458a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac61b220>]}
[0m16:03:45.485121 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 3.86s]
[0m16:03:45.485545 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:03:45.487324 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:03:45.487927 [info ] [MainThread]: 
[0m16:03:45.488257 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m16:03:45.488561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:45.488724 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m16:03:45.497079 [info ] [MainThread]: 
[0m16:03:45.497428 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:45.497757 [info ] [MainThread]: 
[0m16:03:45.498037 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m16:03:45.498313 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [75:1]
[0m16:03:45.498573 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m16:03:45.498853 [info ] [MainThread]: 
[0m16:03:45.499119 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:45.499471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad51e0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad4cdde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ad4f0820>]}
[0m16:03:45.499742 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 16:04:04.396318 | 6bedbe3c-6373-423e-a156-940e16f06fc8 ==============================
[0m16:04:04.396329 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:04:04.396675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:04:04.396821 [debug] [MainThread]: Tracking: tracking
[0m16:04:04.398164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618353f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618353f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618353dc30>]}
[0m16:04:04.444211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:04.444602 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m16:04:04.457593 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m16:04:04.485032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bedbe3c-6373-423e-a156-940e16f06fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618236cfa0>]}
[0m16:04:04.493020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bedbe3c-6373-423e-a156-940e16f06fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61832b73a0>]}
[0m16:04:04.493532 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:04:04.494003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedbe3c-6373-423e-a156-940e16f06fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61832cd9f0>]}
[0m16:04:04.495835 [info ] [MainThread]: 
[0m16:04:04.496840 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:04:04.498150 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m16:04:04.498580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:06.580823 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m16:04:06.581443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:07.700724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedbe3c-6373-423e-a156-940e16f06fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61832dfb20>]}
[0m16:04:07.702516 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:04:07.703420 [info ] [MainThread]: 
[0m16:04:07.710318 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:07.710636 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m16:04:07.711360 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:04:07.711564 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:07.711747 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:07.716926 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:04:07.717356 [debug] [Thread-1 (]: finished collecting timing info
[0m16:04:07.717567 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:07.738183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:09.778126 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:04:09.778564 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),

vessel_sines_rodman as (

    select * from source_vessel_tracking_events

    where regexp_like(voyage_origin_port,'(?i)sines') is true

),

final as (

    select * from vessel_sines_rodman

)

select * from final
    );
  
[0m16:04:11.606427 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: regexp_like at [71:11]')
[0m16:04:12.878139 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:US:81a784ce-4375-43c0-90bb-67915de1c17e&page=queryresults
[0m16:04:12.879455 [debug] [Thread-1 (]: finished collecting timing info
[0m16:04:12.880988 [debug] [Thread-1 (]: Database Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)
  Function not found: regexp_like at [71:11]
  compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m16:04:12.881498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedbe3c-6373-423e-a156-940e16f06fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6182419fc0>]}
[0m16:04:12.881861 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model data_science.stg_vessel_tracked_events ... [[31mERROR[0m in 5.17s]
[0m16:04:12.882283 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:12.883853 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:04:12.884387 [info ] [MainThread]: 
[0m16:04:12.884681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m16:04:12.884955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:12.885100 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m16:04:12.893514 [info ] [MainThread]: 
[0m16:04:12.893901 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:04:12.894206 [info ] [MainThread]: 
[0m16:04:12.894462 [error] [MainThread]: [33mDatabase Error in model stg_vessel_tracked_events (models/staging/stg_vessel_tracked_events.sql)[0m
[0m16:04:12.894721 [error] [MainThread]:   Function not found: regexp_like at [71:11]
[0m16:04:12.894972 [error] [MainThread]:   compiled Code at target/run/vessel_assessment_bq/models/staging/stg_vessel_tracked_events.sql
[0m16:04:12.895220 [info ] [MainThread]: 
[0m16:04:12.895465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:04:12.895795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61833302e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6183330ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61832f0040>]}
[0m16:04:12.896045 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 16:04:46.653070 | 711e0512-b2ce-4b3c-8a6b-b5f626f88617 ==============================
[0m16:04:46.653080 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:04:46.653449 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:04:46.653611 [debug] [MainThread]: Tracking: tracking
[0m16:04:46.654943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdd3fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdd3f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdd3ffd0>]}
[0m16:04:46.700999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:46.701350 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m16:04:46.714021 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m16:04:46.741312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '711e0512-b2ce-4b3c-8a6b-b5f626f88617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bcb68ee0>]}
[0m16:04:46.748732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '711e0512-b2ce-4b3c-8a6b-b5f626f88617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdab73a0>]}
[0m16:04:46.749076 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:04:46.749325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711e0512-b2ce-4b3c-8a6b-b5f626f88617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdacd930>]}
[0m16:04:46.750240 [info ] [MainThread]: 
[0m16:04:46.750879 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:04:46.751719 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m16:04:46.752035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:48.957351 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m16:04:48.958232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:50.946129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711e0512-b2ce-4b3c-8a6b-b5f626f88617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdadfbb0>]}
[0m16:04:50.947963 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:04:50.948828 [info ] [MainThread]: 
[0m16:04:50.955796 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:50.956120 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m16:04:50.956779 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:04:50.956964 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:50.957126 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:50.961651 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:04:50.962043 [debug] [Thread-1 (]: finished collecting timing info
[0m16:04:50.962234 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:50.980102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:52.382344 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:04:52.382805 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),

vessel_sines_rodman as (

    select * from source_vessel_tracking_events

    where regexp_contains(voyage_origin_port,'(?i)sines') is true

),

final as (

    select * from vessel_sines_rodman

)

select * from final
    );
  
[0m16:04:55.875800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:324abd3e-b36f-4e97-a8d3-9ef4129f36ff:US&page=queryresults
[0m16:04:55.897024 [debug] [Thread-1 (]: finished collecting timing info
[0m16:04:55.897652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '711e0512-b2ce-4b3c-8a6b-b5f626f88617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bcb68af0>]}
[0m16:04:55.898017 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (991.0 rows, 467.5 MB processed)[0m in 4.94s]
[0m16:04:55.898459 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:04:55.900033 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:04:55.900548 [info ] [MainThread]: 
[0m16:04:55.900825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m16:04:55.901077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:55.901214 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m16:04:55.908833 [info ] [MainThread]: 
[0m16:04:55.909140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:55.909445 [info ] [MainThread]: 
[0m16:04:55.909750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:55.910123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdadff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdb31270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdaf02b0>]}
[0m16:04:55.910416 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 16:07:14.690375 | e1124a3a-8b3d-4c66-a11e-4b96577f9b94 ==============================
[0m16:07:14.690387 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:07:14.691094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:07:14.691269 [debug] [MainThread]: Tracking: tracking
[0m16:07:14.692676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5363b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5363b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b53639e10>]}
[0m16:07:14.741699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:14.742135 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m16:07:14.756391 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m16:07:14.786017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1124a3a-8b3d-4c66-a11e-4b96577f9b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5246d090>]}
[0m16:07:14.793702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1124a3a-8b3d-4c66-a11e-4b96577f9b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b533b33a0>]}
[0m16:07:14.794004 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:07:14.794254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1124a3a-8b3d-4c66-a11e-4b96577f9b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b533c9ae0>]}
[0m16:07:14.795249 [info ] [MainThread]: 
[0m16:07:14.795872 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:07:14.796752 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m16:07:14.797026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:16.014023 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m16:07:16.014338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:17.286306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1124a3a-8b3d-4c66-a11e-4b96577f9b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b533dbf10>]}
[0m16:07:17.288146 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:07:17.289162 [info ] [MainThread]: 
[0m16:07:17.296042 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:07:17.296429 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m16:07:17.297191 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:07:17.297397 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:07:17.297584 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:07:17.302728 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:07:17.303131 [debug] [Thread-1 (]: finished collecting timing info
[0m16:07:17.303322 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:07:17.320827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:19.369506 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:07:19.370599 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),

vessel_sines_rodman as (

    select * from source_vessel_tracking_events

    where regexp_contains(voyage_origin_port,'(?i)sines*') is true

),

final as (

    select * from vessel_sines_rodman

)

select * from final
    );
  
[0m16:07:22.568388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:fd695a94-b569-438a-a3b1-0ac95fc68ee5:US&page=queryresults
[0m16:07:22.589907 [debug] [Thread-1 (]: finished collecting timing info
[0m16:07:22.590531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1124a3a-8b3d-4c66-a11e-4b96577f9b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5246cbb0>]}
[0m16:07:22.590912 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (991.0 rows, 467.5 MB processed)[0m in 5.29s]
[0m16:07:22.591348 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:07:22.592787 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:07:22.593302 [info ] [MainThread]: 
[0m16:07:22.593579 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m16:07:22.593832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:22.593968 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m16:07:22.601472 [info ] [MainThread]: 
[0m16:07:22.601780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:22.602082 [info ] [MainThread]: 
[0m16:07:22.602330 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:22.602659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b533dbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b533ece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b533ecca0>]}
[0m16:07:22.602926 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 16:09:27.667929 | db350ee5-549f-470b-ad5d-ae7282b2da49 ==============================
[0m16:09:27.667940 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:09:27.668312 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:09:27.668476 [debug] [MainThread]: Tracking: tracking
[0m16:09:27.669767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0145a3ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0145a3bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0145a3beb0>]}
[0m16:09:27.717943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:27.718321 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m16:09:27.731564 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m16:09:27.761214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db350ee5-549f-470b-ad5d-ae7282b2da49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0144868dc0>]}
[0m16:09:27.768387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db350ee5-549f-470b-ad5d-ae7282b2da49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01457b33a0>]}
[0m16:09:27.768675 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:09:27.768973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db350ee5-549f-470b-ad5d-ae7282b2da49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01457c9810>]}
[0m16:09:27.769963 [info ] [MainThread]: 
[0m16:09:27.770574 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:09:27.771480 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m16:09:27.771773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:29.455067 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m16:09:29.455715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:30.727271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db350ee5-549f-470b-ad5d-ae7282b2da49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01457dbbe0>]}
[0m16:09:30.729316 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:09:30.730204 [info ] [MainThread]: 
[0m16:09:30.737094 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:09:30.737399 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m16:09:30.738034 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:09:30.738281 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:09:30.738452 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:09:30.743100 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:09:30.743478 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:30.743661 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:09:30.760856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:32.029407 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:09:32.029871 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),

vessel_sines_rodman as (

    select *, regexp_contains(voyage_origin_port,'(?i)sines*') as is_sines
from source_vessel_tracking_events

    where regexp_contains(voyage_origin_port,'(?i)sines*') is true

),

final as (

    select * from vessel_sines_rodman

)

select * from final
    );
  
[0m16:09:35.199601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:88008d14-ebeb-4123-a7a4-2e912a142b41:US&page=queryresults
[0m16:09:35.221877 [debug] [Thread-1 (]: finished collecting timing info
[0m16:09:35.222489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db350ee5-549f-470b-ad5d-ae7282b2da49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0144868880>]}
[0m16:09:35.222862 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (991.0 rows, 467.5 MB processed)[0m in 4.48s]
[0m16:09:35.223299 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:09:35.224794 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:09:35.225314 [info ] [MainThread]: 
[0m16:09:35.225594 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m16:09:35.225850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:35.225989 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m16:09:35.233748 [info ] [MainThread]: 
[0m16:09:35.234069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:35.234378 [info ] [MainThread]: 
[0m16:09:35.234729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:35.235146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01457dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01457ec460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01457ed780>]}
[0m16:09:35.235401 [debug] [MainThread]: Flushing usage events


============================== 2022-12-13 16:15:25.962961 | ea09957a-fae3-44ba-bc4b-1251f3b40297 ==============================
[0m16:15:25.962972 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:15:25.963339 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/mbhekeni/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_vessel_tracked_events'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:15:25.963496 [debug] [MainThread]: Tracking: tracking
[0m16:15:25.964876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8503f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8503fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8503fca0>]}
[0m16:15:26.013967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:15:26.014347 [debug] [MainThread]: Partial parsing: updated file: vessel_assessment_bq://models/staging/stg_vessel_tracked_events.sql
[0m16:15:26.028000 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_vessel_tracked_events.sql
[0m16:15:26.056515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea09957a-fae3-44ba-bc4b-1251f3b40297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8406cbb0>]}
[0m16:15:26.063815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea09957a-fae3-44ba-bc4b-1251f3b40297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc84db3f40>]}
[0m16:15:26.064114 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:15:26.064368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea09957a-fae3-44ba-bc4b-1251f3b40297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc84dc9600>]}
[0m16:15:26.065281 [info ] [MainThread]: 
[0m16:15:26.065837 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:15:26.066712 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house"
[0m16:15:26.066964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:28.357006 [debug] [ThreadPool]: Acquiring new bigquery connection "list_rentoza-dataware-house_data_science"
[0m16:15:28.358110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:30.406173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea09957a-fae3-44ba-bc4b-1251f3b40297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8503c400>]}
[0m16:15:30.408023 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:15:30.408875 [info ] [MainThread]: 
[0m16:15:30.415983 [debug] [Thread-1 (]: Began running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:15:30.416289 [info ] [Thread-1 (]: 1 of 1 START sql table model data_science.stg_vessel_tracked_events ............ [RUN]
[0m16:15:30.416930 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:15:30.417104 [debug] [Thread-1 (]: Began compiling node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:15:30.418016 [debug] [Thread-1 (]: Compiling model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:15:30.421760 [debug] [Thread-1 (]: Writing injected SQL for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:15:30.422171 [debug] [Thread-1 (]: finished collecting timing info
[0m16:15:30.422402 [debug] [Thread-1 (]: Began executing node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:15:30.444350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:32.504801 [debug] [Thread-1 (]: Writing runtime sql for node "model.vessel_assessment_bq.stg_vessel_tracked_events"
[0m16:15:32.505241 [debug] [Thread-1 (]: On model.vessel_assessment_bq.stg_vessel_tracked_events: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "vessel_assessment_bq", "target_name": "dev", "node_id": "model.vessel_assessment_bq.stg_vessel_tracked_events"} */

  
    

    create or replace table `rentoza-dataware-house`.`data_science`.`stg_vessel_tracked_events`
    
    
    OPTIONS()
    as (
      with source_vessel_tracking_events as (

    select distinct * from `rentoza-dataware-house`.`data_science`.`vessel_tracking_events`
),

vessel_ports_all as (
    
    select 
        mmsi,
        port_at_call as port,
        port_at_call_country as country_code,
        port_type
    from source_vessel_tracking_events

    union all
    
    select
        mmsi,
        case when voyage_origin_port = '-' then destination_port
             when destination_port =  '-' then voyage_origin_port 
             else 'other' end as port,

        case when origin_port_country = '-' then destination_port_country
             when destination_port_country =  '-' then origin_port_country 
             else 'other' end as country_code,
        port_type

    from source_vessel_tracking_events 

),

vessel_ports_interaction as (

    select 
        mmsi,
        port_type,
        case when regexp_contains(port,'(?i)anch.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)anch.*'),''),'')
             when regexp_contains(port,'(?i)marin.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)marin.*'),''),'')
             when regexp_contains(port,'(?i)canal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)canal.*'),''),'')
             when regexp_contains(port,'(?i)terminal.*') is true then regexp_replace(port, coalesce(regexp_extract(port,'(?i)terminal.*'),''),'')
              else port end as port,
        country_code

        from vessel_ports_all
),

vessel_ports_interaction_dedupe as (

    select distinct
        mmsi,
        port_type,
        concat(trim(port),'-',trim(country_code)) as unique_port

        from vessel_ports_interaction
),

vessel_sines_rodman as (

    select *
from source_vessel_tracking_events

    where regexp_contains(voyage_origin_port,'(?i)sines*') is true and 
          regexp_contains(port_at_call,'(?i)rodman*') is true

),

final as (

    select * from vessel_sines_rodman

)

select * from final
    );
  
[0m16:15:35.928996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=rentoza-dataware-house&j=bq:58fbaf00-e57c-444f-a08e-b2cae8693012:US&page=queryresults
[0m16:15:35.950927 [debug] [Thread-1 (]: finished collecting timing info
[0m16:15:35.951570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea09957a-fae3-44ba-bc4b-1251f3b40297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8406c8b0>]}
[0m16:15:35.951943 [info ] [Thread-1 (]: 1 of 1 OK created sql table model data_science.stg_vessel_tracked_events ....... [[32mCREATE TABLE (7.0 rows, 467.5 MB processed)[0m in 5.53s]
[0m16:15:35.952374 [debug] [Thread-1 (]: Finished running node model.vessel_assessment_bq.stg_vessel_tracked_events
[0m16:15:35.953921 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:15:35.954740 [info ] [MainThread]: 
[0m16:15:35.955182 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.89 seconds (9.89s).
[0m16:15:35.955600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:35.955821 [debug] [MainThread]: Connection 'model.vessel_assessment_bq.stg_vessel_tracked_events' was properly closed.
[0m16:15:35.964745 [info ] [MainThread]: 
[0m16:15:35.965070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:35.965366 [info ] [MainThread]: 
[0m16:15:35.965610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:15:35.965927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc84dec130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8503d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8503c430>]}
[0m16:15:35.966172 [debug] [MainThread]: Flushing usage events
